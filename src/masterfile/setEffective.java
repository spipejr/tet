/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package masterfile;

import com.mysql.jdbc.PreparedStatement;
import dbutility.dbUtility;
import frmlist.ListProduct;
import frmlist.listBgroupOfEff;
import java.awt.Color;
import java.awt.Font;
import java.awt.Point;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.IOException;
import java.sql.ResultSet;
import java.sql.Statement;
import java.text.DecimalFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.*;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableColumnModel;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumn;
import javax.swing.table.TableColumnModel;
import jxl.write.WriteException;
import net.sf.jasperreports.view.save.JRSingleSheetXlsSaveContributor;
import org.jdesktop.swingx.JXTree;
import reportModel.reportEffectiveModel;
import utilities.DateChooser.DateUtil;
import utilititiesfunction.*;

/**
 *
 * @author s386
 */
public class setEffective extends javax.swing.JDialog {

    /**
     * Creates new form setEffective
     */
    DefaultTableModel tbPLU ;
    DefaultTableModel tbCoupon ;
    dbUtility db = new dbUtility();
    Statement stmt ;
    int indexplutbl = -1;
    int indexcoupontbl = -1;
    String frmName = "setsalepriceofbranchgroup";
    ThaiUtilities cvth = new ThaiUtilities();
    DecimalFormat DoubleFmt = new DecimalFormat("##,###,##0.00");
    SimpleDateFormat dateFmtSave = new SimpleDateFormat("yyyy-MM-dd", Locale.ENGLISH);
    SimpleDateFormat dateFmtShow = new SimpleDateFormat("dd-MM-yyyy", Locale.ENGLISH);
    private DefaultTableModel tbmodel;
    public setEffective(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        try {
            initComponents();
            //checkuserconfig();
            db.dbconnect();
            initable();
            int year = new java.util.Date().getYear()+1900;
            Date d = Format.dateFmtShow.parse("01/01/"+year);
            Date d2 = Format.dateFmtShow.parse("31/12/"+year);
            t_date1.setText(Format.dateFmtShow.format(d));
            t_date2.setText(Format.dateFmtShow.format(d2));
            t_date3.setText(Format.dateFmtShow.format(new java.util.Date()));
            settbl2();
        } catch (ParseException ex) {
            Logger.getLogger(setEffective.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        txtfPcode = new javax.swing.JTextField();
        txtfPdesc = new javax.swing.JTextField();
        btnsearchplu = new javax.swing.JButton();
        d_lblpcode = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        Tabbed1 = new javax.swing.JTabbedPane();
        jPanel4 = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        txtfBgroup1 = new javax.swing.JTextField();
        txtfBranchName = new javax.swing.JTextField();
        btnsearchplu3 = new javax.swing.JButton();
        db_btnOK = new javax.swing.JButton();
        db_btnCancel = new javax.swing.JButton();
        db_lblh1 = new javax.swing.JLabel();
        jPanel6 = new javax.swing.JPanel();
        txtfmEatIn = new javax.swing.JFormattedTextField();
        txtfmTakeAway = new javax.swing.JFormattedTextField();
        txtfmDelivery = new javax.swing.JFormattedTextField();
        txtfmPinto = new javax.swing.JFormattedTextField();
        txtfmWhole = new javax.swing.JFormattedTextField();
        d_lbleatin = new javax.swing.JLabel();
        d_lblTake = new javax.swing.JLabel();
        d_lblDelivery = new javax.swing.JLabel();
        d_lblPinto = new javax.swing.JLabel();
        d_lblWhole = new javax.swing.JLabel();
        btnuppriceall = new javax.swing.JButton();
        jPanel8 = new javax.swing.JPanel();
        txtfPro1 = new javax.swing.JTextField();
        btnsearchplu4 = new javax.swing.JButton();
        txtfproname1 = new javax.swing.JTextField();
        txtfproname2 = new javax.swing.JTextField();
        btnsearchplu5 = new javax.swing.JButton();
        txtfPro2 = new javax.swing.JTextField();
        txtfproname3 = new javax.swing.JTextField();
        btnsearchplu6 = new javax.swing.JButton();
        txtfPro3 = new javax.swing.JTextField();
        db_lblPro = new javax.swing.JLabel();
        btnuppromotionall = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        tbl = new javax.swing.JTable();
        jPanel9 = new javax.swing.JPanel();
        db_lblCount = new javax.swing.JLabel();
        db_lblCount1 = new javax.swing.JLabel();
        db_lblCount2 = new javax.swing.JLabel();
        jPanel10 = new javax.swing.JPanel();
        db_btnDelete = new javax.swing.JButton();
        db_btnDeleteAll = new javax.swing.JButton();
        db_btnExel = new javax.swing.JButton();
        t_date3 = new javax.swing.JFormattedTextField();
        d_date4 = new javax.swing.JLabel();
        btn_Calendar2 = new javax.swing.JButton();
        jPanel5 = new javax.swing.JPanel();
        jPanel12 = new javax.swing.JPanel();
        db_btnExel1 = new javax.swing.JButton();
        db_btnExel2 = new javax.swing.JButton();
        jScrollPane2 = new javax.swing.JScrollPane();
        tbl2 = new org.jdesktop.swingx.JXTreeTable();
        jPanel15 = new javax.swing.JPanel();
        d_date2 = new javax.swing.JLabel();
        btn_Calendar = new javax.swing.JButton();
        d_date3 = new javax.swing.JLabel();
        t_date1 = new javax.swing.JFormattedTextField();
        t_date2 = new javax.swing.JFormattedTextField();
        btn_Calendar1 = new javax.swing.JButton();
        d_date1 = new javax.swing.JLabel();
        db_btnProcress = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        txtfPcode.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfPcode.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfPcodeFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfPcodeFocusLost(evt);
            }
        });
        txtfPcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfPcodeKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtfPcodeKeyReleased(evt);
            }
        });

        txtfPdesc.setBackground(new java.awt.Color(255, 246, 143));
        txtfPdesc.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfPdesc.setFocusable(false);

        btnsearchplu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnsearchplu.setFocusable(false);
        btnsearchplu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsearchpluActionPerformed(evt);
            }
        });

        d_lblpcode.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        d_lblpcode.setText("รหัสสินค้า (PLU Code)");
        d_lblpcode.setName("d_lblpcode"); // NOI18N

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(txtfPcode, javax.swing.GroupLayout.PREFERRED_SIZE, 136, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnsearchplu, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtfPdesc, javax.swing.GroupLayout.DEFAULT_SIZE, 266, Short.MAX_VALUE)
                        .addGap(24, 24, 24))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(d_lblpcode)
                        .addContainerGap())))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(d_lblpcode, javax.swing.GroupLayout.PREFERRED_SIZE, 18, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btnsearchplu, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfPdesc, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfPcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(""));

        Tabbed1.setBorder(null);
        Tabbed1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        Tabbed1.setName("Tabbed1"); // NOI18N
        Tabbed1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                Tabbed1MouseClicked(evt);
            }
        });

        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(""));

        txtfBgroup1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfBgroup1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfBgroup1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfBgroup1FocusLost(evt);
            }
        });
        txtfBgroup1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfBgroup1KeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtfBgroup1KeyReleased(evt);
            }
        });

        txtfBranchName.setBackground(new java.awt.Color(255, 246, 143));
        txtfBranchName.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfBranchName.setFocusable(false);

        btnsearchplu3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnsearchplu3.setFocusable(false);
        btnsearchplu3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsearchplu3ActionPerformed(evt);
            }
        });

        db_btnOK.setText("OK");
        db_btnOK.setName("db_btnOK"); // NOI18N
        db_btnOK.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnOKActionPerformed(evt);
            }
        });

        db_btnCancel.setText("Cancel");
        db_btnCancel.setName("db_btnCancel"); // NOI18N
        db_btnCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnCancelActionPerformed(evt);
            }
        });

        db_lblh1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_lblh1.setText("กำหนดกลุ่มสาขา");
        db_lblh1.setName("db_lblh1"); // NOI18N

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(db_lblh1)
                        .addContainerGap())
                    .addGroup(jPanel7Layout.createSequentialGroup()
                        .addComponent(txtfBgroup1, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addComponent(db_btnOK, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(db_btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 17, Short.MAX_VALUE))
                            .addGroup(jPanel7Layout.createSequentialGroup()
                                .addComponent(btnsearchplu3, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtfBranchName))))))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel7Layout.createSequentialGroup()
                .addComponent(db_lblh1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtfBgroup1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnsearchplu3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfBranchName, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(db_btnOK, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(db_btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel6.setBorder(javax.swing.BorderFactory.createTitledBorder(""));

        txtfmEatIn.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        txtfmEatIn.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtfmEatIn.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        txtfmEatIn.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfmEatInFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfmEatInFocusLost(evt);
            }
        });
        txtfmEatIn.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfmEatInKeyPressed(evt);
            }
        });

        txtfmTakeAway.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        txtfmTakeAway.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtfmTakeAway.setText("0.00");
        txtfmTakeAway.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        txtfmTakeAway.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfmTakeAwayFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfmTakeAwayFocusLost(evt);
            }
        });
        txtfmTakeAway.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfmTakeAwayKeyPressed(evt);
            }
        });

        txtfmDelivery.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        txtfmDelivery.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtfmDelivery.setText("0.00");
        txtfmDelivery.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        txtfmDelivery.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfmDeliveryFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfmDeliveryFocusLost(evt);
            }
        });
        txtfmDelivery.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfmDeliveryKeyPressed(evt);
            }
        });

        txtfmPinto.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        txtfmPinto.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtfmPinto.setText("0.00");
        txtfmPinto.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        txtfmPinto.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfmPintoFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfmPintoFocusLost(evt);
            }
        });
        txtfmPinto.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfmPintoKeyPressed(evt);
            }
        });

        txtfmWhole.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        txtfmWhole.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        txtfmWhole.setText("0.00");
        txtfmWhole.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        txtfmWhole.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfmWholeFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfmWholeFocusLost(evt);
            }
        });
        txtfmWhole.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfmWholeKeyPressed(evt);
            }
        });

        d_lbleatin.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_lbleatin.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        d_lbleatin.setText("Eat In");
        d_lbleatin.setName("d_lbleatin"); // NOI18N

        d_lblTake.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_lblTake.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        d_lblTake.setText("Take Away");
        d_lblTake.setName("d_lblTake"); // NOI18N

        d_lblDelivery.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_lblDelivery.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        d_lblDelivery.setText("Delivery");
        d_lblDelivery.setName("d_lblDelivery"); // NOI18N

        d_lblPinto.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_lblPinto.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        d_lblPinto.setText("Pinto");
        d_lblPinto.setName("d_lblPinto"); // NOI18N

        d_lblWhole.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_lblWhole.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        d_lblWhole.setText("Whole Sale");
        d_lblWhole.setName("d_lblWhole"); // NOI18N

        btnuppriceall.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnuppriceall.setForeground(new java.awt.Color(231, 38, 2));
        btnuppriceall.setText("ปรับราคาทุก Branch Group");
        btnuppriceall.setOpaque(true);
        btnuppriceall.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnuppriceallActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(d_lbleatin, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 75, Short.MAX_VALUE)
                    .addComponent(txtfmEatIn, javax.swing.GroupLayout.Alignment.LEADING))
                .addGap(0, 0, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtfmTakeAway)
                    .addComponent(d_lblTake, javax.swing.GroupLayout.DEFAULT_SIZE, 75, Short.MAX_VALUE))
                .addGap(0, 0, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtfmDelivery)
                    .addComponent(d_lblDelivery, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 8, Short.MAX_VALUE)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtfmPinto)
                    .addComponent(d_lblPinto, javax.swing.GroupLayout.PREFERRED_SIZE, 75, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txtfmWhole)
                    .addComponent(d_lblWhole, javax.swing.GroupLayout.DEFAULT_SIZE, 75, Short.MAX_VALUE)))
            .addComponent(btnuppriceall, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(d_lbleatin)
                    .addComponent(d_lblTake)
                    .addComponent(d_lblDelivery)
                    .addComponent(d_lblPinto)
                    .addComponent(d_lblWhole))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txtfmEatIn, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfmWhole, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfmPinto, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfmDelivery, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfmTakeAway, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnuppriceall)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(""));

        txtfPro1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfPro1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfPro1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfPro1FocusLost(evt);
            }
        });
        txtfPro1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfPro1KeyPressed(evt);
            }
        });

        btnsearchplu4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnsearchplu4.setFocusable(false);
        btnsearchplu4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsearchplu4ActionPerformed(evt);
            }
        });

        txtfproname1.setBackground(new java.awt.Color(255, 246, 143));
        txtfproname1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfproname1.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        txtfproname1.setFocusable(false);

        txtfproname2.setBackground(new java.awt.Color(255, 246, 143));
        txtfproname2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfproname2.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        txtfproname2.setFocusable(false);

        btnsearchplu5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnsearchplu5.setFocusable(false);
        btnsearchplu5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsearchplu5ActionPerformed(evt);
            }
        });

        txtfPro2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfPro2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfPro2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfPro2FocusLost(evt);
            }
        });
        txtfPro2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfPro2KeyPressed(evt);
            }
        });

        txtfproname3.setBackground(new java.awt.Color(255, 246, 143));
        txtfproname3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfproname3.setHorizontalAlignment(javax.swing.JTextField.LEFT);
        txtfproname3.setFocusable(false);

        btnsearchplu6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnsearchplu6.setFocusable(false);
        btnsearchplu6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnsearchplu6ActionPerformed(evt);
            }
        });

        txtfPro3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txtfPro3.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                txtfPro3FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtfPro3FocusLost(evt);
            }
        });
        txtfPro3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txtfPro3KeyPressed(evt);
            }
        });

        db_lblPro.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_lblPro.setText("กำหนดรายการ Promotion");
        db_lblPro.setName("db_lblPro"); // NOI18N

        btnuppromotionall.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnuppromotionall.setForeground(new java.awt.Color(246, 17, 17));
        btnuppromotionall.setText("ปรับโปรโมชั่นทุก Branch Group");
        btnuppromotionall.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnuppromotionallActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(txtfPro1, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(btnsearchplu4, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(txtfproname1))
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(txtfPro2, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(btnsearchplu5, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(txtfproname2))
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(txtfPro3, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(btnsearchplu6, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(2, 2, 2)
                .addComponent(txtfproname3))
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(db_lblPro)
                .addGap(0, 0, Short.MAX_VALUE))
            .addComponent(btnuppromotionall, javax.swing.GroupLayout.DEFAULT_SIZE, 255, Short.MAX_VALUE)
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(db_lblPro)
                .addGap(2, 2, 2)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtfproname1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfPro1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnsearchplu4, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtfproname2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfPro2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnsearchplu5, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(txtfproname3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtfPro3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnsearchplu6, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnuppromotionall))
        );

        tbl.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tbl.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Group", "Branch Group Name", "Effective", "Eat IN", "Take Away", "Delivery", "Pinto", "Whole Sale", "โปรโมชั่น(1)", "โปรโมชั่น(2)", "โปรโมชั่น(3)", "Flage"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl.setName("tbl"); // NOI18N
        tbl.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblMouseClicked(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                tblMouseReleased(evt);
            }
        });
        tbl.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                tblKeyReleased(evt);
            }
        });
        jScrollPane1.setViewportView(tbl);
        tbl.getColumnModel().getColumn(1).setPreferredWidth(200);
        tbl.getColumnModel().getColumn(2).setPreferredWidth(85);

        jPanel9.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        db_lblCount.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        db_lblCount.setText("0");

        db_lblCount1.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        db_lblCount1.setText("จำนวนทั้งหมด");
        db_lblCount1.setName("xb_lblCount1"); // NOI18N

        db_lblCount2.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        db_lblCount2.setText("รายการ");
        db_lblCount2.setName("xb_lblCount2"); // NOI18N

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel9Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(db_lblCount1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(db_lblCount)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(db_lblCount2)
                .addGap(89, 89, 89))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(db_lblCount)
                .addComponent(db_lblCount1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(db_lblCount2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel10.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        db_btnDelete.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_btnDelete.setText("ลบเฉพาะรายการที่เลือก");
        db_btnDelete.setName("db_btnDelete"); // NOI18N
        db_btnDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnDeleteActionPerformed(evt);
            }
        });

        db_btnDeleteAll.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_btnDeleteAll.setText("ลบทุกรายการ");
        db_btnDeleteAll.setName("db_btnDeleteAll"); // NOI18N
        db_btnDeleteAll.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnDeleteAllActionPerformed(evt);
            }
        });

        db_btnExel.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_btnExel.setText("Link All Type");
        db_btnExel.setName("db_btnExel"); // NOI18N
        db_btnExel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnExelActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(db_btnExel, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(db_btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(db_btnDeleteAll, javax.swing.GroupLayout.PREFERRED_SIZE, 149, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(db_btnExel, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(db_btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addComponent(db_btnDeleteAll, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        t_date3.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date3.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_date3FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_date3FocusLost(evt);
            }
        });
        t_date3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date3KeyPressed(evt);
            }
        });

        d_date4.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        d_date4.setText("Effective Date");
        d_date4.setName("d_date2"); // NOI18N

        btn_Calendar2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar2.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btn_Calendar2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_Calendar2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(3, 3, 3)
                        .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                        .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jScrollPane1)
                        .addGroup(jPanel4Layout.createSequentialGroup()
                            .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addGap(296, 296, 296)
                                    .addComponent(d_date4, javax.swing.GroupLayout.PREFERRED_SIZE, 103, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(t_date3, javax.swing.GroupLayout.PREFERRED_SIZE, 90, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                    .addComponent(btn_Calendar2, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGap(135, 135, 135))
                                .addGroup(jPanel4Layout.createSequentialGroup()
                                    .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)))
                            .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(27, Short.MAX_VALUE))
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.CENTER)
                            .addComponent(d_date4, javax.swing.GroupLayout.PREFERRED_SIZE, 17, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(t_date3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btn_Calendar2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(37, 37, 37))
        );

        Tabbed1.addTab("การกำหนดราคาขาย / โปรโมชั่น", jPanel4);

        jPanel12.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        db_btnExel1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_btnExel1.setText("Expand On/Off");
        db_btnExel1.setName("db_btnExel"); // NOI18N
        db_btnExel1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnExel1ActionPerformed(evt);
            }
        });

        db_btnExel2.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_btnExel2.setText("Exel File");
        db_btnExel2.setName("db_btnExel"); // NOI18N
        db_btnExel2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnExel2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(db_btnExel1, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(db_btnExel2, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(db_btnExel1, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(db_btnExel2, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        tbl2.setName("tbl"); // NOI18N
        jScrollPane2.setViewportView(tbl2);

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 960, Short.MAX_VALUE)
                    .addComponent(jPanel12, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 448, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        Tabbed1.addTab("แสดงรายการการกำหนดราคาขายล่วงหน้า", jPanel5);

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(Tabbed1)
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(Tabbed1, javax.swing.GroupLayout.PREFERRED_SIZE, 567, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 30, Short.MAX_VALUE))
        );

        jPanel15.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        d_date2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_date2.setText("วันที่");
        d_date2.setName("d_date2"); // NOI18N

        btn_Calendar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btn_Calendar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CalendarActionPerformed(evt);
            }
        });

        d_date3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        d_date3.setText("ถึงวันที่");
        d_date3.setName("d_date3"); // NOI18N

        t_date1.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date1.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_date1FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_date1FocusLost(evt);
            }
        });
        t_date1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date1KeyPressed(evt);
            }
        });

        t_date2.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_date2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_date2FocusLost(evt);
            }
        });
        t_date2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date2KeyPressed(evt);
            }
        });

        btn_Calendar1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar1.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        btn_Calendar1.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btn_Calendar1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_Calendar1ActionPerformed(evt);
            }
        });

        d_date1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        d_date1.setText("กำหนดช่วงเวลาการแสดงข้อมูล");
        d_date1.setName("d_date1"); // NOI18N

        db_btnProcress.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        db_btnProcress.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Hourglass-icon.png"))); // NOI18N
        db_btnProcress.setText("F5-ประมวลผล");
        db_btnProcress.setName("db_btnProcress"); // NOI18N
        db_btnProcress.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                db_btnProcressActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addComponent(d_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 37, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(t_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btn_Calendar, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(d_date3)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(t_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btn_Calendar1, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(db_btnProcress))
                    .addComponent(d_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 185, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(101, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel15Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(d_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 17, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addComponent(db_btnProcress, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(btn_Calendar1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(d_date3, javax.swing.GroupLayout.PREFERRED_SIZE, 17, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(t_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addComponent(btn_Calendar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(d_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 17, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(t_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(26, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, 490, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(151, 151, 151))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-1048)/2, (screenSize.height-768)/2, 1048, 768);
    }// </editor-fold>//GEN-END:initComponents
private void checkuserconfig() {
        //MenuName = Mast1
        UserLogin userrec = UserLogin.userlogin;
        if (userrec.getPlu5().equals("1")) {
            db_btnOK.setEnabled(false);
            db_btnDelete.setEnabled(false);
            db_btnDeleteAll.setEnabled(false);
            db_btnExel.setEnabled(false);
            btnuppriceall.setEnabled(false);
            btnuppromotionall.setEnabled(false);
        }
        if (userrec.getPlu5().equals("2")) {
            db_btnOK.setEnabled(true);
            db_btnDelete.setEnabled(false);
            db_btnDeleteAll.setEnabled(false);
            db_btnExel.setEnabled(true);
            btnuppriceall.setEnabled(true);
            btnuppromotionall.setEnabled(true);
        }
        if (userrec.getPlu5().equals("3")) {
            db_btnOK.setEnabled(true);
            db_btnDelete.setEnabled(true);
            db_btnDeleteAll.setEnabled(true);
            db_btnExel.setEnabled(true);
            btnuppriceall.setEnabled(true);
            btnuppromotionall.setEnabled(true);
        }
    }
    private void txtfPcodeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPcodeFocusGained
        txtfPcode.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPcodeFocusGained

    private void txtfPcodeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPcodeFocusLost
        if(!txtfPcode.getText().equals(""))
        {
            GetDataProduct(txtfPcode.getText());
        }
        else
        {
            txtfPdesc.setText("");
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPcodeFocusLost

    private void txtfPcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfPcodeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            txtfPcode.setText("");
            txtfPcode.requestFocus();
            clearAll();
        } else if (evt.getKeyCode() == KeyEvent.VK_F5) {
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            txtfBgroup1.requestFocus();
        } else if (evt.getKeyCode() == KeyEvent.VK_F1) {
            
            btnSearchProduct();
        }
        
        
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPcodeKeyPressed

    private void txtfPcodeKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfPcodeKeyReleased
        String get = txtfPcode.getText();
        String out = get.toUpperCase();
        txtfPcode.setText(out);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPcodeKeyReleased

    private void btnsearchpluActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsearchpluActionPerformed
        btnSearchProduct();

    }//GEN-LAST:event_btnsearchpluActionPerformed

    private void txtfBgroup1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfBgroup1FocusGained
        txtfBgroup1.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfBgroup1FocusGained

    private void txtfBgroup1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfBgroup1FocusLost
        if (!txtfBgroup1.getText().equals("")) {
            
            
                if (showeffective()) {
                    
                }
            
        }
        else {
            txtfBranchName.setText("");
        }
        txtfBgroup1.select(0, 0);

        // TODO add your handling code here:
    }//GEN-LAST:event_txtfBgroup1FocusLost

    private void txtfBgroup1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfBgroup1KeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            clear2();
        } else if (evt.getKeyCode() == KeyEvent.VK_F5) {
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date3.requestFocus();

        } else if (evt.getKeyCode() == KeyEvent.VK_F1) {

            if (!txtfPcode.getText().equals("") && !txtfPdesc.getText().equals("")) {
                btnSearchBgroup();
                t_date3.requestFocus();
                
            }

        }

        // TODO add your handling code here:
    }//GEN-LAST:event_txtfBgroup1KeyPressed

    private void btnsearchplu3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsearchplu3ActionPerformed
btnSearchBgroup();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnsearchplu3ActionPerformed

    private void db_btnOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnOKActionPerformed
        if(!txtfPdesc.getText().equals(""))
        {
        if (!txtfBranchName.getText().equals("")) {
            if (save()) {
                txtfBgroup1.requestFocus();
                
            } else {
            }
        } else {
            JOptionPane.showMessageDialog(this, "กลุ่มสาขาไม่ถูกต้องกรุณาเลือกกลุ่มสาขาก่อน");
            txtfBgroup1.setText("");
            clear2();
            txtfBgroup1.requestFocus();
            
        }
        }
        else
        {
            JOptionPane.showMessageDialog(this, "รายการสินค้าไม่ถูกต้องกรุณาเลือกรายการสินค้าก่อน");
            txtfPcode.setText("");
            txtfPcode.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnOKActionPerformed

    private void db_btnCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnCancelActionPerformed
//        clearplutxt();
        clear2();
        txtfBgroup1.requestFocus();
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnCancelActionPerformed

    private void txtfmEatInFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmEatInFocusGained
        
        txtfmEatIn.setText(txtfmEatIn.getText());
        txtfmEatIn.selectAll();
    }//GEN-LAST:event_txtfmEatInFocusGained

    private void txtfmEatInKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfmEatInKeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {

            txtfmTakeAway.requestFocus();
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmEatInKeyPressed

    private void txtfmTakeAwayFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmTakeAwayFocusGained
        
        txtfmTakeAway.setText(txtfmTakeAway.getText());
        txtfmTakeAway.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmTakeAwayFocusGained

    private void txtfmTakeAwayKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfmTakeAwayKeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            txtfmDelivery.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmTakeAwayKeyPressed

    private void txtfmDeliveryFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmDeliveryFocusGained
        txtfmDelivery.setText(txtfmDelivery.getText());
        txtfmDelivery.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmDeliveryFocusGained

    private void txtfmDeliveryKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfmDeliveryKeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            txtfmPinto.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmDeliveryKeyPressed

    private void txtfmPintoFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmPintoFocusGained
        txtfmPinto.setText(txtfmPinto.getText());
        txtfmPinto.selectAll();
        // TODO add your handling co
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmPintoFocusGained

    private void txtfmPintoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfmPintoKeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            txtfmWhole.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmPintoKeyPressed

    private void txtfmWholeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmWholeFocusGained
        txtfmWhole.setText(txtfmWhole.getText());
        txtfmWhole.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmWholeFocusGained

    private void txtfmWholeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfmWholeKeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            txtfPro1.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmWholeKeyPressed

    private void txtfPro1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPro1FocusGained
        txtfPro1.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro1FocusGained

    private void txtfPro1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPro1FocusLost
        if (txtfPro1.getText().equals("")) {
            txtfproname1.setText("");
        }
        txtfPro1.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro1FocusLost

    private void txtfPro1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfPro1KeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            txtfPro1.setText("");
            txtfPro1.requestFocus();
        } else if (evt.getKeyCode() == KeyEvent.VK_F5) {
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            if (!txtfPcode.getText().equals("") && !txtfPdesc.getText().equals("")) {
                if (EnterPromotion(1)) {
                    txtfPro2.requestFocus();
                }
            } else {
                txtfPro2.requestFocus();
            }

        } else if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnSearchPromotionSettext(1);

        }

        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro1KeyPressed

    private void btnsearchplu4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsearchplu4ActionPerformed
        if (!txtfPcode.getText().equals("") && !txtfBgroup1.getText().equals("") && !txtfPdesc.getText().equals("") && !txtfBranchName.getText().equals("")) {
            btnSearchPromotionSettext(1);
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_btnsearchplu4ActionPerformed

    private void btnsearchplu5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsearchplu5ActionPerformed
        if (!txtfPcode.getText().equals("") && !txtfBgroup1.getText().equals("") && !txtfPdesc.getText().equals("") && !txtfBranchName.getText().equals("")) {
            btnSearchPromotionSettext(2);
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnsearchplu5ActionPerformed

    private void txtfPro2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPro2FocusGained
        txtfPro2.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro2FocusGained

    private void txtfPro2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPro2FocusLost
        if (txtfPro2.getText().equals("")) {
            txtfproname2.setText("");
        }
        txtfPro2.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro2FocusLost

    private void txtfPro2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfPro2KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            txtfPro2.setText("");
            txtfPro2.requestFocus();
        } else if (evt.getKeyCode() == KeyEvent.VK_F5) {
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            if (!txtfPcode.getText().equals("") && !txtfPdesc.getText().equals("")) {
                if (EnterPromotion(2)) {
                    txtfPro3.requestFocus();
                }
            } else {
                txtfPro3.requestFocus();
            }


        } else if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnSearchPromotionSettext(2);

        }
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro2KeyPressed

    private void btnsearchplu6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnsearchplu6ActionPerformed
        if (!txtfPcode.getText().equals("") && !txtfBgroup1.getText().equals("") && !txtfPdesc.getText().equals("") && !txtfBranchName.getText().equals("")) {
            btnSearchPromotionSettext(3);
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnsearchplu6ActionPerformed

    private void txtfPro3FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPro3FocusGained
        txtfPro3.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro3FocusGained

    private void txtfPro3FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfPro3FocusLost
        if (txtfPro3.getText().equals("")) {
            txtfproname3.setText("");
        }
        txtfPro3.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro3FocusLost

    private void txtfPro3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfPro3KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            txtfPro3.setText("");
            txtfPro3.requestFocus();
        } else if (evt.getKeyCode() == KeyEvent.VK_F5) {
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {

            if (!txtfPcode.getText().equals("") && !txtfPdesc.getText().equals("")) {
                if (EnterPromotion(3)) {

                    db_btnOK.requestFocus();
                }
            } else {

                db_btnOK.requestFocus();
            }

        } else if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnSearchPromotionSettext(3);

        }

        // TODO add your handling code here:
    }//GEN-LAST:event_txtfPro3KeyPressed

    private void tblMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblMouseClicked
        indexplutbl = tbl.getSelectedRow();

        // TODO add your handling code here:
    }//GEN-LAST:event_tblMouseClicked

    private void tblMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblMouseReleased
        if (evt.getClickCount() == 2) {
            int rowSelect = tbl.getSelectedRow();
            String pcode = tbl.getValueAt(rowSelect, 0).toString();
            String pname = tbl.getValueAt(rowSelect, 1).toString();
            
            String pro1 = tbl.getValueAt(rowSelect, 8).toString();
            String pro2 = tbl.getValueAt(rowSelect, 9).toString();
            String pro3 = tbl.getValueAt(rowSelect, 10).toString();
            txtfBgroup1.setText(pcode);
            txtfBranchName.setText(pname);
            t_date3.setText(tbl.getValueAt(rowSelect, 2).toString());
            txtfmEatIn.setText(tbl.getValueAt(rowSelect, 3).toString());
            txtfmTakeAway.setText(tbl.getValueAt(rowSelect, 4).toString());
            txtfmDelivery.setText(tbl.getValueAt(rowSelect, 5).toString());
            txtfmPinto.setText(tbl.getValueAt(rowSelect, 6).toString());
            txtfmWhole.setText(tbl.getValueAt(rowSelect, 7).toString());
            txtfPro1.setText(pro1);
            txtfPro2.setText(pro2);
            txtfPro3.setText(pro3);
            settxtproname();



        }
        // TODO add your handling code here:
    }//GEN-LAST:event_tblMouseReleased

    private void tblKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tblKeyReleased
        indexplutbl = tbl.getSelectedRow();

        // TODO add your handling code here:
    }//GEN-LAST:event_tblKeyReleased

    private void db_btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnDeleteActionPerformed
        delete();
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnDeleteActionPerformed

    private void db_btnDeleteAllActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnDeleteAllActionPerformed
        deleteall();
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnDeleteAllActionPerformed

    private void Tabbed1MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_Tabbed1MouseClicked
        

        // TODO add your handling code here:
    }//GEN-LAST:event_Tabbed1MouseClicked

    private void btn_CalendarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CalendarActionPerformed
         DateUtil.showDateChooserDialog(t_date1, btn_Calendar);
         t_date1.requestFocus();
        //btncalendar1(t_date1);
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_CalendarActionPerformed

    private void t_date1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date1KeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
             DateUtil.showDateChooserDialog(t_date1, btn_Calendar);
         t_date1.requestFocus();
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date2.requestFocus();
        }
        else if (evt.getKeyCode() == KeyEvent.VK_F5) {
            Procress();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1KeyPressed

    private void t_date2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date2KeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            DateUtil.showDateChooserDialog(t_date2, btn_Calendar1);
         t_date2.requestFocus();
        } else if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date1.requestFocus();
        }
        else if (evt.getKeyCode() == KeyEvent.VK_F5) {
            Procress();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date2KeyPressed

    private void btn_Calendar1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_Calendar1ActionPerformed
         DateUtil.showDateChooserDialog(t_date2, btn_Calendar1);
         t_date2.requestFocus();
        //btncalendar1(t_date2);
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_Calendar1ActionPerformed

    private void db_btnProcressActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnProcressActionPerformed
        if(!t_date1.getText().equals(""))
        {
            if(!t_date2.getText().equals(""))
            {
        Procress();
            }
            else
            {
            JOptionPane.showMessageDialog(this, "กรุณากรอกวันที่");
            t_date2.requestFocus();
            }
        }
        else
        {
            JOptionPane.showMessageDialog(this, "กรุณากรอกวันที่");
            t_date1.requestFocus();
        }
    }//GEN-LAST:event_db_btnProcressActionPerformed

    private void t_date3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date3KeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            txtfmEatIn.requestFocus();
        }
        else if (evt.getKeyCode() == KeyEvent.VK_F1) {
            DateUtil.showDateChooserDialog(t_date3, btn_Calendar2);
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date3KeyPressed

    private void btn_Calendar2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_Calendar2ActionPerformed
        DateUtil.showDateChooserDialog(t_date3, btn_Calendar2);
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_Calendar2ActionPerformed

    private void t_date3FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_date3FocusLost
        if(!txtfBgroup1.getText().equals("")&&!txtfBranchName.getText().equals(""))
        {
            showeffective();
        }
        t_date3.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date3FocusLost

    private void txtfBgroup1KeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtfBgroup1KeyReleased
        txtfBgroup1.setText(txtfBgroup1.getText().toUpperCase());
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfBgroup1KeyReleased

    private void db_btnExelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnExelActionPerformed
        LinkAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnExelActionPerformed

    private void db_btnExel1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnExel1ActionPerformed
        if (tbl2.isExpanded(0)) {
            tbl2.collapseAll();
        } else {
            tbl2.expandAll();
            
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnExel1ActionPerformed

    private void txtfmWholeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmWholeFocusLost
        txtfmWhole.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmWholeFocusLost

    private void txtfmPintoFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmPintoFocusLost
        txtfmPinto.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmPintoFocusLost

    private void txtfmDeliveryFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmDeliveryFocusLost
        txtfmDelivery.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmDeliveryFocusLost

    private void txtfmTakeAwayFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmTakeAwayFocusLost
        txtfmTakeAway.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmTakeAwayFocusLost

    private void txtfmEatInFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtfmEatInFocusLost
        txtfmEatIn.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_txtfmEatInFocusLost

    private void t_date3FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_date3FocusGained
        t_date3.setText(t_date3.getText());
        t_date3.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date3FocusGained

    private void db_btnExel2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_db_btnExel2ActionPerformed
        Export2Excel test = new Export2Excel();
        JFileChooser chooser = new JFileChooser();

        try {
             chooser.setSelectedFile(test.getDefaulepath());
            chooser.setFileFilter(new JRSingleSheetXlsSaveContributor(Locale.ENGLISH, null));
            int confirm = chooser.showSaveDialog(this);
            if (confirm == JFileChooser.APPROVE_OPTION) {
                File curFile = chooser.getSelectedFile();
                if(curFile.exists())
                {
                    int confirm2 = JOptionPane.showConfirmDialog(this, "ข้อมูลนี้มีอยู่แล้ว คุณต้องการบันทึกรายการนี้หรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
                    if (confirm2 == JOptionPane.NO_OPTION) {
                        test.setDefaultpath(curFile);
                        db_btnExel1ActionPerformed(null);
                        
                        return;

                    }
                    
                }
                
                test.setOutputFile(curFile.toString());
                try {
                    test.writeTreetableNoSum(tbl2, tbl2.getColumnModel());
                    test.setDefaultpath(curFile);
                } catch (WriteException ex) {
                    
                }
            }

        } catch (IOException e) {
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_db_btnExel2ActionPerformed

    private void t_date1FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_date1FocusGained
        t_date1.setText(t_date1.getText());
        t_date1.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1FocusGained

    private void t_date2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_date2FocusGained
        t_date2.setText(t_date2.getText());
        t_date2.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date2FocusGained

    private void t_date1FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_date1FocusLost
        t_date1.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1FocusLost

    private void t_date2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_date2FocusLost
        t_date2.select(0, 0);
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date2FocusLost

    private void btnuppriceallActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnuppriceallActionPerformed
        // TODO add your handling code here:

        if (txtfPcode.getText().equals("")) {
            return;
        }
        if (!PUtility.ShowConfirmMsg("ยืนยันการปรับราคาสินค้า สำหรับทุก Branch Group ?...")) {
            return;
        }
        String TempDate = t_date3.getText() ;
        Date eff_date = null;
        try {
            eff_date = Format.dateFmtShow.parse(TempDate);
        } catch (ParseException ex) {
            Logger.getLogger(setEffective.class.getName()).log(Level.SEVERE, null, ex);
        }
        double Eatin = Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText()));
        double TakeAway = Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())) ;
        double Delivery = Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText()));
        double Pinto = Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText()));
        double Whole = Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText()));
        double TotPrice = Eatin + TakeAway + Delivery + Pinto + Whole;
        if (TotPrice == 0) {
            PUtility.ShowMsg("กรุณากำหนด ราคาขายสินค้า ก่อน ทำรายการนี้...");
        } else {
            try {
                stmt = (Statement) db.con.createStatement();
                String sql = "Update effective set price1=?,price2 = ?,price3 = ?,price4 = ?,price5 = ?  where eff_date=? and pcode = ? ";
                PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
                prm.setDouble(1, Eatin);
                prm.setDouble(2, TakeAway);
                prm.setDouble(3, Delivery);
                prm.setDouble(4, Pinto);
                prm.setDouble(5, Whole);
                prm.setString(6, Format.dateFmtSql.format(eff_date));
                prm.setString(7, txtfPcode.getText());
                prm.executeUpdate();
                stmt.close();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e.getMessage(), "Update Error", JOptionPane.ERROR_MESSAGE);
            }
        }
        Procress();
    }//GEN-LAST:event_btnuppriceallActionPerformed

    private void btnuppromotionallActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnuppromotionallActionPerformed
        // TODO add your handling code here:
        if (txtfPcode.getText().equals("")) {
            return;
        }
        if (!PUtility.ShowConfirmMsg("ยืนยันการปรับโปรโมชั่นสินค้า สำหรับทุก Branch Group ?...")) {
            return;
        }
        String TempDate = t_date3.getText() ;
        Date eff_date = null;
        try {
            eff_date = Format.dateFmtShow.parse(TempDate);
        } catch (ParseException ex) {
            Logger.getLogger(setEffective.class.getName()).log(Level.SEVERE, null, ex);
        } 
        try {
            stmt = (Statement) db.con.createStatement();
            String sql = "Update effective set promotion1=?,promotion2 = ?,promotion3 = ?  where pcode = ? and eff_date=? ";
            PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
            prm.setString(1, txtfPro1.getText());
            prm.setString(2, txtfPro2.getText());
            prm.setString(3, txtfPro3.getText());
            prm.setString(4, cvth.Unicode2ASCII(txtfPcode.getText()));
            prm.setString(5, cvth.Unicode2ASCII(dateFmtSave.format(new java.util.Date())));
            prm.executeUpdate();
            stmt.close();

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Update Error", JOptionPane.ERROR_MESSAGE);
        }
        Procress();
    }//GEN-LAST:event_btnuppromotionallActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /*
         * Set the Nimbus look and feel
         */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /*
         * If Nimbus (introduced in Java SE 6) is not available, stay with the
         * default look and feel. For details see
         * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(setEffective.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(setEffective.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(setEffective.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(setEffective.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /*
         * Create and display the dialog
         */
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                setEffective dialog = new setEffective(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {

                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTabbedPane Tabbed1;
    private javax.swing.JButton btn_Calendar;
    private javax.swing.JButton btn_Calendar1;
    private javax.swing.JButton btn_Calendar2;
    private javax.swing.JButton btnsearchplu;
    private javax.swing.JButton btnsearchplu3;
    private javax.swing.JButton btnsearchplu4;
    private javax.swing.JButton btnsearchplu5;
    private javax.swing.JButton btnsearchplu6;
    private javax.swing.JButton btnuppriceall;
    private javax.swing.JButton btnuppromotionall;
    private javax.swing.JLabel d_date1;
    private javax.swing.JLabel d_date2;
    private javax.swing.JLabel d_date3;
    private javax.swing.JLabel d_date4;
    private javax.swing.JLabel d_lblDelivery;
    private javax.swing.JLabel d_lblPinto;
    private javax.swing.JLabel d_lblTake;
    private javax.swing.JLabel d_lblWhole;
    private javax.swing.JLabel d_lbleatin;
    private javax.swing.JLabel d_lblpcode;
    private javax.swing.JButton db_btnCancel;
    private javax.swing.JButton db_btnDelete;
    private javax.swing.JButton db_btnDeleteAll;
    private javax.swing.JButton db_btnExel;
    private javax.swing.JButton db_btnExel1;
    private javax.swing.JButton db_btnExel2;
    private javax.swing.JButton db_btnOK;
    private javax.swing.JButton db_btnProcress;
    private javax.swing.JLabel db_lblCount;
    private javax.swing.JLabel db_lblCount1;
    private javax.swing.JLabel db_lblCount2;
    private javax.swing.JLabel db_lblPro;
    private javax.swing.JLabel db_lblh1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JFormattedTextField t_date1;
    private javax.swing.JFormattedTextField t_date2;
    private javax.swing.JFormattedTextField t_date3;
    private javax.swing.JTable tbl;
    private org.jdesktop.swingx.JXTreeTable tbl2;
    private javax.swing.JTextField txtfBgroup1;
    private javax.swing.JTextField txtfBranchName;
    private javax.swing.JTextField txtfPcode;
    private javax.swing.JTextField txtfPdesc;
    private javax.swing.JTextField txtfPro1;
    private javax.swing.JTextField txtfPro2;
    private javax.swing.JTextField txtfPro3;
    private javax.swing.JFormattedTextField txtfmDelivery;
    private javax.swing.JFormattedTextField txtfmEatIn;
    private javax.swing.JFormattedTextField txtfmPinto;
    private javax.swing.JFormattedTextField txtfmTakeAway;
    private javax.swing.JFormattedTextField txtfmWhole;
    private javax.swing.JTextField txtfproname1;
    private javax.swing.JTextField txtfproname2;
    private javax.swing.JTextField txtfproname3;
    // End of variables declaration//GEN-END:variables
public void btnSearchProduct()
  {
      txtfPcode.setText("");
      ListProduct f = new ListProduct(new NimbusFrame(), true);
      f.setVisible(true);
      if(!f.code.equals(""))
    {
            txtfPcode.setText(f.code);
            GetDataProduct(txtfPcode.getText());
    }
      
  }
public void btnSearchBgroup()
  {
      listBgroupOfEff f = new listBgroupOfEff(new NimbusFrame(), true,txtfPcode.getText());
      f.setVisible(true);
      if(!f.bcode.equals(""))
    {
            txtfBgroup1.setText(f.bcode);
            //GetDataBgroup(txtfBgroup1.getText());
            showeffective();
    }
      
  }
    public void btnSearchPromotionSettext(int txtfno)
{
    listPromotion f = new listPromotion(new NimbusFrame(), true);
    f.setVisible(true);
    if(!f.bcode.equals(""))
    {
        if(txtfno == 1)
        {
            txtfPro1.setText(f.bcode);
            if(!getpromotionname(txtfPro1.getText()).equals("Null")&&!getpromotionname(txtfPro1.getText()).equals(""))
            {
                txtfproname1.setText(getpromotionname(txtfPro1.getText()));
                txtfPro1.requestFocus();
            }
            else 
            {
                JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง");
                txtfPro1.requestFocus();
            }
            
        }
        else if(txtfno == 2)
        {
            txtfPro2.setText(f.bcode);
              if(!getpromotionname(txtfPro2.getText()).equals("Null")&&!getpromotionname(txtfPro2.getText()).equals(""))
            {
                txtfproname2.setText(getpromotionname(txtfPro2.getText()));
                txtfPro2.requestFocus();
            }
            else 
            {
                JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง");
                txtfPro2.requestFocus();
            }
            
        }
        else if(txtfno == 3)
        {
            txtfPro3.setText(f.bcode);
              if(!getpromotionname(txtfPro3.getText()).equals("Null")&&!getpromotionname(txtfPro3.getText()).equals(""))
            {
                txtfproname3.setText(getpromotionname(txtfPro3.getText()));
                txtfPro3.requestFocus();
            }
            else 
            {
                JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง");
                txtfPro3.requestFocus();
            }
        }
        
    }
}
public boolean EnterPromotion(int txtfno)
{
        boolean chk = true;
   
        if(txtfno == 1)
        {
         if(!txtfPro1.getText().equals("")){   
            if(!getpromotionname(txtfPro1.getText()).equals("Null"))
            {
                
                txtfproname1.setText(getpromotionname(txtfPro1.getText()));
                chk = true;
            }
            
            else if(getpromotionname(txtfPro1.getText()).equals("Null"))
            {
                JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง");
                txtfPro1.requestFocus();
                txtfproname1.setText("");
                chk = false;
            }
         }
        }
        else if(txtfno == 2)
        {
            if(!txtfPro2.getText().equals("")){
              if(!getpromotionname(txtfPro2.getText()).equals("Null"))
            {
                txtfproname2.setText(getpromotionname(txtfPro2.getText()));
                chk = true;
            }
              
            else if(getpromotionname(txtfPro2.getText()).equals("Null"))
            {
                JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง");
                txtfPro2.requestFocus();
                txtfproname2.setText("");
                chk = false;
            }
            }
        }
        else if(txtfno == 3)
        {
            if(!txtfPro3.getText().equals("")){
              if(!getpromotionname(txtfPro3.getText()).equals("Null"))
            {
                txtfproname3.setText(getpromotionname(txtfPro3.getText()));
                chk = true;
            }
            
            else if(getpromotionname(txtfPro3.getText()).equals("Null"))
            {
                JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง");
                txtfPro3.requestFocus();
                txtfproname3.setText("");
                chk = false;
            }
            }
        }
        
        
    return chk;
}
public String getpromotionname(String code)
    {
        ResultSet rs = null;
    try {
        if(!db.Char_Set.equalsIgnoreCase("utf-8"))
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from protab where procode ='"+cvth.Unicode2ASCII(code)+"'";
        rs = stmt.executeQuery(sql);
        if(rs.next())
        {
           return cvth.ASCII2Unicode(rs.getString("prodesc"));
        }
        else return "Null";
        }
        else
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from protab where procode ='"+code+"";
        rs = stmt.executeQuery(sql);
         if(rs.next())
        {
            return rs.getString("prodesc");
            
        }
        else return "Null";
        
        }
    } catch (Exception e) {
        
    }
        return "";
    }
public void settxtproname()      
    {
        txtfproname1.setText("");
        txtfproname2.setText("");
        txtfproname3.setText("");
        if(!txtfPro1.getText().equals(""))
        {
            txtfproname1.setText(getpromotionname(txtfPro1.getText()));
        }
        if(!txtfPro2.getText().equals(""))
        {
            txtfproname2.setText(getpromotionname(txtfPro2.getText()));
        }
        if(!txtfPro3.getText().equals(""))
        {
            txtfproname3.setText(getpromotionname(txtfPro3.getText()));
        }
    }
    public void btncalendar1(JFormattedTextField txt){
        try {
             Point point = txt.getLocation();
            point.setLocation(point.getX() + 580, point.getY() + 50);
            utilities.DateChooser.DateChooserDialog dcd = new utilities.DateChooser.DateChooserDialog(null, true, point);
            dcd.setVisible(true);
            if(!dcd.getSelectedDate().getTime().equals(null))
            {
            txt.setText(Format.dateFmtShow.format(dcd.getSelectedDate().getTime()));
            txt.requestFocus();
            }
            
        } catch (Exception e) {
            
        }
       
    }
    
    public void btncalendar2(JFormattedTextField txt){
        try {
             Point point = txt.getLocation();
            point.setLocation(point.getX() + 120, point.getY() + 210);
            utilities.DateChooser.DateChooserDialog dcd = new utilities.DateChooser.DateChooserDialog(null, true, point);
            dcd.setVisible(true);
            if(!dcd.getSelectedDate().getTime().equals(null))
            {
            txt.setText(Format.dateFmtShow.format(dcd.getSelectedDate().getTime()));
            txt.requestFocus();
            }
            
        } catch (Exception e) {
            
        }
       
    }
    
    public void GetDataProduct(String Code) {
        
        clear2();
            try {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                String sql = "select * from product where PCode='" + cvth.Unicode2ASCII(Code) + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                        txtfPcode.setText(cvth.ASCII2Unicode(rs.getString("PCode")));
                        txtfPdesc.setText(cvth.ASCII2Unicode(rs.getString("PDesc")));
                        txtfBgroup1.requestFocus();
                        showdataintb(Code);
                } else {
                JOptionPane.showMessageDialog(this, "ข้อมูลไม่ถูกต้อง กรุณากรอกข้อมูลให้ถูกต้อง");
                txtfPcode.requestFocus();
                txtfPcode.setText("");
                txtfPdesc.setText("");
                showdataintb(Code);
                }
                rs.close();
                stmt.close();
                }
                else
                {
                String sql = "select * from product where PCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                        txtfPcode.setText(rs.getString("PCode"));
                        txtfPdesc.setText(rs.getString("PDesc"));
                        txtfBgroup1.requestFocus();
                        showdataintb(Code);
                } else {
                JOptionPane.showMessageDialog(this, "ข้อมูลไม่ถูกต้อง กรุณากรอกข้อมูลให้ถูกต้อง");
                txtfPcode.requestFocus();
                txtfPcode.setText("");
                txtfPdesc.setText("");
                showdataintb(Code);
                }
                rs.close();
                stmt.close();
                }
                
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        
    }

    private void clear2() {
        txtfBgroup1.setText("");
        txtfBranchName.setText("");
        txtfmEatIn.setText("0.00");
    txtfmTakeAway.setText("0.00");
    txtfmDelivery.setText("0.00");
    txtfmPinto.setText("0.00");
    txtfmWhole.setText("0.00");
    txtfPro1.setText("");
    txtfPro2.setText("");
    txtfPro3.setText("");
    txtfproname1.setText("");
    txtfproname2.setText("");
    txtfproname3.setText("");
    t_date3.setText(Format.dateFmtShow.format(new java.util.Date()));
    indexplutbl = -1;
    
    }
    public void clearAll()
    {
    txtfPcode.setText("");
    txtfPdesc.setText("");
    txtfBgroup1.setText("");
        txtfBranchName.setText("");
    txtfmEatIn.setText("0.00");
    txtfmTakeAway.setText("0.00");
    txtfmDelivery.setText("0.00");
    txtfmPinto.setText("0.00");
    txtfmWhole.setText("0.00");
    txtfPro1.setText("");
    txtfPro2.setText("");
    txtfPro3.setText("");
    txtfproname1.setText("");
    txtfproname2.setText("");
    txtfproname3.setText("");
    indexplutbl = -1;
    }

    
     public void removetbl()
    {
    tbmodel = (DefaultTableModel) tbl.getModel();
        int cnt = tbmodel.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                tbmodel.removeRow(0);
            }
    }
    }
    public void showdataintb(String Code) {
        stmt = null;
        ResultSet rs = null;


        removetbl();
        tbmodel = (DefaultTableModel) tbl.getModel();
        setDate();
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select * from effective e left join branchgroup b on bgroup=bgroupcode "
                   
                    + "where pcode = '" + cvth.Unicode2ASCII(Code) + "'"
                    + " and eff_date >= '"+date1+"' and eff_date<='"+date2+"' order by eff_date,bgroup";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                
                  
                        
                        tbmodel.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("Bgroup")),
                                    cvth.ASCII2Unicode(rs.getString("bgroupname")),
                                    Format.dateFmtShow.format(rs.getDate("eff_date")),
                                    Format.doubleFmt.format(rs.getDouble("price1")),
                                    Format.doubleFmt.format(rs.getDouble("price2")),
                                    Format.doubleFmt.format(rs.getDouble("price3")),
                                    Format.doubleFmt.format(rs.getDouble("price4")),
                                    Format.doubleFmt.format(rs.getDouble("price5")),
                                    cvth.ASCII2Unicode(rs.getString("promotion1")),
                                    cvth.ASCII2Unicode(rs.getString("promotion2")),
                                    cvth.ASCII2Unicode(rs.getString("promotion3")),
                                    rs.getString("flage")
                        });
                    
                
            }
            
            }
            else
            {
                stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select * from effective e left join branchgroup b on bgroup=bgroupcode "
                   
                    + "where pcode = '" + Code + "'"
                    + " and eff_date >= '"+date1+"' and eff_date<='"+date2+"' order by eff_date,bgroup";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                
                  
                        
                        tbmodel.addRow(new Object[]{rs.getString("Bgroup"),
                                    rs.getString("bgroupname"),
                                    Format.dateFmtShow.format(rs.getDate("eff_date")),
                                    Format.doubleFmt.format(rs.getDouble("price1")),
                                    Format.doubleFmt.format(rs.getDouble("price2")),
                                    Format.doubleFmt.format(rs.getDouble("price3")),
                                    Format.doubleFmt.format(rs.getDouble("price4")),
                                    Format.doubleFmt.format(rs.getDouble("price5")),
                                    rs.getString("promotion1"),
                                    rs.getString("promotion2"),
                                    rs.getString("promotion3"),
                                    rs.getString("flage")
                        });
                    
                
            }
                
            
            }
            setCount();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e);
        }
    }
    String date1="",date2="",date3="";
    private void setDate() {
        try {
            if(!t_date1.getText().equals(""))
            {
                Date d1 = Format.dateFmtShow.parse(t_date1.getText());
                date1 = Format.dateFmtSql.format(d1);
            }
            else
            {
                date1 = "";
            }
            
            if(!t_date2.getText().equals(""))
            {
            Date d2 = Format.dateFmtShow.parse(t_date2.getText());
            date2 = Format.dateFmtSql.format(d2);
            }
            else
            {
                date2 = "";
            }
            if(!t_date3.getText().equals(""))
            {
            Date d3 = Format.dateFmtShow.parse(t_date3.getText());
            date3 = Format.dateFmtSql.format(d3);
            }
            else
            {
                date3 = "";
            }
        } catch (ParseException ex) {
            Logger.getLogger(setEffective.class.getName()).log(Level.SEVERE, null, ex);
        }
        
    }
    public boolean showeffective()
    {
        boolean chk = false;
         ResultSet rs = null;
         setDate();
    try {
        if(!db.Char_Set.equalsIgnoreCase("utf-8"))
        {
        stmt = (Statement) db.con.createStatement();
            if(chkeff(txtfPcode.getText(), txtfBgroup1.getText(),date3))
            {
                String sql = "select * from effective e inner join branchgroup b on e.bgroup = b.bgroupcode where e.pcode ='"+cvth.Unicode2ASCII(txtfPcode.getText())+"' and e.bgroup='"+cvth.Unicode2ASCII(txtfBgroup1.getText())+"' and e.eff_date = '"+date3+"'";
                rs = stmt.executeQuery(sql);
                if(rs.next())
                {
                txtfBgroup1.setText(cvth.ASCII2Unicode(rs.getString("e.bgroup").toUpperCase()));
                txtfBranchName.setText(cvth.ASCII2Unicode(rs.getString("b.bgroupname")));
                txtfmEatIn.setText(DoubleFmt.format(rs.getDouble("price1")));
                txtfmTakeAway.setText(DoubleFmt.format(rs.getDouble("price2")));
                txtfmDelivery.setText(DoubleFmt.format(rs.getDouble("price3")));
                txtfmPinto.setText(DoubleFmt.format(rs.getDouble("price4")));
                txtfmWhole.setText(DoubleFmt.format(rs.getDouble("price5")));
                txtfPro1.setText(cvth.ASCII2Unicode(rs.getString("promotion1")));
                txtfPro2.setText(cvth.ASCII2Unicode(rs.getString("promotion2")));
                txtfPro3.setText(cvth.ASCII2Unicode(rs.getString("promotion3")));
                chk=true;
                }
            }
            else
            {
                String sql = "select * from blink l inner join branchgroup b on l.bgroup = b.bgroupcode where pcode ='"+cvth.Unicode2ASCII(txtfPcode.getText())+"' and bgroup ='"+cvth.Unicode2ASCII(txtfBgroup1.getText())+"'";
                rs = stmt.executeQuery(sql);
                if(rs.next())
                {
                txtfBgroup1.setText(cvth.ASCII2Unicode(rs.getString("bgroup").toUpperCase()));
                txtfBranchName.setText(cvth.ASCII2Unicode(rs.getString("bgroupname")));
                txtfmEatIn.setText(DoubleFmt.format(rs.getDouble("price1")));
                txtfmTakeAway.setText(DoubleFmt.format(rs.getDouble("price2")));
                txtfmDelivery.setText(DoubleFmt.format(rs.getDouble("price3")));
                txtfmPinto.setText(DoubleFmt.format(rs.getDouble("price4")));
                txtfmWhole.setText(DoubleFmt.format(rs.getDouble("price5")));
                txtfPro1.setText(cvth.ASCII2Unicode(rs.getString("promotion1")));
                txtfPro2.setText(cvth.ASCII2Unicode(rs.getString("promotion2")));
                txtfPro3.setText(cvth.ASCII2Unicode(rs.getString("promotion3")));
                chk=true;
                }
                else
                {
                    JOptionPane.showMessageDialog(this, "กำหนดรหัสกลุ่มสาขาไม่ถูกต้อง");
                    txtfBgroup1.requestFocus();
                    clear2();
                    return false;
                }
            }
                settxtproname();
        
        }
        else
        {
            stmt = (Statement) db.con.createStatement();
            if(chkeff(txtfPcode.getText(), txtfBgroup1.getText(),date3))
            {
                String sql = "select * from effective e inner join branchgroup b on e.bgroup = b.bgroupcode where e.pcode ='"+txtfPcode.getText()+"' and e.bgroup='"+txtfBgroup1.getText()+"' and e.eff_date = '"+date3+"'";
                rs = stmt.executeQuery(sql);
                if(rs.next())
                {
                txtfBgroup1.setText(rs.getString("e.bgroup").toUpperCase());
                txtfBranchName.setText(rs.getString("b.bgroupname"));
                txtfmEatIn.setText(DoubleFmt.format(rs.getDouble("price1")));
                txtfmTakeAway.setText(DoubleFmt.format(rs.getDouble("price2")));
                txtfmDelivery.setText(DoubleFmt.format(rs.getDouble("price3")));
                txtfmPinto.setText(DoubleFmt.format(rs.getDouble("price4")));
                txtfmWhole.setText(DoubleFmt.format(rs.getDouble("price5")));
                txtfPro1.setText(rs.getString("promotion1"));
                txtfPro2.setText(rs.getString("promotion2"));
                txtfPro3.setText(rs.getString("promotion3"));
                chk=true;
                }
            }
            else
            {
                String sql = "select * from blink l inner join branchgroup b on l.bgroup = b.bgroupcode where pcode ='"+txtfPcode.getText()+"' and bgroup ='"+txtfBgroup1.getText()+"'";
                rs = stmt.executeQuery(sql);
                if(rs.next())
                {
                txtfBgroup1.setText(rs.getString("bgroup").toUpperCase());
                txtfBranchName.setText(rs.getString("bgroupname"));
                txtfmEatIn.setText(DoubleFmt.format(rs.getDouble("price1")));
                txtfmTakeAway.setText(DoubleFmt.format(rs.getDouble("price2")));
                txtfmDelivery.setText(DoubleFmt.format(rs.getDouble("price3")));
                txtfmPinto.setText(DoubleFmt.format(rs.getDouble("price4")));
                txtfmWhole.setText(DoubleFmt.format(rs.getDouble("price5")));
                txtfPro1.setText(rs.getString("promotion1"));
                txtfPro2.setText(rs.getString("promotion2"));
                txtfPro3.setText(rs.getString("promotion3"));
                chk=true;
                }
                else
                {
                    JOptionPane.showMessageDialog(this, "กำหนดรหัสกลุ่มสาขาไม่ถูกต้อง");
                    txtfBgroup1.requestFocus();
                    clear2();
                    return false;
                }
            }
                settxtproname();
        
        }
    } catch (Exception e) {
        
    }
    
    return chk;
        
    }
    
    private boolean chkpcode(String code) {
        boolean chk = false;
    ResultSet rs = null;
    try {
        if(!db.Char_Set.equalsIgnoreCase("utf-8"))
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from effective where pcode ='"+cvth.Unicode2ASCII(code)+"'";
        rs = stmt.executeQuery(sql);
        if(rs.next())
        {
           chk = true;
        }
      
        }
        else
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from effective where pcode ='"+code+"'";
        rs = stmt.executeQuery(sql);
         if(rs.next())
        {
            chk = true;
            
        }
        
        }
    } catch (Exception e) {
        
    }
    return chk;
    }
    
    private boolean chkpcodeinblink(String code) {
        boolean chk = false;
    ResultSet rs = null;
    try {
        if(!db.Char_Set.equalsIgnoreCase("utf-8"))
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from blink where pcode ='"+cvth.Unicode2ASCII(code)+"'";
        rs = stmt.executeQuery(sql);
        if(rs.next())
        {
           chk = true;
        }
      
        }
        else
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from blink where pcode ='"+code+"'";
        rs = stmt.executeQuery(sql);
         if(rs.next())
        {
            chk = true;
            
        }
        
        }
    } catch (Exception e) {
        
    }
    return chk;
    }
    
    public boolean chkeff(String code,String bgroupcode,String date)
{   
    boolean chk = false;
    ResultSet rs = null;
    try {
        if(!db.Char_Set.equalsIgnoreCase("utf-8"))
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from effective where pcode ='"+cvth.Unicode2ASCII(code)+"' and bgroup='"+cvth.Unicode2ASCII(bgroupcode)+"' and eff_date ='"+date+"'";
        rs = stmt.executeQuery(sql);
        if(rs.next())
        {
           chk = true;
        }
      
        }
        else
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from effective where pcode ='"+code+"' and bgroup='"+bgroupcode+"' and eff_date ='"+date+"'";
        rs = stmt.executeQuery(sql);
         if(rs.next())
        {
            chk = true;
            
        }
        
        }
    } catch (Exception e) {
        
    }
    return chk;
}
    public boolean save() {
       boolean chk = false;
       setDate();
        if(validateSave())
    {
        if(chkeff(txtfPcode.getText(), txtfBgroup1.getText(),date3))
        {
            
            try {
            if(!db.Char_Set.equalsIgnoreCase("utf-8"))
            {
               stmt = (Statement) db.con.createStatement();
               String sql = "Update effective set price1=?,price2 = ?,price3 = ?,price4 = ?,price5 = ?,promotion1 = ?,promotion2 = ?,promotion3 = ? where eff_date =? and pcode = ? and bgroup = ?";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, cvth.Unicode2ASCII(txtfPro1.getText()));
               prm.setString(7, cvth.Unicode2ASCII(txtfPro2.getText()));
               prm.setString(8, cvth.Unicode2ASCII(txtfPro3.getText()));
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, cvth.Unicode2ASCII(txtfPcode.getText()));
               prm.setString(11, cvth.Unicode2ASCII(txtfBgroup1.getText()));
               prm.executeUpdate();
               chk = true;
            }
            else
            {
               stmt = (Statement) db.con.createStatement();
               String sql = "Update effective set price1=?,price2 = ?,price3 = ?,price4 = ?,price5 = ?,promotion1 = ?,promotion2 = ?,promotion3 = ? where eff_date =? and pcode = ? and bgroup = ?";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, txtfPro1.getText());
               prm.setString(7, txtfPro2.getText());
               prm.setString(8, txtfPro3.getText());
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, txtfPcode.getText());
               prm.setString(11, txtfBgroup1.getText());
               prm.executeUpdate();
               chk = true;
                   
            }
               stmt.close();
               clear2();
               
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e.getMessage(), "Update Error", JOptionPane.ERROR_MESSAGE);
            }
        }
        else
        {
            try {
             if(!db.Char_Set.equalsIgnoreCase("utf-8"))
            {
               stmt = (Statement) db.con.createStatement();
               String sql = "Insert into effective (price1,price2 ,price3 ,price4 ,price5 ,promotion1 ,promotion2 ,promotion3 , eff_date, pcode ,bgroup ) values(?,?,?,?,?,?,?,?,?,?,?)";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, cvth.Unicode2ASCII(txtfPro1.getText()));
               prm.setString(7, cvth.Unicode2ASCII(txtfPro2.getText()));
               prm.setString(8, cvth.Unicode2ASCII(txtfPro3.getText()));
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, cvth.Unicode2ASCII(txtfPcode.getText()));
               prm.setString(11, cvth.Unicode2ASCII(txtfBgroup1.getText()));
               
               prm.executeUpdate();
               chk = true;
            }
            else
            {
               stmt = (Statement) db.con.createStatement();
               String sql = "Insert into effective (price1,price2 ,price3 ,price4 ,price5 ,promotion1 ,promotion2 ,promotion3 , eff_date, pcode ,bgroup ) values(?,?,?,?,?,?,?,?,?,?,?)";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, txtfPro1.getText());
               prm.setString(7, txtfPro2.getText());
               prm.setString(8, txtfPro3.getText());
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, txtfPcode.getText());
               prm.setString(11, txtfBgroup1.getText());
               
               prm.executeUpdate();
               chk = true;
            }
               stmt.close();
               clear2();
               
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e.getMessage(), "Insert Error", JOptionPane.ERROR_MESSAGE);
            }
        }
        
        Procress();
        
    }
        return chk;
    }
    private boolean validateSave() {
        boolean chk = true;
        if(txtfPcode.getText().trim().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสินค้าให้ถูกต้อง");
            chk = false;
            txtfPcode.requestFocus();
        }
        else if(txtfBranchName.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสาขาไม่ถูกต้อง... ");
            chk = false;
            txtfBgroup1.requestFocus();
        }
        else if(t_date3.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนด Effective ไม่ถูกต้อง... ");
            chk = false;
            t_date3.requestFocus();
        }
        else if(txtfBgroup1.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสาขาไม่ถูกต้อง... ");
            chk = false;
            txtfBgroup1.requestFocus();
        }
        else if(txtfBgroup1.getText().length()>3)
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสาขาไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 3 ตัวอักษร)");
            chk = false;
            txtfBgroup1.requestFocus();
        }
        
        
        else if(txtfPcode.getText().length()>13)
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสินค้าไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 13 ตัวอักษร)");
            chk = false;
            txtfPcode.requestFocus();
        }
        else if(txtfPro1.getText().length()>3)
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 3 ตัวอักษร)");
            chk = false;
            txtfPro1.requestFocus();
        }
        else if(txtfPro2.getText().length()>3)
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 3 ตัวอักษร)");
            chk = false;
            txtfPro2.requestFocus();
        }
        else if(txtfPro3.getText().length()>3)
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสโปรโมชั่นไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 3 ตัวอักษร)");
            chk = false;
            txtfPro3.requestFocus();
        }
        else if(txtfBgroup1.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสาขาไม่ถูกต้อง... ");
            chk = false;
            txtfBgroup1.requestFocus();
        }
        else if(txtfBgroup1.getText().length()>3)
        {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสสาขาไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 3 ตัวอักษร)");
            chk = false;
            txtfBgroup1.requestFocus();
        }
        else if(txtfmEatIn.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดข้อมูลไม่ถูกต้อง... ");
            chk = false;
            txtfmEatIn.requestFocus();
        }
        else if(txtfmDelivery.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดข้อมูลไม่ถูกต้อง... ");
            chk = false;
            txtfmDelivery.requestFocus();
        }
        else if(txtfmPinto.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดข้อมูลไม่ถูกต้อง... ");
            chk = false;
            txtfmPinto.requestFocus();
        }
        else if(txtfmTakeAway.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดข้อมูลไม่ถูกต้อง... ");
            chk = false;
            txtfmTakeAway.requestFocus();
        }
        else if(txtfmWhole.getText().equals(""))
        {
            JOptionPane.showMessageDialog(this, "กำหนดข้อมูลไม่ถูกต้อง... ");
            chk = false;
            txtfmWhole.requestFocus();
        }
        
        
        Double eatin = Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText()));
        Double delivery = Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText()));
        Double pinto = Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText()));
        Double take = Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText()));
        Double whole = Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText()));
        if (eatin < 0 || eatin > 99999999.99) {
            JOptionPane.showMessageDialog(this, "ระบบไม่สามารถจัดเก็บได้ จำนวนเงินต้องไม่น้อยกว่า 0.00 และมากเกิน 99,999,999.99 ล้านบาท");
            chk = false;
            txtfmEatIn.requestFocus();
        }
        else if (delivery < 0 || delivery > 99999999.99) {
            JOptionPane.showMessageDialog(this, "ระบบไม่สามารถจัดเก็บได้ จำนวนเงินต้องไม่น้อยกว่า 0.00 และมากเกิน 99,999,999.99 ล้านบาท");
            chk = false;
            txtfmDelivery.requestFocus();
        }
        else if (pinto < 0 || pinto > 99999999.99) {
            JOptionPane.showMessageDialog(this, "ระบบไม่สามารถจัดเก็บได้ จำนวนเงินต้องไม่น้อยกว่า 0.00 และมากเกิน 99,999,999.99 ล้านบาท");
            chk = false;
            txtfmPinto.requestFocus();
        }
        else if (take < 0 || take > 99999999.99) {
            JOptionPane.showMessageDialog(this, "ระบบไม่สามารถจัดเก็บได้ จำนวนเงินต้องไม่น้อยกว่า 0.00 และมากเกิน 99,999,999.99 ล้านบาท");
            chk = false;
            txtfmTakeAway.requestFocus();
        }
        else if (whole < 0 || whole > 99999999.99) {
            JOptionPane.showMessageDialog(this, "ระบบไม่สามารถจัดเก็บได้ จำนวนเงินต้องไม่น้อยกว่า 0.00 และมากเกิน 99,999,999.99 ล้านบาท");
            chk = false;
            txtfmWhole.requestFocus();
        }
     
        return chk;
    }
    
    private void delete() {
       if(indexplutbl!=-1 && !txtfPcode.getText().equals(""))
    {
            try {
                setDate();
                Date d = Format.dateFmtShow.parse(tbl.getValueAt(indexplutbl, 2).toString());
                String date = Format.dateFmtSql.format(d);
                if(chkeff(txtfPcode.getText(),tbl.getValueAt(indexplutbl, 0).toString(),date))
                {
                
                    int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลรายการที่เลือกหรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
                    if (confirm == JOptionPane.YES_OPTION) {
                    try {
                    if(!db.Char_Set.equalsIgnoreCase("utf-8"))
                    {
                       stmt = (Statement) db.con.createStatement();
                       String sql = "delete from effective where pcode = ? and bgroup = ? and eff_date = ?";
                       PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
                       prm.setString(1, cvth.Unicode2ASCII(txtfPcode.getText()));
                       prm.setString(2, cvth.Unicode2ASCII(tbl.getValueAt(indexplutbl, 0).toString()));
                       prm.setString(3, date);
                       prm.executeUpdate();
                    }
                    else
                    {
                       stmt = (Statement) db.con.createStatement();
                       String sql = "delete from effective where pcode = ? and bgroup = ? and eff_date = ?";
                       PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
                       prm.setString(1, txtfPcode.getText());
                       prm.setString(2, tbl.getValueAt(indexplutbl, 0).toString());
                       prm.setString(3, date);
                       prm.executeUpdate();
                           
                    }
                       stmt.close();
                       clear2();
                       indexplutbl = -1;
                       
                    } catch (Exception e) {
                        JOptionPane.showMessageDialog(this, e.getMessage(), "Delete Error", JOptionPane.ERROR_MESSAGE);
                    }
                        }
                    else{indexplutbl = -1;}
                }
                Procress();
            } catch (ParseException ex) {
                Logger.getLogger(setEffective.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        
        
    }
    private void deleteall() {
       if(!txtfPcode.getText().equals("")&&tbl.getRowCount()!=0)
    {
        if(chkpcode(txtfPcode.getText()))
        {
        
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลรายการทั้งหมดหรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
            if (confirm == JOptionPane.YES_OPTION) {
            try {
            if(!db.Char_Set.equalsIgnoreCase("utf-8"))
            {
               stmt = (Statement) db.con.createStatement();
               String sql = "delete from effective where pcode = ?";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
               prm.setString(1, cvth.Unicode2ASCII(txtfPcode.getText()));
               
               
               prm.executeUpdate();
            }
            else
            {
               stmt = (Statement) db.con.createStatement();
               String sql = "delete from effective where pcode = ?";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql);
               prm.setString(1, txtfPcode.getText());
               
               
               prm.executeUpdate();
                   
            }
               stmt.close();
               clear2();
               indexplutbl = -1;
               
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e.getMessage(), "Delete Error", JOptionPane.ERROR_MESSAGE);
            }
                }
            else{indexplutbl = -1;}
        }
        }
        
        Procress();
    }
private void initable() {
        tbPLU = (DefaultTableModel) tbl.getModel();
        tbl.setShowGrid(true);
        //tblPLU.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tbl.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tbl.setRowSelectionAllowed(true);
        tbl.setBackground(java.awt.Color.WHITE);
        tbl.setGridColor(java.awt.Color.gray);
        JTableHeader header = tbl.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.BOLD, 14));
        //tblBtype.setFont(new java.awt.Font("Norasi", java.awt.Font.BOLD, 14));
        tbl.setRowHeight(25);
        TableTestFormatRenderer t;
        t = new TableTestFormatRenderer(DoubleFmt);
        t.setHorizontalAlignment(SwingConstants.RIGHT);
        
        
        DefaultTableCellRenderer r;
        r = new DefaultTableCellRenderer();
        r.setHorizontalAlignment(SwingConstants.RIGHT);
        DefaultTableCellRenderer c;
        c = new DefaultTableCellRenderer();
        c.setHorizontalAlignment(SwingConstants.CENTER);
        DefaultTableCellRenderer l;
        l = new DefaultTableCellRenderer();
        l.setHorizontalAlignment(SwingConstants.LEFT);

        TableColumnModel tcm = tbl.getColumnModel();
        tcm.getColumn(0).setCellRenderer(l);
        tcm.getColumn(1).setCellRenderer(l);
        tcm.getColumn(2).setCellRenderer(l);
        tcm.getColumn(3).setCellRenderer(r);
        tcm.getColumn(4).setCellRenderer(r);
        tcm.getColumn(5).setCellRenderer(r);
        tcm.getColumn(6).setCellRenderer(r);
        tcm.getColumn(7).setCellRenderer(r);
        tcm.getColumn(8).setCellRenderer(l);
        tcm.getColumn(9).setCellRenderer(l);
        tcm.getColumn(10).setCellRenderer(l);
        tcm.getColumn(11).setCellRenderer(l);
        
    }
private void setCount()
{
   db_lblCount.setText(tbl.getRowCount()+"");
}

    private void LinkAll() {
        
        try {
        if(chkpcodeinblink(txtfPcode.getText()))
        {
            ResultSet rs = null;
    
        if(!db.Char_Set.equalsIgnoreCase("utf-8"))
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from blink where pcode ='"+cvth.Unicode2ASCII(txtfPcode.getText())+"'";
        rs = stmt.executeQuery(sql);
        setDate();
        while(rs.next())
        {
            if(chkeff(txtfPcode.getText(), rs.getString("bgroup"), date3))
            {
               String sql2 = "Update effective set price1=?,price2 = ?,price3 = ?,price4 = ?,price5 = ?,promotion1 = ?,promotion2 = ?,promotion3 = ? where eff_date =? and pcode = ? and bgroup = ?";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql2);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, cvth.Unicode2ASCII(txtfPro1.getText()));
               prm.setString(7, cvth.Unicode2ASCII(txtfPro2.getText()));
               prm.setString(8, cvth.Unicode2ASCII(txtfPro3.getText()));
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, cvth.Unicode2ASCII(txtfPcode.getText()));
               prm.setString(11, rs.getString("bgroup").toUpperCase());
               prm.executeUpdate();
            }
            else
            {
               String sql2 = "Insert into effective (price1,price2 ,price3 ,price4 ,price5 ,promotion1 ,promotion2 ,promotion3 , eff_date, pcode ,bgroup ) values(?,?,?,?,?,?,?,?,?,?,?)";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql2);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, cvth.Unicode2ASCII(txtfPro1.getText()));
               prm.setString(7, cvth.Unicode2ASCII(txtfPro2.getText()));
               prm.setString(8, cvth.Unicode2ASCII(txtfPro3.getText()));
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, cvth.Unicode2ASCII(txtfPcode.getText()));
               prm.setString(11, rs.getString("bgroup").toUpperCase());
               
               prm.executeUpdate();
            }
        }
      
        }
        else
        {
        stmt = (Statement) db.con.createStatement();
        String sql = "select * from blink where pcode ='"+txtfPcode.getText()+"'";
        rs = stmt.executeQuery(sql);
        setDate();
        while(rs.next())
        {
            if(chkeff(txtfPcode.getText(), rs.getString("bgroup"), date3))
            {
               String sql2 = "Update effective set price1=?,price2 = ?,price3 = ?,price4 = ?,price5 = ?,promotion1 = ?,promotion2 = ?,promotion3 = ? where eff_date =? and pcode = ? and bgroup = ?";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql2);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, txtfPro1.getText());
               prm.setString(7, txtfPro2.getText());
               prm.setString(8, txtfPro3.getText());
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, txtfPcode.getText());
               prm.setString(11, rs.getString("bgroup").toUpperCase());
               prm.executeUpdate();
            }
            else
            {
               String sql2 = "Insert into effective (price1,price2 ,price3 ,price4 ,price5 ,promotion1 ,promotion2 ,promotion3 , eff_date, pcode ,bgroup ) values(?,?,?,?,?,?,?,?,?,?,?)";
               PreparedStatement prm = (PreparedStatement) db.con.prepareStatement(sql2);
               prm.setDouble(1, Double.parseDouble(PUtility.ConvertReal(txtfmEatIn.getText())));
               prm.setDouble(2, Double.parseDouble(PUtility.ConvertReal(txtfmTakeAway.getText())));
               prm.setDouble(3, Double.parseDouble(PUtility.ConvertReal(txtfmDelivery.getText())));
               prm.setDouble(4, Double.parseDouble(PUtility.ConvertReal(txtfmPinto.getText())));
               prm.setDouble(5, Double.parseDouble(PUtility.ConvertReal(txtfmWhole.getText())));
               prm.setString(6, txtfPro1.getText());
               prm.setString(7, txtfPro2.getText());
               prm.setString(8, txtfPro3.getText());
               prm.setString(9, Format.dateFmtSql.format(Format.dateFmtShow.parse(t_date3.getText())));
               prm.setString(10, txtfPcode.getText());
               prm.setString(11, rs.getString("bgroup").toUpperCase());
               
               prm.executeUpdate();
            }
        }
        
        }
        Procress();
    } 
            
        }
        
        catch (Exception e) {
        
    }
    }
    private Font fontbold = new Font("Norasi", Font.BOLD, 14);
    private Font fontplain = new Font("Norasi", Font.PLAIN, 14);
    
    private void inittbl2()
    {
        try {
            
            TableColumnModel tcm = new DefaultTableColumnModel();
            
            TableColumn tc1 = new TableColumn(0,300);
            tc1.setHeaderValue("Group");
            TableColumn tc2 = new TableColumn(1,100);
            tc2.setHeaderValue("Group Name");
            TableColumn tc3 = new TableColumn(2,250);
            tc3.setHeaderValue("Effictive");
            TableColumn tc4 = new TableColumn(3,100);
            tc4.setHeaderValue("Eat In");
            TableColumn tc5 = new TableColumn(4,120);
            tc5.setHeaderValue("Take Away");
            TableColumn tc6 = new TableColumn(5,150);
            tc6.setHeaderValue("Delivery");
            TableColumn tc7 = new TableColumn(5,150);
            tc7.setHeaderValue("Pinto");
            TableColumn tc8 = new TableColumn(5,150);
            tc8.setHeaderValue("Whole Sale");
            TableColumn tc9 = new TableColumn(5,150);
            tc9.setHeaderValue("โปรโมชั่น1");
            TableColumn tc10 = new TableColumn(5,150);
            tc10.setHeaderValue("โปรโมชั่น2");
            TableColumn tc11 = new TableColumn(5,150);
            tc11.setHeaderValue("โปรโมชั่น3");
            TableColumn tc12 = new TableColumn(5,150);
            tc12.setHeaderValue("Flage");
            
            
            
            tcm.addColumn(tc1);
            tcm.addColumn(tc2);
            tcm.addColumn(tc3);
            tcm.addColumn(tc4);
            tcm.addColumn(tc5);
            tcm.addColumn(tc6);
            tcm.addColumn(tc7);
            tcm.addColumn(tc8);
            tcm.addColumn(tc9);
            tcm.addColumn(tc10);
            tcm.addColumn(tc11);
            tcm.addColumn(tc12);
            
//            tcm.addColumn(tc31);
            
        DefaultTableCellRenderer r;
        r = new DefaultTableCellRenderer();
        r.setHorizontalAlignment(SwingConstants.RIGHT);
//        r.setBackground(new Color(190,253,207));
        DefaultTableCellRenderer c;
        c = new DefaultTableCellRenderer();
        c.setHorizontalAlignment(SwingConstants.CENTER);
        DefaultTableCellRenderer l;
        l = new DefaultTableCellRenderer();
        l.setHorizontalAlignment(SwingConstants.LEFT);
        
        DefaultTableCellRenderer color1;
        color1 = new DefaultTableCellRenderer();
        color1.setHorizontalAlignment(SwingConstants.RIGHT);
        color1.setBackground(new Color(190,253,207));
        
        DefaultTableCellRenderer color2;
        color2 = new DefaultTableCellRenderer();
        color2.setHorizontalAlignment(SwingConstants.RIGHT);
        color2.setBackground(new Color(255,253,207));
        
        tcm.getColumn(0).setCellRenderer(l);
        tcm.getColumn(1).setCellRenderer(l);
        tcm.getColumn(2).setCellRenderer(l);
        tcm.getColumn(3).setCellRenderer(r);
        tcm.getColumn(4).setCellRenderer(r);
        tcm.getColumn(5).setCellRenderer(r);
        tcm.getColumn(6).setCellRenderer(r);
        tcm.getColumn(7).setCellRenderer(r);
        tcm.getColumn(8).setCellRenderer(l);
        tcm.getColumn(9).setCellRenderer(l);
        tcm.getColumn(10).setCellRenderer(l);
        tcm.getColumn(11).setCellRenderer(l);
        
//        tcm.getColumn(30).setCellRenderer(r);
        
        
        
        tbl2.setEditable(false);//ห้ามแก้ไขตาราง
        tbl2.setShowGrid(true);
        tbl2.setFont(fontplain);
        tbl2.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tbl2.setRowSelectionAllowed(true);
        tbl2.setBackground(java.awt.Color.WHITE);
        tbl2.setGridColor(java.awt.Color.gray);
        tbl2.setRowHeight(24);
        
            tbl2.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
            
            
            tbl2.setColumnModel(tcm);
            tbl2.setRootVisible(true);
            
            JTableHeader h = tbl2.getTableHeader();
            h.setFont(fontbold);
            h.setReorderingAllowed(false);
            tbl2.setLeafIcon(null);
        }  catch (Exception ex) {
            
        }
    
    }
    private void settbl2()
{
    try {
            
            TableColumnModel tcm = new DefaultTableColumnModel();
            
            TableColumn tc1 = new TableColumn(0,265);
            tc1.setHeaderValue("Group");
            TableColumn tc2 = new TableColumn(1,80);
            tc2.setHeaderValue("PCode");
            TableColumn tc3 = new TableColumn(2,150);
            tc3.setHeaderValue("PName");
            TableColumn tc4 = new TableColumn(3,50);
            tc4.setHeaderValue("Eat In");
            TableColumn tc5 = new TableColumn(4,50);
            tc5.setHeaderValue("Take Away");
            TableColumn tc6 = new TableColumn(5,50);
            tc6.setHeaderValue("Delivery");
            TableColumn tc7 = new TableColumn(6,50);
            tc7.setHeaderValue("Pinto");
            TableColumn tc8 = new TableColumn(7,50);
            tc8.setHeaderValue("Whole Sale");
            TableColumn tc9 = new TableColumn(8,50);
            tc9.setHeaderValue("โปรโมชั่น1");
            TableColumn tc10 = new TableColumn(9,50);
            tc10.setHeaderValue("โปรโมชั่น2");
            TableColumn tc11 = new TableColumn(10,50);
            tc11.setHeaderValue("โปรโมชั่น3");
            TableColumn tc12 = new TableColumn(11,50);
            tc12.setHeaderValue("Flage");
            
            
            
            tcm.addColumn(tc1);
            tcm.addColumn(tc2);
            tcm.addColumn(tc3);
            tcm.addColumn(tc4);
            tcm.addColumn(tc5);
            tcm.addColumn(tc6);
            tcm.addColumn(tc7);
            tcm.addColumn(tc8);
            tcm.addColumn(tc9);
            tcm.addColumn(tc10);
            tcm.addColumn(tc11);
            tcm.addColumn(tc12);
            
//            tcm.addColumn(tc31);
            
        DefaultTableCellRenderer r;
        r = new DefaultTableCellRenderer();
        r.setHorizontalAlignment(SwingConstants.RIGHT);
//        r.setBackground(new Color(190,253,207));
        DefaultTableCellRenderer c;
        c = new DefaultTableCellRenderer();
        c.setHorizontalAlignment(SwingConstants.CENTER);
        DefaultTableCellRenderer l;
        l = new DefaultTableCellRenderer();
        l.setHorizontalAlignment(SwingConstants.LEFT);
        
        DefaultTableCellRenderer color1;
        color1 = new DefaultTableCellRenderer();
        color1.setHorizontalAlignment(SwingConstants.RIGHT);
        color1.setBackground(new Color(190,253,207));
        
        DefaultTableCellRenderer color2;
        color2 = new DefaultTableCellRenderer();
        color2.setHorizontalAlignment(SwingConstants.RIGHT);
        color2.setBackground(new Color(255,253,207));
        
        tcm.getColumn(0).setCellRenderer(l);
        tcm.getColumn(1).setCellRenderer(l);
        tcm.getColumn(2).setCellRenderer(l);
        tcm.getColumn(3).setCellRenderer(r);
        tcm.getColumn(4).setCellRenderer(r);
        tcm.getColumn(5).setCellRenderer(r);
        tcm.getColumn(6).setCellRenderer(r);
        tcm.getColumn(7).setCellRenderer(r);
        tcm.getColumn(8).setCellRenderer(l);
        tcm.getColumn(9).setCellRenderer(l);
        tcm.getColumn(10).setCellRenderer(l);
        tcm.getColumn(11).setCellRenderer(l);
        
//        tcm.getColumn(30).setCellRenderer(r);
        
        
        
        tbl2.setEditable(false);//ห้ามแก้ไขตาราง
        tbl2.setShowGrid(true);
        tbl2.setFont(fontplain);
        tbl2.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tbl2.setRowSelectionAllowed(true);
        tbl2.setBackground(java.awt.Color.WHITE);
        tbl2.setGridColor(java.awt.Color.gray);
        tbl2.setRowHeight(24);
        
            tbl2.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
            String d1 = "";
            String d2 = "";
           
            setDate();
            String sql="";
            if(dbutility.dbUtility.Char_Set.equalsIgnoreCase("utf-8"))
            {   
            sql = "SELECT bgroup as bcode,bgroupname as bname,pdesc,e.* FROM effective e left join branchgroup b "
                            + "on e.bgroup = b.bgroupcode "
                            + "left join product p on e.pcode = p.pcode "
                            + "where eff_date>= '"+date1+"' and eff_date<='"+date2+"' "
                            + "order by eff_date,bgroup,e.pcode";
            }
            else
            {
                    sql = "SELECT bgroup as bcode,bgroupname as bname,pdesc,e.* FROM effective e left join branchgroup b "
                            + "on e.bgroup = b.bgroupcode "
                            + "left join product p on e.pcode = p.pcode "
                            + "where eff_date>= '"+date1+"' and eff_date<='"+date2+"' "
                            + "order by eff_date,bgroup,e.pcode";
            }
            reportEffectiveModel treemodel = new reportEffectiveModel(sql);
            tbl2.setTreeTableModel(treemodel);
            tbl2.setColumnModel(tcm);
            tbl2.setRootVisible(true);
            ((JXTree)tbl2.getCellRenderer(0,tbl2.getHierarchicalColumn())).setFont(fontplain);
            
            JTableHeader h = tbl2.getTableHeader();
            h.setFont(fontbold);
            h.setReorderingAllowed(false);
            tbl2.setLeafIcon(null);
        }  catch (Exception ex) {
            
        }
}

    private void Procress() {
        settbl2();
        showdataintb(txtfPcode.getText());
    }
    
}
