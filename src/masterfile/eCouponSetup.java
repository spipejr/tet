/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * SpacialCouponSetup.java
 *
 * Created on Sep 17, 2012, 3:08:14 PM
 */
package masterfile;

import Entity.BranchCodeName;
import dbutility.dbUtility;
import frmlist.*;
import java.awt.Point;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.IOException;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.ListSelectionModel;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumnModel;
import jxl.write.WriteException;
import utilities.DateChooser.DateUtil;
import utilititiesfunction.*;

/**
 *
 * @author natee
 */
public class eCouponSetup extends javax.swing.JDialog {

    DefaultTableModel model;
    DefaultTableModel model2;
    DefaultTableModel model3;
    DefaultTableModel model4;
    DefaultTableModel model5;
    JTableHeader modelh1;
    JTableHeader modelh2;
    JTableHeader modelh5;
    dbUtility db = new dbUtility();
    private Statement stmt;
    ThaiUtilities cvth = new ThaiUtilities();
    String formname = "spacialcouponsetup";
    String SelectedCampain = "";
    String FixBranchError = "";
    String PluListError = "";
    boolean bsaveOK = false;

    /**
     * Creates new form SpacialCouponSetup
     */
    public eCouponSetup(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        checkuserconfig();
        db.dbconnect();
        try {
            stmt = (Statement) dbUtility.con.createStatement();
        } catch (Exception e) {
        }
        tblCupon.setAutoCreateRowSorter(true);
        tblfixbranch.setAutoCreateRowSorter(true);
        loadcampainlist();
        showdataintb();
        clearForm();
        t_code.requestFocus();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        buttonGroup3 = new javax.swing.ButtonGroup();
        buttonGroup4 = new javax.swing.ButtonGroup();
        plu = new javax.swing.JPopupMenu();
        jMenuItem7 = new javax.swing.JMenuItem();
        jMenuItem6 = new javax.swing.JMenuItem();
        branch = new javax.swing.JPopupMenu();
        jMenuItem8 = new javax.swing.JMenuItem();
        jMenuItem9 = new javax.swing.JMenuItem();
        fixbranch = new javax.swing.JPopupMenu();
        jMenuItem10 = new javax.swing.JMenuItem();
        jMenuItem11 = new javax.swing.JMenuItem();
        buttonGroup5 = new javax.swing.ButtonGroup();
        buttonGroup6 = new javax.swing.ButtonGroup();
        buttonGroup7 = new javax.swing.ButtonGroup();
        plu1 = new javax.swing.JPopupMenu();
        jMenuItem12 = new javax.swing.JMenuItem();
        jMenuItem13 = new javax.swing.JMenuItem();
        jPanel1 = new javax.swing.JPanel();
        btnNew = new javax.swing.JButton();
        btnCancel = new javax.swing.JButton();
        btnSave = new javax.swing.JButton();
        btnDelete = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jButton7 = new javax.swing.JButton();
        tab = new javax.swing.JTabbedPane();
        jPanel2 = new javax.swing.JPanel();
        jPanel22 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        strDay = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        c1 = new javax.swing.JCheckBox();
        c2 = new javax.swing.JCheckBox();
        c3 = new javax.swing.JCheckBox();
        c4 = new javax.swing.JCheckBox();
        c5 = new javax.swing.JCheckBox();
        c6 = new javax.swing.JCheckBox();
        c7 = new javax.swing.JCheckBox();
        strtype = new javax.swing.JTextField();
        jPanel12 = new javax.swing.JPanel();
        te1 = new javax.swing.JCheckBox();
        tt1 = new javax.swing.JCheckBox();
        tw1 = new javax.swing.JCheckBox();
        tp1 = new javax.swing.JCheckBox();
        td1 = new javax.swing.JCheckBox();
        jLabel11 = new javax.swing.JLabel();
        jPanel13 = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        t_buymin = new javax.swing.JFormattedTextField();
        jLabel14 = new javax.swing.JLabel();
        t_cutime = new javax.swing.JFormattedTextField();
        t_cutime2 = new javax.swing.JFormattedTextField();
        jPanel11 = new javax.swing.JPanel();
        jLabel10 = new javax.swing.JLabel();
        t_discountbath = new javax.swing.JFormattedTextField();
        jLabel4 = new javax.swing.JLabel();
        t_date1 = new javax.swing.JFormattedTextField();
        btn_Calendar = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();
        t_date2 = new javax.swing.JFormattedTextField();
        btn_Calendar1 = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        t_code = new javax.swing.JTextField();
        t_name = new javax.swing.JTextField();
        t_barcode = new javax.swing.JTextField();
        jLabel27 = new javax.swing.JLabel();
        btnfindcampaign = new javax.swing.JButton();
        campaign_code = new javax.swing.JTextField();
        campaign_name = new javax.swing.JTextField();
        jPanel23 = new javax.swing.JPanel();
        rdymulti = new javax.swing.JRadioButton();
        rdnmulti = new javax.swing.JRadioButton();
        jLabel15 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        t_cnt = new javax.swing.JFormattedTextField();
        formember = new javax.swing.JCheckBox();
        paneltable = new javax.swing.JPanel();
        jPanel17 = new javax.swing.JPanel();
        jLayeredPane1 = new javax.swing.JLayeredPane();
        rdactive1 = new javax.swing.JRadioButton();
        rdactive2 = new javax.swing.JRadioButton();
        jLabel29 = new javax.swing.JLabel();
        campaignlist = new javax.swing.JComboBox();
        jPanel19 = new javax.swing.JPanel();
        t_count1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblCupon = new javax.swing.JTable();
        lbcampaign = new javax.swing.JLabel();
        paneltab2 = new javax.swing.JPanel();
        jPanel18 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblbranch = new javax.swing.JTable();
        btnok5 = new javax.swing.JButton();
        jPanel15 = new javax.swing.JPanel();
        t_bcode = new javax.swing.JTextField();
        btn_group = new javax.swing.JButton();
        t_bname = new javax.swing.JTextField();
        btnbranchcancle = new javax.swing.JButton();
        btnbranchok = new javax.swing.JButton();
        jPanel20 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tblfixbranch = new javax.swing.JTable();
        jPanel21 = new javax.swing.JPanel();
        btnbranchok1 = new javax.swing.JButton();
        t_fixbranch = new javax.swing.JTextField();
        btn_group2 = new javax.swing.JButton();
        t_fixname = new javax.swing.JTextField();
        btnbranchcancle1 = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        t_code2 = new javax.swing.JTextField();
        jPanel7 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        Head1 = new javax.swing.JTextField();
        Head2 = new javax.swing.JTextField();
        jLabel7 = new javax.swing.JLabel();
        jLabel8 = new javax.swing.JLabel();
        Head3 = new javax.swing.JTextField();
        Head4 = new javax.swing.JTextField();
        jLabel9 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        Head5 = new javax.swing.JTextField();
        Head6 = new javax.swing.JTextField();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jScrollPane5 = new javax.swing.JScrollPane();
        jPanel9 = new javax.swing.JPanel();
        Con1 = new javax.swing.JTextField();
        Con2 = new javax.swing.JTextField();
        Con3 = new javax.swing.JTextField();
        Con4 = new javax.swing.JTextField();
        Con5 = new javax.swing.JTextField();
        Con6 = new javax.swing.JTextField();
        Con7 = new javax.swing.JTextField();
        Con8 = new javax.swing.JTextField();
        Con9 = new javax.swing.JTextField();
        Con10 = new javax.swing.JTextField();
        Con11 = new javax.swing.JTextField();
        Con12 = new javax.swing.JTextField();
        Con13 = new javax.swing.JTextField();
        Con14 = new javax.swing.JTextField();
        Con15 = new javax.swing.JTextField();
        Con16 = new javax.swing.JTextField();
        Con17 = new javax.swing.JTextField();
        Con18 = new javax.swing.JTextField();
        Con19 = new javax.swing.JTextField();
        Con20 = new javax.swing.JTextField();
        Con21 = new javax.swing.JTextField();
        Con22 = new javax.swing.JTextField();
        Con23 = new javax.swing.JTextField();
        Con24 = new javax.swing.JTextField();
        Con25 = new javax.swing.JTextField();
        Con26 = new javax.swing.JTextField();
        Con27 = new javax.swing.JTextField();
        Con28 = new javax.swing.JTextField();
        Con29 = new javax.swing.JTextField();
        Con30 = new javax.swing.JTextField();
        Con31 = new javax.swing.JTextField();
        Con32 = new javax.swing.JTextField();
        Con33 = new javax.swing.JTextField();
        Con34 = new javax.swing.JTextField();
        Con35 = new javax.swing.JTextField();
        jPanel10 = new javax.swing.JPanel();
        jPanel14 = new javax.swing.JPanel();
        jPanel16 = new javax.swing.JPanel();
        btn_plu = new javax.swing.JButton();
        t_plu = new javax.swing.JTextField();
        btnpluok = new javax.swing.JButton();
        t_pluname = new javax.swing.JTextField();
        btnbranchcancle2 = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblplu = new javax.swing.JTable();
        jLabel13 = new javax.swing.JLabel();
        t_gcode = new javax.swing.JTextField();
        btngroupok = new javax.swing.JButton();
        btn_group3 = new javax.swing.JButton();
        jPanel24 = new javax.swing.JPanel();
        jPanel25 = new javax.swing.JPanel();
        btn_plu1 = new javax.swing.JButton();
        t_plu1 = new javax.swing.JTextField();
        btnpluok1 = new javax.swing.JButton();
        t_pluname1 = new javax.swing.JTextField();
        btnbranchcancle3 = new javax.swing.JButton();
        jScrollPane6 = new javax.swing.JScrollPane();
        tblplu1 = new javax.swing.JTable();
        jLabel20 = new javax.swing.JLabel();
        t_gcode1 = new javax.swing.JTextField();
        btngroupok1 = new javax.swing.JButton();
        btn_group4 = new javax.swing.JButton();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        menuNew = new javax.swing.JMenuItem();
        menuCancel = new javax.swing.JMenuItem();
        menuSave = new javax.swing.JMenuItem();
        menuDelete = new javax.swing.JMenuItem();
        jSeparator1 = new javax.swing.JPopupMenu.Separator();
        menuExit = new javax.swing.JMenuItem();

        plu.setName("popup"); // NOI18N

        jMenuItem7.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem7.setText("ลบรายการที่เลือก");
        jMenuItem7.setName("popup1"); // NOI18N
        jMenuItem7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem7ActionPerformed(evt);
            }
        });
        plu.add(jMenuItem7);

        jMenuItem6.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem6.setText("ลบทุกรายการ");
        jMenuItem6.setName("popup2"); // NOI18N
        jMenuItem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem6ActionPerformed(evt);
            }
        });
        plu.add(jMenuItem6);

        branch.setName("popup"); // NOI18N

        jMenuItem8.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem8.setText("ลบรายการที่เลือก");
        jMenuItem8.setName("popup1"); // NOI18N
        jMenuItem8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem8ActionPerformed(evt);
            }
        });
        branch.add(jMenuItem8);

        jMenuItem9.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem9.setText("ลบทุกรายการ");
        jMenuItem9.setName("popup2"); // NOI18N
        jMenuItem9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem9ActionPerformed(evt);
            }
        });
        branch.add(jMenuItem9);

        fixbranch.setName("popup"); // NOI18N

        jMenuItem10.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem10.setText("ลบรายการที่เลือก");
        jMenuItem10.setName("popup1"); // NOI18N
        jMenuItem10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem10ActionPerformed(evt);
            }
        });
        fixbranch.add(jMenuItem10);

        jMenuItem11.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem11.setText("ลบทุกรายการ");
        jMenuItem11.setName("popup2"); // NOI18N
        jMenuItem11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem11ActionPerformed(evt);
            }
        });
        fixbranch.add(jMenuItem11);

        plu1.setName("popup"); // NOI18N

        jMenuItem12.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem12.setText("ลบรายการที่เลือก");
        jMenuItem12.setName("popup1"); // NOI18N
        jMenuItem12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem12ActionPerformed(evt);
            }
        });
        plu1.add(jMenuItem12);

        jMenuItem13.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem13.setText("ลบทุกรายการ");
        jMenuItem13.setName("popup2"); // NOI18N
        jMenuItem13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem13ActionPerformed(evt);
            }
        });
        plu1.add(jMenuItem13);

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btnNew.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnNew.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Add-icon.png"))); // NOI18N
        btnNew.setText("เพิ่มรายการ");
        btnNew.setFocusable(false);
        btnNew.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnNew.setName("DBbtnadd"); // NOI18N
        btnNew.setRequestFocusEnabled(false);
        btnNew.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnNew.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNewActionPerformed(evt);
            }
        });

        btnCancel.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnCancel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Cancel-icon.png"))); // NOI18N
        btnCancel.setText("ยกเลิก");
        btnCancel.setFocusable(false);
        btnCancel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnCancel.setName("DBbtncancle"); // NOI18N
        btnCancel.setRequestFocusEnabled(false);
        btnCancel.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCancelActionPerformed(evt);
            }
        });

        btnSave.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/save-icon.png"))); // NOI18N
        btnSave.setText("บันทึกข้อมูล");
        btnSave.setFocusable(false);
        btnSave.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnSave.setName("DBbtnsave"); // NOI18N
        btnSave.setRequestFocusEnabled(false);
        btnSave.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSaveActionPerformed(evt);
            }
        });

        btnDelete.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Delete-icons.png"))); // NOI18N
        btnDelete.setText("ลบข้อมูล");
        btnDelete.setFocusable(false);
        btnDelete.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnDelete.setName("DBbtndel"); // NOI18N
        btnDelete.setRequestFocusEnabled(false);
        btnDelete.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDeleteActionPerformed(evt);
            }
        });

        jButton6.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jButton6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Printer-icon.png"))); // NOI18N
        jButton6.setText("พิมพ์");
        jButton6.setFocusable(false);
        jButton6.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jButton6.setName("DBbtnprint"); // NOI18N
        jButton6.setRequestFocusEnabled(false);
        jButton6.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);

        jButton7.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jButton7.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/LogOut-icon.png"))); // NOI18N
        jButton7.setText("ออก");
        jButton7.setFocusable(false);
        jButton7.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jButton7.setName("DBbtnexit"); // NOI18N
        jButton7.setRequestFocusEnabled(false);
        jButton7.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jButton7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton7ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(btnNew, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(btnSave, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(jButton7, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnNew, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSave, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton7, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        tab.setFocusable(false);
        tab.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tab.setPreferredSize(new java.awt.Dimension(1024, 697));
        tab.setRequestFocusEnabled(false);
        tab.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tabMousePressed(evt);
            }
        });

        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel22.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 115, Short.MAX_VALUE)
        );

        jPanel4.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel6.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel6.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel6.setText("ใช้ได้เฉพาะวัน (Day)"); // NOI18N
        jLabel6.setName("DBstrday"); // NOI18N

        strDay.setEditable(false);
        strDay.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        jPanel5.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        c1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c1.setText("วันอาทิตย์");
        c1.setEnabled(false);
        c1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c1ActionPerformed(evt);
            }
        });

        c2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c2.setText("วันจันทร์");
        c2.setEnabled(false);
        c2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c2ActionPerformed(evt);
            }
        });

        c3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c3.setText("วันอังคาร");
        c3.setEnabled(false);
        c3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c3ActionPerformed(evt);
            }
        });

        c4.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c4.setText("วันพุธ");
        c4.setEnabled(false);
        c4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c4ActionPerformed(evt);
            }
        });

        c5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c5.setText("วันพฤหัสฯ");
        c5.setEnabled(false);
        c5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c5ActionPerformed(evt);
            }
        });

        c6.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c6.setText("วันศุกร์");
        c6.setEnabled(false);
        c6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c6ActionPerformed(evt);
            }
        });

        c7.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c7.setText("วันเสาร์");
        c7.setEnabled(false);
        c7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c7ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(c1)
                .addGap(0, 0, 0)
                .addComponent(c2)
                .addGap(0, 0, 0)
                .addComponent(c3)
                .addGap(0, 0, 0)
                .addComponent(c4)
                .addGap(0, 0, 0)
                .addComponent(c5)
                .addGap(0, 0, 0)
                .addComponent(c6)
                .addGap(0, 0, 0)
                .addComponent(c7)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(c1)
                    .addComponent(c2)
                    .addComponent(c3)
                    .addComponent(c4)
                    .addComponent(c5)
                    .addComponent(c6)
                    .addComponent(c7))
                .addContainerGap())
        );

        strtype.setEditable(false);

        jPanel12.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        te1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        te1.setText("Eat-In");
        te1.setEnabled(false);
        te1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                te1ActionPerformed(evt);
            }
        });

        tt1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tt1.setText("Take Away");
        tt1.setEnabled(false);
        tt1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tt1ActionPerformed(evt);
            }
        });

        tw1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tw1.setText("Whole Sale");
        tw1.setEnabled(false);
        tw1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tw1ActionPerformed(evt);
            }
        });

        tp1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tp1.setText("Pinto");
        tp1.setEnabled(false);
        tp1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tp1ActionPerformed(evt);
            }
        });

        td1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        td1.setText("Delivery");
        td1.setEnabled(false);
        td1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                td1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(te1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tt1)
                .addGap(6, 6, 6)
                .addComponent(td1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(tp1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tw1)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(te1)
                .addComponent(tt1)
                .addComponent(td1)
                .addComponent(tp1)
                .addComponent(tw1))
        );

        jLabel11.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel11.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel11.setText("Sale Type"); // NOI18N
        jLabel11.setName("DBsaletype"); // NOI18N

        jPanel13.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel12.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel12.setText("ยอดซื้อขั้นต่ำ");
        jLabel12.setName("D_min"); // NOI18N

        t_buymin.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        t_buymin.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_buymin.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_buymin.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_buyminFocusGained(evt);
            }
        });
        t_buymin.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_buyminKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGap(6, 6, 6)
                .addComponent(jLabel12)
                .addGap(18, 18, 18)
                .addComponent(t_buymin, javax.swing.GroupLayout.DEFAULT_SIZE, 97, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(t_buymin, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jLabel14.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel14.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel14.setText("เวลา"); // NOI18N
        jLabel14.setName("DBsaletype"); // NOI18N

        t_cutime.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("HH:mm"))));
        t_cutime.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        t_cutime.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_cutime.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_cutimeFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_cutimeFocusLost(evt);
            }
        });

        t_cutime2.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("HH:mm"))));
        t_cutime2.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        t_cutime2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_cutime2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_cutime2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_cutime2FocusLost(evt);
            }
        });

        jPanel11.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel10.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel10.setText("มูลค่า e-Coupon");
        jLabel10.setName("D_disbath"); // NOI18N

        t_discountbath.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        t_discountbath.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_discountbath.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_discountbath.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_discountbathFocusGained(evt);
            }
        });
        t_discountbath.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_discountbathKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel10)
                .addGap(31, 31, 31)
                .addComponent(t_discountbath, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel10)
                .addComponent(t_discountbath, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 137, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(34, 34, 34)
                                .addComponent(strDay, javax.swing.GroupLayout.PREFERRED_SIZE, 314, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 155, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(strtype, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(jLabel14)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(t_cutime, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(t_cutime2, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(strDay, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(strtype, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel14)
                    .addComponent(t_cutime, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_cutime2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jLabel4.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel4.setText("ช่วงวันที่สามารถให้ส่วนลดได้");
        jLabel4.setName("D_datesale"); // NOI18N

        t_date1.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                t_date1ActionPerformed(evt);
            }
        });
        t_date1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date1KeyPressed(evt);
            }
        });

        btn_Calendar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CalendarActionPerformed(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel5.setText("ถึง");
        jLabel5.setName("D_to"); // NOI18N

        t_date2.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date2KeyPressed(evt);
            }
        });

        btn_Calendar1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_Calendar1ActionPerformed(evt);
            }
        });

        jLabel1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("รหัส e-Coupon");
        jLabel1.setName("D_code"); // NOI18N

        jLabel2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("ชื่อ e-Coupon");
        jLabel2.setName("D_name"); // NOI18N

        jLabel3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("Barcode");
        jLabel3.setName("D_barcode"); // NOI18N

        t_code.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        t_code.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_codeKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_codeKeyTyped(evt);
            }
        });

        t_name.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_name.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_nameKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_nameKeyTyped(evt);
            }
        });

        t_barcode.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        t_barcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_barcodeKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_barcodeKeyTyped(evt);
            }
        });

        jLabel27.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel27.setText("เคมเปญ");

        btnfindcampaign.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnfindcampaign.setFocusable(false);
        btnfindcampaign.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnfindcampaignActionPerformed(evt);
            }
        });
        btnfindcampaign.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnfindcampaignKeyPressed(evt);
            }
        });

        campaign_code.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        campaign_code.setText("jTextField1");
        campaign_code.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                campaign_codeFocusLost(evt);
            }
        });
        campaign_code.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                campaign_codeKeyPressed(evt);
            }
        });

        campaign_name.setBackground(new java.awt.Color(245, 245, 172));
        campaign_name.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        campaign_name.setText("jTextField2");
        campaign_name.setFocusable(false);

        jPanel23.setBorder(javax.swing.BorderFactory.createTitledBorder("Condition For Type B (Discount Bath)"));

        buttonGroup6.add(rdymulti);
        rdymulti.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdymulti.setText("ให้แบบทวีคูณ");

        buttonGroup6.add(rdnmulti);
        rdnmulti.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdnmulti.setText("ให้ได้ครั้งเดียว");

        jLabel15.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel15.setText("จำนวนคูปองที่สามารถใช้ได้");

        jLabel19.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel19.setText("ใบ");

        t_cnt.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        t_cnt.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        t_cnt.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_cnt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_cntKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel23Layout = new javax.swing.GroupLayout(jPanel23);
        jPanel23.setLayout(jPanel23Layout);
        jPanel23Layout.setHorizontalGroup(
            jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel23Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel23Layout.createSequentialGroup()
                        .addComponent(rdymulti)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(rdnmulti)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel15))
                    .addGroup(jPanel23Layout.createSequentialGroup()
                        .addGap(369, 369, 369)
                        .addComponent(t_cnt, javax.swing.GroupLayout.PREFERRED_SIZE, 53, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel19)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel23Layout.setVerticalGroup(
            jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel23Layout.createSequentialGroup()
                .addGroup(jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rdymulti)
                    .addComponent(rdnmulti)
                    .addComponent(jLabel15))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel19)
                    .addComponent(t_cnt, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        formember.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        formember.setText("ใช้สำหรับฝ่ายประชาสัมพันธ์เท่านั้น");

        javax.swing.GroupLayout jPanel22Layout = new javax.swing.GroupLayout(jPanel22);
        jPanel22.setLayout(jPanel22Layout);
        jPanel22Layout.setHorizontalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel22Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel22Layout.createSequentialGroup()
                        .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel22Layout.createSequentialGroup()
                                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                    .addComponent(jLabel2, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                    .addComponent(jLabel3, javax.swing.GroupLayout.PREFERRED_SIZE, 94, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(t_name)
                                    .addGroup(jPanel22Layout.createSequentialGroup()
                                        .addComponent(t_code, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(jLabel27)
                                        .addGap(2, 2, 2)
                                        .addComponent(btnfindcampaign, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(campaign_code, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(campaign_name, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                                    .addGroup(jPanel22Layout.createSequentialGroup()
                                        .addComponent(t_barcode, javax.swing.GroupLayout.PREFERRED_SIZE, 92, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGap(0, 0, Short.MAX_VALUE))))
                            .addGroup(jPanel22Layout.createSequentialGroup()
                                .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 173, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(t_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(5, 5, 5)
                                .addComponent(btn_Calendar, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, 0)
                                .addComponent(t_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btn_Calendar1, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(0, 0, Short.MAX_VALUE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())
                    .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(jPanel22Layout.createSequentialGroup()
                        .addComponent(jPanel23, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(16, 16, 16))
                    .addGroup(jPanel22Layout.createSequentialGroup()
                        .addComponent(formember)
                        .addGap(0, 0, Short.MAX_VALUE))))
        );
        jPanel22Layout.setVerticalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel22Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel22Layout.createSequentialGroup()
                        .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(campaign_name, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jLabel27, javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(btnfindcampaign, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(campaign_code, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(t_code, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel1)))
                        .addGap(0, 0, 0)
                        .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(t_name, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel2))
                        .addGap(0, 0, 0)
                        .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(t_barcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel4)
                                .addComponent(jLabel5)
                                .addComponent(t_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(t_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(btn_Calendar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(btn_Calendar1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addGap(25, 25, 25)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, 181, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel23, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(formember)
                .addContainerGap(68, Short.MAX_VALUE))
        );

        paneltable.setBorder(null);

        jPanel17.setBorder(null);

        jLayeredPane1.setBorder(javax.swing.BorderFactory.createTitledBorder("Condition Selected"));

        buttonGroup4.add(rdactive1);
        rdactive1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdactive1.setSelected(true);
        rdactive1.setText("แสดงรายการทั้งหมด");
        rdactive1.setName("D_showall"); // NOI18N
        rdactive1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdactive1ActionPerformed(evt);
            }
        });
        rdactive1.setBounds(60, 60, 140, 28);
        jLayeredPane1.add(rdactive1, javax.swing.JLayeredPane.DEFAULT_LAYER);

        buttonGroup4.add(rdactive2);
        rdactive2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdactive2.setText("แสดงเฉพาะที่ Active");
        rdactive2.setName("D_showactive"); // NOI18N
        rdactive2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdactive2ActionPerformed(evt);
            }
        });
        rdactive2.setBounds(210, 60, 180, 28);
        jLayeredPane1.add(rdactive2, javax.swing.JLayeredPane.DEFAULT_LAYER);

        jLabel29.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel29.setText("เคมเปญ");
        jLabel29.setBounds(10, 30, 43, 30);
        jLayeredPane1.add(jLabel29, javax.swing.JLayeredPane.DEFAULT_LAYER);

        campaignlist.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        campaignlist.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        campaignlist.setPreferredSize(new java.awt.Dimension(78, 30));
        campaignlist.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                campaignlistActionPerformed(evt);
            }
        });
        campaignlist.setBounds(60, 30, 300, 30);
        jLayeredPane1.add(campaignlist, javax.swing.JLayeredPane.DEFAULT_LAYER);

        javax.swing.GroupLayout jPanel17Layout = new javax.swing.GroupLayout(jPanel17);
        jPanel17.setLayout(jPanel17Layout);
        jPanel17Layout.setHorizontalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLayeredPane1)
        );
        jPanel17Layout.setVerticalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel17Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLayeredPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel19.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        t_count1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_count1.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        t_count1.setText("จำนวนรายการ 0 รายการ");
        t_count1.setName("D_countlist"); // NOI18N

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addComponent(t_count1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(t_count1)
        );

        tblCupon.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        tblCupon.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "รหัส", "Barcode", "ชื่อบัตรคูปอง", "วันที่เริ่มต้น - วันที่สิ้นสุด", "ใช้เฉพาะวัน", "SaleType", "Redule ส่วนลด", "Redule ค่าบริการ", "ประเภทคูปอง", "ส่วนลด %", "ส่วนลดบาท", "ยอดซื้อขั้นต่ำ"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblCupon.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblCuponMouseClicked(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                tblCuponMouseReleased(evt);
            }
        });
        tblCupon.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                tblCuponKeyPressed(evt);
            }
        });
        jScrollPane1.setViewportView(tblCupon);
        tblCupon.getColumnModel().getColumn(0).setPreferredWidth(40);
        tblCupon.getColumnModel().getColumn(1).setPreferredWidth(70);
        tblCupon.getColumnModel().getColumn(2).setPreferredWidth(160);
        tblCupon.getColumnModel().getColumn(3).setPreferredWidth(160);
        tblCupon.getColumnModel().getColumn(4).setPreferredWidth(140);
        tblCupon.getColumnModel().getColumn(5).setPreferredWidth(120);
        tblCupon.getColumnModel().getColumn(6).setPreferredWidth(90);
        tblCupon.getColumnModel().getColumn(7).setPreferredWidth(90);
        tblCupon.getColumnModel().getColumn(8).setPreferredWidth(70);
        tblCupon.getColumnModel().getColumn(9).setPreferredWidth(80);
        tblCupon.getColumnModel().getColumn(10).setPreferredWidth(80);
        tblCupon.getColumnModel().getColumn(11).setPreferredWidth(100);

        lbcampaign.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        lbcampaign.setText("เคมเปญ  001 เคมเปญวันแม่แห่งชาติ");

        javax.swing.GroupLayout paneltableLayout = new javax.swing.GroupLayout(paneltable);
        paneltable.setLayout(paneltableLayout);
        paneltableLayout.setHorizontalGroup(
            paneltableLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(paneltableLayout.createSequentialGroup()
                .addGroup(paneltableLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel17, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 448, Short.MAX_VALUE)
                    .addComponent(lbcampaign, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        paneltableLayout.setVerticalGroup(
            paneltableLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(paneltableLayout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 376, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lbcampaign)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel17, javax.swing.GroupLayout.PREFERRED_SIZE, 119, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(paneltable, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(paneltable, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(13, Short.MAX_VALUE))
        );

        tab.addTab("Setup Cupon", jPanel2);

        paneltab2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel18.setBorder(javax.swing.BorderFactory.createTitledBorder("Branch Group Setup"));

        tblbranch.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่มสาขา", "ชื่อกลุ่มสาชา"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblbranch.setComponentPopupMenu(branch);
        tblbranch.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblbranchMousePressed(evt);
            }
        });
        jScrollPane2.setViewportView(tblbranch);
        tblbranch.getColumnModel().getColumn(0).setPreferredWidth(70);
        tblbranch.getColumnModel().getColumn(1).setPreferredWidth(160);

        btnok5.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnok5.setText("Link All Group");
        btnok5.setName("DBbtnok"); // NOI18N
        btnok5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnok5ActionPerformed(evt);
            }
        });

        jPanel15.setBorder(null);

        t_bcode.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_bcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_bcodeKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_bcodeKeyTyped(evt);
            }
        });

        btn_group.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group.setFocusable(false);
        btn_group.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_groupActionPerformed(evt);
            }
        });

        t_bname.setBackground(new java.awt.Color(249, 252, 186));
        t_bname.setEditable(false);
        t_bname.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle.setText("ยกเลิก(Cancel)");
        btnbranchcancle.setName("DBbtncancle"); // NOI18N
        btnbranchcancle.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancleActionPerformed(evt);
            }
        });

        btnbranchok.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchok.setText("ตกลง (OK)");
        btnbranchok.setName("DBbtnok"); // NOI18N
        btnbranchok.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchokActionPerformed(evt);
            }
        });
        btnbranchok.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnbranchokKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addComponent(t_bcode, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_bname))
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addComponent(btn_group, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnbranchok)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnbranchcancle, javax.swing.GroupLayout.DEFAULT_SIZE, 104, Short.MAX_VALUE))
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(t_bcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_bname, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btn_group, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnbranchok, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnbranchcancle, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))))
        );

        javax.swing.GroupLayout jPanel18Layout = new javax.swing.GroupLayout(jPanel18);
        jPanel18.setLayout(jPanel18Layout);
        jPanel18Layout.setHorizontalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel18Layout.createSequentialGroup()
                .addGroup(jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnok5)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(0, 3, Short.MAX_VALUE))
        );
        jPanel18Layout.setVerticalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel18Layout.createSequentialGroup()
                .addComponent(jPanel15, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 366, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnok5, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel20.setBorder(javax.swing.BorderFactory.createTitledBorder("Fix Branch Setup"));

        tblfixbranch.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่มสาขา", "รหัสสาขา", "ชื่อสาขา"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblfixbranch.setComponentPopupMenu(fixbranch);
        tblfixbranch.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblfixbranchMousePressed(evt);
            }
        });
        jScrollPane4.setViewportView(tblfixbranch);
        tblfixbranch.getColumnModel().getColumn(0).setPreferredWidth(70);
        tblfixbranch.getColumnModel().getColumn(1).setPreferredWidth(60);
        tblfixbranch.getColumnModel().getColumn(2).setPreferredWidth(160);

        jPanel21.setBorder(null);
        jPanel21.setOpaque(false);

        btnbranchok1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchok1.setText("ตกลง (OK)");
        btnbranchok1.setName("DBbtnok"); // NOI18N
        btnbranchok1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchok1ActionPerformed(evt);
            }
        });
        btnbranchok1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnbranchok1KeyPressed(evt);
            }
        });

        t_fixbranch.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_fixbranch.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_fixbranchKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_fixbranchKeyTyped(evt);
            }
        });

        btn_group2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group2.setFocusable(false);
        btn_group2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group2ActionPerformed(evt);
            }
        });

        t_fixname.setBackground(new java.awt.Color(249, 252, 186));
        t_fixname.setEditable(false);
        t_fixname.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle1.setText("ยกเลิก(Cancel)");
        btnbranchcancle1.setName("DBbtncancle"); // NOI18N
        btnbranchcancle1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel21Layout = new javax.swing.GroupLayout(jPanel21);
        jPanel21.setLayout(jPanel21Layout);
        jPanel21Layout.setHorizontalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel21Layout.createSequentialGroup()
                .addComponent(t_fixbranch, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(t_fixname, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(86, 86, 86))
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addComponent(btn_group2, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnbranchok1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnbranchcancle1, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel21Layout.setVerticalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(t_fixbranch, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_fixname, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnbranchok1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnbranchcancle1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        javax.swing.GroupLayout jPanel20Layout = new javax.swing.GroupLayout(jPanel20);
        jPanel20.setLayout(jPanel20Layout);
        jPanel20Layout.setHorizontalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
            .addGroup(jPanel20Layout.createSequentialGroup()
                .addComponent(jPanel21, javax.swing.GroupLayout.PREFERRED_SIZE, 292, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 24, Short.MAX_VALUE))
        );
        jPanel20Layout.setVerticalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel20Layout.createSequentialGroup()
                .addComponent(jPanel21, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel6.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        t_code2.setBackground(new java.awt.Color(254, 192, 165));
        t_code2.setEditable(false);
        t_code2.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(t_code2, javax.swing.GroupLayout.PREFERRED_SIZE, 551, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(t_code2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout paneltab2Layout = new javax.swing.GroupLayout(paneltab2);
        paneltab2.setLayout(paneltab2Layout);
        paneltab2Layout.setHorizontalGroup(
            paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(paneltab2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(paneltab2Layout.createSequentialGroup()
                        .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap())
                    .addGroup(paneltab2Layout.createSequentialGroup()
                        .addComponent(jPanel18, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(5, 5, 5)
                        .addComponent(jPanel20, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 407, Short.MAX_VALUE))))
        );
        paneltab2Layout.setVerticalGroup(
            paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, paneltab2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel20, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel18, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(21, Short.MAX_VALUE))
        );

        tab.addTab("BranchGroup & FixBranch", paneltab2);

        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Header 2 Line", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N

        Head1.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        Head1.setText("jTextField1");
        Head1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Head1KeyTyped(evt);
            }
        });

        Head2.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        Head2.setText("jTextField2");
        Head2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Head2KeyTyped(evt);
            }
        });

        jLabel7.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        jLabel7.setText("25 Charecter");

        jLabel8.setFont(new java.awt.Font("Norasi", 1, 18)); // NOI18N
        jLabel8.setText("25 Charecter");

        Head3.setFont(new java.awt.Font("Norasi", 1, 24)); // NOI18N
        Head3.setText("jTextField1");

        Head4.setFont(new java.awt.Font("Norasi", 1, 24)); // NOI18N
        Head4.setText("jTextField1");

        jLabel9.setFont(new java.awt.Font("Norasi", 1, 24)); // NOI18N
        jLabel9.setText("20 Charecter");

        jLabel16.setFont(new java.awt.Font("Norasi", 1, 24)); // NOI18N
        jLabel16.setText("20 Charecter");

        Head5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Head5.setText("jTextField3");
        Head5.setOpaque(false);
        Head5.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Head5KeyTyped(evt);
            }
        });

        Head6.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Head6.setText("jTextField3");
        Head6.setOpaque(false);
        Head6.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Head6KeyTyped(evt);
            }
        });

        jLabel17.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel17.setText("50 Charecter");

        jLabel18.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel18.setText("50 Charecter");

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(Head1)
                            .addComponent(Head2)
                            .addComponent(Head3, javax.swing.GroupLayout.DEFAULT_SIZE, 258, Short.MAX_VALUE)
                            .addComponent(Head4))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel8, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 157, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel16, javax.swing.GroupLayout.PREFERRED_SIZE, 157, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addContainerGap(57, Short.MAX_VALUE))
                    .addGroup(jPanel8Layout.createSequentialGroup()
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(Head6, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 367, Short.MAX_VALUE)
                            .addComponent(Head5, javax.swing.GroupLayout.Alignment.LEADING))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, Short.MAX_VALUE))))
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Head1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel7))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(Head2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel8))
                .addGap(27, 27, 27)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Head3, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel9))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Head4, javax.swing.GroupLayout.PREFERRED_SIZE, 44, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel16))
                .addGap(18, 18, 18)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Head5, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel17))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(Head6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Condition 35Line/50Character", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Norasi", 0, 14))); // NOI18N
        jPanel9.setAutoscrolls(true);
        jPanel9.setLayout(new java.awt.GridLayout(35, 1));

        Con1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con1.setText("jTextField3");
        Con1.setOpaque(false);
        Con1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con1KeyTyped(evt);
            }
        });
        jPanel9.add(Con1);

        Con2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con2.setText("jTextField3");
        Con2.setOpaque(false);
        Con2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con2KeyTyped(evt);
            }
        });
        jPanel9.add(Con2);

        Con3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con3.setText("jTextField3");
        Con3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con3KeyTyped(evt);
            }
        });
        jPanel9.add(Con3);

        Con4.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con4.setText("jTextField3");
        Con4.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con4KeyTyped(evt);
            }
        });
        jPanel9.add(Con4);

        Con5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con5.setText("jTextField3");
        Con5.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con5KeyTyped(evt);
            }
        });
        jPanel9.add(Con5);

        Con6.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con6.setText("jTextField3");
        Con6.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con6KeyTyped(evt);
            }
        });
        jPanel9.add(Con6);

        Con7.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con7.setText("jTextField3");
        Con7.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con7KeyTyped(evt);
            }
        });
        jPanel9.add(Con7);

        Con8.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con8.setText("jTextField3");
        Con8.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con8KeyTyped(evt);
            }
        });
        jPanel9.add(Con8);

        Con9.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con9.setText("jTextField3");
        Con9.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con9KeyTyped(evt);
            }
        });
        jPanel9.add(Con9);

        Con10.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con10.setText("jTextField3");
        Con10.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con10KeyTyped(evt);
            }
        });
        jPanel9.add(Con10);

        Con11.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con11.setText("jTextField3");
        Con11.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con11KeyTyped(evt);
            }
        });
        jPanel9.add(Con11);

        Con12.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con12.setText("jTextField3");
        Con12.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con12KeyTyped(evt);
            }
        });
        jPanel9.add(Con12);

        Con13.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con13.setText("jTextField3");
        Con13.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con13KeyTyped(evt);
            }
        });
        jPanel9.add(Con13);

        Con14.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con14.setText("jTextField3");
        Con14.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con14KeyTyped(evt);
            }
        });
        jPanel9.add(Con14);

        Con15.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con15.setText("jTextField3");
        Con15.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con15KeyTyped(evt);
            }
        });
        jPanel9.add(Con15);

        Con16.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con16.setText("jTextField3");
        Con16.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con16KeyTyped(evt);
            }
        });
        jPanel9.add(Con16);

        Con17.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con17.setText("jTextField3");
        Con17.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con17KeyTyped(evt);
            }
        });
        jPanel9.add(Con17);

        Con18.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con18.setText("jTextField3");
        Con18.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con18KeyTyped(evt);
            }
        });
        jPanel9.add(Con18);

        Con19.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con19.setText("jTextField3");
        Con19.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con19KeyTyped(evt);
            }
        });
        jPanel9.add(Con19);

        Con20.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con20.setText("jTextField3");
        Con20.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con20KeyTyped(evt);
            }
        });
        jPanel9.add(Con20);

        Con21.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con21.setText("jTextField3");
        Con21.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con21KeyTyped(evt);
            }
        });
        jPanel9.add(Con21);

        Con22.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con22.setText("jTextField3");
        Con22.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con22KeyTyped(evt);
            }
        });
        jPanel9.add(Con22);

        Con23.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con23.setText("jTextField3");
        Con23.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con23KeyTyped(evt);
            }
        });
        jPanel9.add(Con23);

        Con24.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con24.setText("jTextField3");
        Con24.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con24KeyTyped(evt);
            }
        });
        jPanel9.add(Con24);

        Con25.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con25.setText("jTextField3");
        Con25.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con25KeyTyped(evt);
            }
        });
        jPanel9.add(Con25);

        Con26.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con26.setText("jTextField3");
        Con26.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con26KeyTyped(evt);
            }
        });
        jPanel9.add(Con26);

        Con27.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con27.setText("jTextField3");
        Con27.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con27KeyTyped(evt);
            }
        });
        jPanel9.add(Con27);

        Con28.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con28.setText("jTextField3");
        Con28.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con28KeyTyped(evt);
            }
        });
        jPanel9.add(Con28);

        Con29.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con29.setText("jTextField3");
        Con29.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con29KeyTyped(evt);
            }
        });
        jPanel9.add(Con29);

        Con30.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con30.setText("jTextField3");
        Con30.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con30KeyTyped(evt);
            }
        });
        jPanel9.add(Con30);

        Con31.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con31.setText("jTextField3");
        Con31.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con31KeyTyped(evt);
            }
        });
        jPanel9.add(Con31);

        Con32.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con32.setText("jTextField3");
        Con32.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con32KeyTyped(evt);
            }
        });
        jPanel9.add(Con32);

        Con33.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con33.setText("jTextField3");
        Con33.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con33KeyTyped(evt);
            }
        });
        jPanel9.add(Con33);

        Con34.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con34.setText("jTextField3");
        Con34.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con34KeyTyped(evt);
            }
        });
        jPanel9.add(Con34);

        Con35.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        Con35.setText("jTextField3");
        Con35.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                Con35KeyTyped(evt);
            }
        });
        jPanel9.add(Con35);

        jScrollPane5.setViewportView(jPanel9);

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 407, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(106, 106, 106))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 545, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(37, Short.MAX_VALUE))
        );

        tab.addTab("Message & Condition ", jPanel7);

        jPanel14.setBorder(javax.swing.BorderFactory.createTitledBorder("Setup PLU For This Coupon"));

        jPanel16.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btn_plu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_plu.setFocusable(false);
        btn_plu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_pluActionPerformed(evt);
            }
        });

        t_plu.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_plu.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_pluKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_pluKeyTyped(evt);
            }
        });

        btnpluok.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnpluok.setText("ตกลง (OK)");
        btnpluok.setName("DBbtnok"); // NOI18N
        btnpluok.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnpluokActionPerformed(evt);
            }
        });
        btnpluok.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnpluokKeyPressed(evt);
            }
        });

        t_pluname.setBackground(new java.awt.Color(249, 252, 186));
        t_pluname.setEditable(false);
        t_pluname.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle2.setText("ยกเลิก (Cancel)");
        btnbranchcancle2.setName("DBbtncancle"); // NOI18N
        btnbranchcancle2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addComponent(btn_plu, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(t_plu))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(t_pluname, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addComponent(btnpluok, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnbranchcancle2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addComponent(t_plu, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_plu, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addComponent(t_pluname, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnpluok, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnbranchcancle2, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        tblplu.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่ม", "รหัสสินค้า", "ชื่อสินค้า"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblplu.setComponentPopupMenu(plu);
        tblplu.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        tblplu.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblpluMousePressed(evt);
            }
        });
        jScrollPane3.setViewportView(tblplu);
        tblplu.getColumnModel().getColumn(0).setPreferredWidth(50);
        tblplu.getColumnModel().getColumn(1).setPreferredWidth(100);
        tblplu.getColumnModel().getColumn(2).setPreferredWidth(250);

        jLabel13.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel13.setText("รหัสกลุ่ม");
        jLabel13.setName("D_groupcode"); // NOI18N

        t_gcode.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_gcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_gcodeKeyPressed(evt);
            }
        });

        btngroupok.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btngroupok.setText("เลือกทั้งกลุ่ม");
        btngroupok.setName("DBbtnallgroup"); // NOI18N
        btngroupok.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btngroupokActionPerformed(evt);
            }
        });

        btn_group3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group3.setFocusable(false);
        btn_group3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane3, javax.swing.GroupLayout.DEFAULT_SIZE, 423, Short.MAX_VALUE)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addComponent(jLabel13)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_gcode, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_group3, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btngroupok, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addComponent(jPanel16, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel13)
                        .addComponent(t_gcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btngroupok, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel24.setBorder(javax.swing.BorderFactory.createTitledBorder("Setup Except PLU For This Coupon"));

        jPanel25.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btn_plu1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_plu1.setFocusable(false);
        btn_plu1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_plu1ActionPerformed(evt);
            }
        });

        t_plu1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_plu1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_plu1KeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_plu1KeyTyped(evt);
            }
        });

        btnpluok1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnpluok1.setText("ตกลง (OK)");
        btnpluok1.setName("DBbtnok"); // NOI18N
        btnpluok1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnpluok1ActionPerformed(evt);
            }
        });
        btnpluok1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnpluok1KeyPressed(evt);
            }
        });

        t_pluname1.setBackground(new java.awt.Color(249, 252, 186));
        t_pluname1.setEditable(false);
        t_pluname1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle3.setText("ยกเลิก (Cancel)");
        btnbranchcancle3.setName("DBbtncancle"); // NOI18N
        btnbranchcancle3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel25Layout = new javax.swing.GroupLayout(jPanel25);
        jPanel25.setLayout(jPanel25Layout);
        jPanel25Layout.setHorizontalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addGroup(jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel25Layout.createSequentialGroup()
                        .addComponent(btn_plu1, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(t_plu1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(t_pluname1, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel25Layout.createSequentialGroup()
                        .addComponent(btnpluok1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnbranchcancle3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        jPanel25Layout.setVerticalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addComponent(t_plu1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_plu1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addComponent(t_pluname1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnpluok1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnbranchcancle3, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        tblplu1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่ม", "รหัสสินค้า", "ชื่อสินค้า"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblplu1.setComponentPopupMenu(plu1);
        tblplu1.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        tblplu1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblplu1MousePressed(evt);
            }
        });
        jScrollPane6.setViewportView(tblplu1);
        tblplu1.getColumnModel().getColumn(0).setPreferredWidth(50);
        tblplu1.getColumnModel().getColumn(1).setPreferredWidth(80);
        tblplu1.getColumnModel().getColumn(2).setPreferredWidth(250);

        jLabel20.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel20.setText("รหัสกลุ่ม");
        jLabel20.setName("D_groupcode"); // NOI18N

        t_gcode1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_gcode1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_gcode1KeyPressed(evt);
            }
        });

        btngroupok1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btngroupok1.setText("เลือกทั้งกลุ่ม");
        btngroupok1.setName("DBbtnallgroup"); // NOI18N
        btngroupok1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btngroupok1ActionPerformed(evt);
            }
        });

        btn_group4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group4.setFocusable(false);
        btn_group4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel24Layout = new javax.swing.GroupLayout(jPanel24);
        jPanel24.setLayout(jPanel24Layout);
        jPanel24Layout.setHorizontalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 452, Short.MAX_VALUE)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addComponent(jLabel20)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_gcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_group4, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btngroupok1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel25, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel24Layout.setVerticalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addComponent(jPanel25, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel20)
                        .addComponent(t_gcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btngroupok1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group4, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 419, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addComponent(jPanel14, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 93, Short.MAX_VALUE)
                .addComponent(jPanel24, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel24, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        tab.addTab("Setup PLU For eCoupon", jPanel10);

        jMenu1.setText("ฟังก์ชั่น");
        jMenu1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jMenu1.setName("menufuc"); // NOI18N

        menuNew.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_N, java.awt.event.InputEvent.CTRL_MASK));
        menuNew.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuNew.setText("เพิ่มรายการ");
        menuNew.setName("madd"); // NOI18N
        menuNew.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuNewActionPerformed(evt);
            }
        });
        jMenu1.add(menuNew);

        menuCancel.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_I, java.awt.event.InputEvent.CTRL_MASK));
        menuCancel.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuCancel.setText("ยกเลิก");
        menuCancel.setName("mcancle"); // NOI18N
        menuCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuCancelActionPerformed(evt);
            }
        });
        jMenu1.add(menuCancel);

        menuSave.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_S, java.awt.event.InputEvent.CTRL_MASK));
        menuSave.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuSave.setText("บันทึกข้อมูล");
        menuSave.setName("msave"); // NOI18N
        menuSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuSaveActionPerformed(evt);
            }
        });
        jMenu1.add(menuSave);

        menuDelete.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_R, java.awt.event.InputEvent.CTRL_MASK));
        menuDelete.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuDelete.setText("ลบข้อมูล");
        menuDelete.setName("mdel"); // NOI18N
        jMenu1.add(menuDelete);
        jMenu1.add(jSeparator1);

        menuExit.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_E, java.awt.event.InputEvent.CTRL_MASK));
        menuExit.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuExit.setText("ออก");
        menuExit.setName("mexit"); // NOI18N
        jMenu1.add(menuExit);

        jMenuBar1.add(jMenu1);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(tab, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 1016, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(8, 8, 8))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tab, javax.swing.GroupLayout.DEFAULT_SIZE, 644, Short.MAX_VALUE))
        );

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-1024)/2, (screenSize.height-781)/2, 1024, 781);
    }// </editor-fold>//GEN-END:initComponents

    public void loadcampainlist() {
        ResultSet rs = null;
        campaignlist.removeAllItems();
        campaignlist.addItem("ALL-แสดงทั้งหมด...");
        try {
            stmt = (java.sql.Statement) dbUtility.con.createStatement();
            String sql = "select * from campaignfile order by campaign_code ";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                campaignlist.addItem(cvth.ASCII2Unicode(rs.getString("campaign_code")) + "-" + cvth.ASCII2Unicode(rs.getString("campaign_name")));
            }
        } catch (SQLException ex) {
            PUtility.ShowMsg(ex.getMessage().toString());
        }
    }
    private void checkuserconfig() {
        //MenuName = Mast1
        UserLogin userrec = UserLogin.userlogin;
        if (userrec.getMast19().equals("1")) {
            btnNew.setEnabled(false);
            btnSave.setEnabled(false);
            btnDelete.setEnabled(false);
            menuNew.setEnabled(false);
            menuSave.setEnabled(false);
            menuSave.setEnabled(false);
            btn_group.setEnabled(false);
            btnbranchok.setEnabled(false);
            btn_group2.setEnabled(false);
            btnbranchok1.setEnabled(false);
            btnpluok.setEnabled(false);
            btngroupok.setEnabled(false);
            plu.setEnabled(false);
            btnpluok1.setEnabled(false);
            btngroupok1.setEnabled(false);
            plu1.setEnabled(false);
        }
        if (userrec.getMast19().equals("2")) {
            btnNew.setEnabled(true);
            btnSave.setEnabled(true);
            btnDelete.setEnabled(false);
            menuNew.setEnabled(true);
            menuSave.setEnabled(true);
            menuSave.setEnabled(false);
            btn_group.setEnabled(true);
            btnbranchok.setEnabled(true);
            btn_group2.setEnabled(true);
            btnbranchok1.setEnabled(true);
            btnpluok.setEnabled(true);
            btngroupok.setEnabled(true);
            plu.setEnabled(false);
            btnpluok1.setEnabled(true);
            btngroupok1.setEnabled(true);
            plu1.setEnabled(false);
        }
        if (userrec.getMast19().equals("3")) {
            btnNew.setEnabled(true);
            btnSave.setEnabled(true);
            btnDelete.setEnabled(true);
            menuNew.setEnabled(true);
            menuSave.setEnabled(true);
            menuSave.setEnabled(true);
            btn_group.setEnabled(true);
            btnbranchok.setEnabled(true);
            btn_group2.setEnabled(true);
            btnbranchok1.setEnabled(true);
            btnpluok.setEnabled(true);
            btngroupok.setEnabled(true);
            plu.setEnabled(true);
            btnpluok1.setEnabled(true);
            btngroupok1.setEnabled(true);
            plu1.setEnabled(true);
        }
    }
    private void t_codeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_codeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            if (!t_code.getText().trim().equals("")) {
                if (chkdata(t_code.getText())) {
                    String Code = "";
                    Code = t_code.getText().trim();
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        GetData(cvth.Unicode2ASCII(Code));
                    } else {
                        GetData(Code);
                    }
                } else {
                    setActive();
                    t_code.setBackground(new java.awt.Color(255, 246, 143));
                    t_code.setEditable(false);

                }
                campaign_code.requestFocus();
                tab.setEnabledAt(1, true);
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_codeKeyPressed

    private void tblCuponMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblCuponMouseReleased

        if (evt.getClickCount() == 2) {
            int index = tblCupon.getSelectedRow();
            String creditcode = tblCupon.getValueAt(index, 0).toString();
            if (t_code.getText().equals("")) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    GetData(cvth.Unicode2ASCII(creditcode));
                } else {
                    GetData(creditcode);
                }
            } else if (!t_code.getText().equals(creditcode)) {
                int confirm = JOptionPane.showConfirmDialog(this, "คุณมีการเพิ่มหรือแก้ไขข้อมูลอยู่ คุณต้องการยกเลิกการเพิ่มหรือแก้ไขข้อมูลนั้นหรือไม่", "Confirm", JOptionPane.YES_NO_OPTION);
                if (confirm == JOptionPane.YES_OPTION) {
//                    GetData(creditcode);
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        GetData(cvth.Unicode2ASCII(creditcode));
                    } else {
                        GetData(creditcode);
                    }
                }
            }
            t_code.setBackground(new java.awt.Color(255, 246, 143));
            t_code.setEditable(false);
            campaign_code.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_tblCuponMouseReleased

    private void rdactive2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdactive2ActionPerformed

        chkactive(Format.dateFmtSql.format(new java.util.Date()));
        // TODO add your handling code here:
    }//GEN-LAST:event_rdactive2ActionPerformed

    private void rdactive1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdactive1ActionPerformed

        showdataintb();
        // TODO add your handling code here:
    }//GEN-LAST:event_rdactive1ActionPerformed

    public boolean removePluCuponList(String code) {
        Statement stmt = null;
        boolean isRemove = false;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "delete from ecuponlist Where pcode = '" + code + "';";
            int deleteRow = stmt.executeUpdate(sql);
            if (deleteRow > 0) {
                isRemove = true;
                System.out.print("remove ecupon success ");
            }
        } catch (Exception e) {
            System.out.print("Error : remove menulist error ");
        }

        return isRemove;
    }

    public String[] addProductToCopon(String plu) {
        Statement stmt = null;
        ResultSet rs = null;
        String[] product = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT pcode,pdesc,pprice11 FROM product   where pcode = '" + plu + "';";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                product = new String[2];
                product[0] = rs.getString("pcode");
                product[1] = rs.getString("pdesc");
            }
        } catch (Exception e) {
        }
        return product;
    }

    public boolean insertCuponList(String cocode, String pcode) {
        Statement stmt = null;
        boolean isupdate = false;
        int rowInsert = 0;
        String sql = "";

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            sql = "insert into ecuponlist values('" + cocode + "','" + pcode + "')";
            rowInsert = stmt.executeUpdate(sql);
            if (rowInsert > 0) {
                isupdate = true;
            }
        } catch (Exception e) {
        }
        return isupdate;
    }
    public boolean insertCuponList1(String cocode, String pcode) {
        Statement stmt = null;
        boolean isupdate = false;
        int rowInsert = 0;
        String sql = "";

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            sql = "insert into ecuponunlist values('" + cocode + "','" + pcode + "')";
            rowInsert = stmt.executeUpdate(sql);
            if (rowInsert > 0) {
                isupdate = true;
            }
        } catch (Exception e) {
        }
        return isupdate;
    }

    
    private void c1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c1ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c1ActionPerformed

    private void c2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c2ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c2ActionPerformed

    private void btnNewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNewActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNewActionPerformed

    private void btnCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnCancelActionPerformed

    private void c3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c3ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c3ActionPerformed

    private void c4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c4ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c4ActionPerformed

    private void c5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c5ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c5ActionPerformed

    private void c6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c6ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c6ActionPerformed

    private void c7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c7ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c7ActionPerformed

    public void btndate1() {
        try {
            Point point = btn_Calendar.getLocation();
            point.setLocation(point.getX() + 1, point.getY() + 1);
            utilities.DateChooser.DateChooserDialog dcd = new utilities.DateChooser.DateChooserDialog(null, true, point);
            dcd.setVisible(true);
            t_date1.setText(Format.dateFmtShow.format(dcd.getSelectedDate().getTime()));
            t_date2.requestFocus();
        } catch (Exception e) {
            t_date2.requestFocus();
        }
    }

    private void btn_CalendarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CalendarActionPerformed
         DateUtil.showDateChooserDialog(t_date1, btn_Calendar);
         t_date1.requestFocus();     
        //btndate1();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_CalendarActionPerformed

    public void btndate2() {
        try {
            Point point = btn_Calendar1.getLocation();
            point.setLocation(point.getX() + 1, point.getY() + 1);
            utilities.DateChooser.DateChooserDialog dcd = new utilities.DateChooser.DateChooserDialog(null, true, point);
            dcd.setVisible(true);
            t_date2.setText(Format.dateFmtShow.format(dcd.getSelectedDate().getTime()));
            strDay.requestFocus();
        } catch (Exception e) {
            strDay.requestFocus();
        }
    }

    public void expcouponback() {
        Export2Excel test = new Export2Excel();
        JFileChooser chooser = new JFileChooser();

        try {
            File f = new File(new File("cupon.xls").getCanonicalPath());

            chooser.setSelectedFile(f);
        } catch (IOException e) {
        }
        chooser.showSaveDialog(this);

        File curFile = chooser.getSelectedFile();

        try {
            test.setOutputFile(curFile.toString());
            test.write(model, modelh1);
        } catch (IOException ex) {
        } catch (WriteException ex) {
        }
        // TODO add your handling code here:
    }

    public void exppluback() {
        Export2Excel test = new Export2Excel();
        JFileChooser chooser = new JFileChooser();

        try {
            File f = new File(new File("plu.xls").getCanonicalPath());

            chooser.setSelectedFile(f);
        } catch (IOException e) {
        }
        chooser.showSaveDialog(this);

        File curFile = chooser.getSelectedFile();

        try {
            test.setOutputFile(curFile.toString());
            test.write(model2, modelh2);
        } catch (IOException ex) {
        } catch (WriteException ex) {
        }
        // TODO add your handling code here:
    }

    private void btn_Calendar1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_Calendar1ActionPerformed
        DateUtil.showDateChooserDialog(t_date2, btn_Calendar1);
        t_date2.requestFocus(); 
        //btndate2();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_Calendar1ActionPerformed

    private void btnSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveActionPerformed

        if (!t_code.getText().trim().equals("")) {
            btnsave();
            SaveFixBranch();
            if (bsaveOK) {
                clearForm();
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnSaveActionPerformed

    private void te1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_te1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_te1ActionPerformed

    private void tt1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tt1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_tt1ActionPerformed

    private void td1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_td1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_td1ActionPerformed

    private void tp1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tp1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_tp1ActionPerformed

    private void tw1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tw1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_tw1ActionPerformed

    private void jButton7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton7ActionPerformed

        dispose();
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton7ActionPerformed

    private void t_barcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_barcodeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date1.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_barcodeKeyPressed

    private void t_nameKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_nameKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_barcode.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_nameKeyPressed

    private void t_discountbathKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_discountbathKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_cnt.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountbathKeyPressed

    private void t_buyminKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_buyminKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_discountbath.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_buyminKeyPressed

    private void btnbranchokActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchokActionPerformed

        String get = t_bcode.getText();
        String out = get.toUpperCase();
        t_bcode.setText(out);
        if (!chkdatabranch(t_bcode.getText(), t_code.getText())) {
            if (chkdatabranchgroup(t_bcode.getText())) {
                btnsave();
                if (chkdata(t_code.getText())) {
                    btnsavebranch();
                    getBranchList(t_code.getText());
                }
            } else {
                JOptionPane.showMessageDialog(this, "ไม่มีข้อมูล BranchGroup นี้ในระบบ..");
            }
        } else {
            JOptionPane.showMessageDialog(this, "ข้อมูล BranchGroup นี้มีอยู่แล้ว..");
        }

        t_bcode.requestFocus();
    }//GEN-LAST:event_btnbranchokActionPerformed
    private void btnbranchcancleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancleActionPerformed

        escbranch();

        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchcancleActionPerformed

    public void btngroup() {
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        BrowserBranchGroup dialog = new BrowserBranchGroup(new NimbusFrame(), true, point);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                BranchCodeName hrb = dialog.getDataRecord();
                t_bcode.setText(dialog.code);
                GetDataBranch(dialog.code);
                btnbranchok.requestFocus();
            } else {
                t_bcode.requestFocus();
            }
        } catch (Exception e) {
            t_bcode.requestFocus();
        }
    }

    private void btn_groupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_groupActionPerformed

        btngroup();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_groupActionPerformed

    public void escbranch() {
        t_bcode.setText("");
        t_bname.setText("");
        t_bcode.requestFocus();
    }

    private void t_bcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_bcodeKeyPressed

        String get = t_bcode.getText();
        String out = get.toUpperCase();
        t_bcode.setText(out);
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            String Code = "";
            Code = t_bcode.getText();
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataBranch(cvth.ASCII2Unicode(Code));
                btnbranchok.requestFocus();
            } else {
                GetDataBranch(Code);
                btnbranchok.requestFocus();
            }
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btngroup();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escbranch();
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_t_bcodeKeyPressed

   

    

    private void menuNewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuNewActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_menuNewActionPerformed

    private void menuCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuCancelActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_menuCancelActionPerformed

    private void menuSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuSaveActionPerformed

        if (!t_code.getText().trim().equals("")) {
            btnsave();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_menuSaveActionPerformed

    private void btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDeleteActionPerformed


        if (!t_code.getText().trim().equals("")) {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                String Code = cvth.Unicode2ASCII(t_code.getText());
                delete(Code);
            } else {
                String Code = t_code.getText();
                delete(Code);
            }

        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnDeleteActionPerformed

    public void saveallbranch() {
        try {
            for (int i = 0; i < tblbranch.getRowCount(); i++) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {

                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "insert into eculink (CuCode,BGroup) values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                    prm2.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                    prm2.setString(2, cvth.Unicode2ASCII(tblbranch.getValueAt(i, 0).toString()));
                    prm2.executeUpdate();
                    stmt.close();

                } else {
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "insert into eculink (CuCode,BGroup) values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                    prm2.setString(1, t_code.getText());
                    prm2.setString(1, tblbranch.getValueAt(i, 0).toString());
                    prm2.executeUpdate();
                    stmt.close();
                }
            }

        } catch (Exception e) {
        }
    }

    private void btnok5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnok5ActionPerformed


        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from eculink where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getBranchgroup();
            saveallbranch();


        } catch (Exception e) {
        }

    }//GEN-LAST:event_btnok5ActionPerformed

    public void escfixbranch() {
        t_fixbranch.setText("");
        t_fixname.setText("");
        t_fixbranch.requestFocus();
    }

    private void t_fixbranchKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_fixbranchKeyPressed

        String get = t_fixbranch.getText();
        String out = get.toUpperCase();
        t_fixbranch.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            String Code;
            Code = t_fixbranch.getText();
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataFixBranch(cvth.ASCII2Unicode(Code));
            } else {
                GetDataFixBranch(Code);
            }
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnfixbranch();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escfixbranch();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_fixbranchKeyPressed

    private void btnbranchok1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchok1ActionPerformed

        if (tblbranch.getRowCount() > 0) {
            if (chkdatafixbranchingroup(t_fixbranch.getText())) {
                if (!chkdatafixbranch(t_fixbranch.getText(), t_code.getText())) {
                    if (chkdatabranchfile(t_fixbranch.getText())) {
                        btnsave();
                        if (chkdata(t_code.getText())) {
                            btnsavefixbranch();
                            getFixBranchList(t_code.getText());
                        }
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่มีข้อมูลสาขานี้ในระบบ..");
                    }
                } else {
                    JOptionPane.showMessageDialog(this, "ข้อมูลสาขานี้มีอยู่แล้ว..");
                }
            } else {
                JOptionPane.showMessageDialog(this, "สาขานี้ไม่มีในกลุ่มที่กำหนด..");
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดกลุ่มสาขาก่อน...");
        }
        escfixbranch();

        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchok1ActionPerformed

    public void btnfixbranch() {
        model3 = (DefaultTableModel) tblbranch.getModel();
        BrowserBranchmult3 list = new BrowserBranchmult3(new NimbusFrame(), true, t_code.getText(), model3);
        list.setVisible(true);
        clearModel4();
        getFixBranchList(t_code.getText());
    }
    public void GetDataplu(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from product where PCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_plu.setText(cvth.ASCII2Unicode(rs.getString("PCode")));
                        t_pluname.setText(cvth.ASCII2Unicode(rs.getString("PDesc")));
                    } else {
                        t_plu.setText(rs.getString("PCode"));
                        t_pluname.setText(rs.getString("PDesc"));
                    }
                    btnpluok.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลสินค้า");
                    t_plu.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }
    public void GetDataplu1(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from product where PCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_plu1.setText(cvth.ASCII2Unicode(rs.getString("PCode")));
                        t_pluname1.setText(cvth.ASCII2Unicode(rs.getString("PDesc")));
                    } else {
                        t_plu1.setText(rs.getString("PCode"));
                        t_pluname1.setText(rs.getString("PDesc"));
                    }
                    btnpluok1.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลสินค้า");
                    t_plu1.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    private void btn_group2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group2ActionPerformed


        if (tblbranch.getRowCount() == 0) {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดกลุ่มสาขาก่อน...");
        } else {
            btnfixbranch();
        }


        // TODO add your handling code here:
    }//GEN-LAST:event_btn_group2ActionPerformed

    private void btnbranchcancle1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle1ActionPerformed

        escfixbranch();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchcancle1ActionPerformed

    private void tabMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tabMousePressed


        if (tab.getSelectedIndex() == 1) {

//            paneltable.setVisible(false);
//            paneltab2.setPreferredSize(new Dimension(1023, 625));

        }
        if (tab.getSelectedIndex() == 0) {

//            paneltable.setVisible(true);
            t_barcode.requestFocus();

        }

    }//GEN-LAST:event_tabMousePressed

    private void t_bcodeKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_bcodeKeyTyped

        if (t_bcode.getText().length() >= 3) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_bcodeKeyTyped

    private void t_fixbranchKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_fixbranchKeyTyped

        if (t_fixbranch.getText().length() >= 12) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_fixbranchKeyTyped

    private void tblbranchMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblbranchMousePressed
    }//GEN-LAST:event_tblbranchMousePressed

    private void tblfixbranchMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblfixbranchMousePressed
    }//GEN-LAST:event_tblfixbranchMousePressed

    private void btnbranchokKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnbranchokKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escbranch();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchokKeyPressed

    private void btnbranchok1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnbranchok1KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escfixbranch();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchok1KeyPressed

    private void jMenuItem7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem7ActionPerformed

        // TODO add your handling code here:
        try {
            int[] intArray = tblplu.getSelectedRows();

            for (int i = 0; i < intArray.length; i++) {
                String plu2 = tblplu.getValueAt(intArray[i], 1).toString();
                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from ecuponlist where PCode ='" + plu2 + "' and CuCode = '" + t_code.getText() + "'";
                stmt.executeUpdate(sql2);
                stmt.close();
            }
        } catch (Exception e) {
        }
        getCuponList(t_code.getText());
    }//GEN-LAST:event_jMenuItem7ActionPerformed

    private void jMenuItem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem6ActionPerformed
       try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from ecuponlist where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getCuponList(t_code.getText());
        } catch (Exception e) {
        }
    
    }//GEN-LAST:event_jMenuItem6ActionPerformed

    private void jMenuItem8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem8ActionPerformed

        try {
            if (tblbranch.getSelectedRowCount() > 0) {
                int[] intArray = tblbranch.getSelectedRows();
                for (int s = 0; s < intArray.length; s++) {
                    String Tempbgroup = tblbranch.getValueAt(intArray[s], 0).toString();
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "delete from eculink where bgroup = '" + Tempbgroup + "' and CuCode = '" + t_code.getText() + "'";
                    stmt.executeUpdate(sql2);
                    stmt.close();
                }
            }
        } catch (Exception e) {
        }
        getBranchList(t_code.getText());
        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem8ActionPerformed

    private void jMenuItem9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem9ActionPerformed

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "delete from eculink where cucode = '" + t_code.getText() + "'";
            stmt.executeUpdate(sql2);
            stmt.close();
        } catch (Exception e) {
        }
        getBranchList(t_code.getText());

        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem9ActionPerformed

    private void jMenuItem10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem10ActionPerformed

        try {

            int[] intArray = new int[tblfixbranch.getRowCount()];
            for (int i = 0; i < tblfixbranch.getRowCount(); i++) {
                intArray = tblfixbranch.getSelectedRows();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from fixbranchecoupon where bcode = ? and CuCode = '" + t_code.getText() + "'";
                PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                prm2.setString(1, tblfixbranch.getValueAt(intArray[i], 1).toString());
                prm2.executeUpdate();
                stmt.close();

            }

        } catch (Exception e) {
        }

        getFixBranchList(t_code.getText());
        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem10ActionPerformed

    private void jMenuItem11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem11ActionPerformed

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from fixbranchecoupon where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getFixBranchList(t_code.getText());
        } catch (Exception e) {
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem11ActionPerformed

    private void t_codeKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_codeKeyTyped

        if (t_code.getText().length() >= 8) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_codeKeyTyped

    private void t_barcodeKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_barcodeKeyTyped

        if (t_barcode.getText().length() >= 8) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_barcodeKeyTyped

    private void t_nameKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_nameKeyTyped

        if (t_name.getText().length() >= 30) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_nameKeyTyped

    private void t_date1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date1KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date2.requestFocus();
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
             DateUtil.showDateChooserDialog(t_date1, btn_Calendar);
         t_date1.requestFocus(); 
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1KeyPressed

    private void t_date2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date2KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_buymin.requestFocus();
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
           DateUtil.showDateChooserDialog(t_date2, btn_Calendar1);
        t_date2.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date2KeyPressed

    private void t_discountbathFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_discountbathFocusGained

        t_discountbath.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountbathFocusGained

    private void t_buyminFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_buyminFocusGained

        t_buymin.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_buyminFocusGained

    private void btnfindcampaignActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnfindcampaignActionPerformed
        // TODO add your handling code here:
        listCampaign dialog = new listCampaign(new NimbusFrame(), true);
        dialog.setVisible(true);
        try {
            if (!dialog.bcode.equals("")) {
                campaign_code.setText(dialog.bcode);
                campaign_code.requestFocus();
            } else {
                campaign_code.requestFocus();
            }
        } catch (Exception e) {
            campaign_code.requestFocus();
        }
    }//GEN-LAST:event_btnfindcampaignActionPerformed

    private void btnfindcampaignKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnfindcampaignKeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnfindcampaignKeyPressed

    private void tblCuponMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblCuponMouseClicked
        // TODO add your handling code here:
        int indexrow = tblCupon.getSelectedRow();
        String TempCode = tblCupon.getValueAt(indexrow, 0).toString();
        String TempCampaign = PUtility.getcampaigncode2(TempCode);
        lbcampaign.setText("เคมเปญ... " + TempCampaign + "-" + PUtility.getcampaignname(TempCampaign));
    }//GEN-LAST:event_tblCuponMouseClicked

    private void tblCuponKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tblCuponKeyPressed
        // TODO add your handling code here:
        if ((evt.getKeyCode() == KeyEvent.VK_UP) || (evt.getKeyCode() == KeyEvent.VK_DOWN)) {
            int indexrow = tblCupon.getSelectedRow();
            String TempCode = tblCupon.getValueAt(indexrow, 0).toString();
            String TempCampaign = PUtility.getcampaigncode2(TempCode);
            lbcampaign.setText("เคมเปญ... " + TempCampaign + "-" + PUtility.getcampaignname(TempCampaign));
        }
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            int indexrow = tblCupon.getSelectedRow();
            String TempCode = tblCupon.getValueAt(indexrow, 0).toString();
            t_code.setText(TempCode);
            if (!t_code.getText().trim().equals("")) {
                if (chkdata(t_code.getText())) {
                    String Code = "";
                    Code = t_code.getText().trim();
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        GetData(cvth.Unicode2ASCII(Code));
                    } else {
                        GetData(Code);
                    }
                } else {
                    setActive();
                    t_code.setBackground(new java.awt.Color(255, 246, 143));
                    t_code.setEditable(false);

                }
                tab.setEnabledAt(1, true);
            }
            campaign_code.requestFocus();

        }
    }//GEN-LAST:event_tblCuponKeyPressed

    private void campaign_codeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_campaign_codeFocusLost
        // TODO add your handling code here:
        campaign_name.setText(PUtility.getcampaignname(campaign_code.getText()));
    }//GEN-LAST:event_campaign_codeFocusLost

    private void campaign_codeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_campaign_codeKeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_name.requestFocus();
        }
    }//GEN-LAST:event_campaign_codeKeyPressed

    private void t_cntKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_cntKeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_name.requestFocus();
        }
    }//GEN-LAST:event_t_cntKeyPressed

    private void campaignlistActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_campaignlistActionPerformed
        // TODO add your handling code here:
        if (rdactive1.isSelected()) {
            showdataintb(); 
        } else {
            chkactive(Format.dateFmtSql.format(new java.util.Date()));
        }
    }//GEN-LAST:event_campaignlistActionPerformed

    private void t_cutimeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutimeFocusGained
        // TODO add your handling code here:
        t_cutime.selectAll();
    }//GEN-LAST:event_t_cutimeFocusGained

    private void t_cutimeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutimeFocusLost
        // TODO add your handling code here:
        String ArrayStr[] = t_cutime.getText().split(":");
        
        int timehr = Integer.parseInt(ArrayStr[0]);
        int timemm = Integer.parseInt(ArrayStr[1]);
            if(timehr > 24 | timemm > 60){
                JOptionPane.showMessageDialog(this, "เวลาไม่ถูกต้อง");
            }
    }//GEN-LAST:event_t_cutimeFocusLost

    private void t_cutime2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutime2FocusGained
        // TODO add your handling code here:
        t_cutime2.selectAll();
    }//GEN-LAST:event_t_cutime2FocusGained

    private void t_cutime2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutime2FocusLost
        // TODO add your handling code here:
        String ArrayStr[] = t_cutime2.getText().split(":");
        
        int timehr = Integer.parseInt(ArrayStr[0]);
        int timemm = Integer.parseInt(ArrayStr[1]);
            if(timehr > 24 | timemm > 60){
                JOptionPane.showMessageDialog(this, "เวลาไม่ถูกต้อง");
            }
    }//GEN-LAST:event_t_cutime2FocusLost

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
        t_code.requestFocus();
        // TODO add your handling code here:
    }//GEN-LAST:event_formWindowOpened

    private void t_date1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_t_date1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1ActionPerformed

    private void Head1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Head1KeyTyped
        // TODO add your handling code here:
        if (Head1.getText().length() >= 25) {
            evt.consume();
        }
    }//GEN-LAST:event_Head1KeyTyped

    private void Head2KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Head2KeyTyped
        // TODO add your handling code here:
        if (Head2.getText().length() >= 25) {
            evt.consume();
        }
    }//GEN-LAST:event_Head2KeyTyped

    private void Con1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con1KeyTyped
        // TODO add your handling code here:
        if (Con1.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con1KeyTyped

    private void Con2KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con2KeyTyped
        // TODO add your handling code here:
        if (Con2.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con2KeyTyped

    private void Con3KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con3KeyTyped
        // TODO add your handling code here:
        if (Con3.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con3KeyTyped

    private void Con4KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con4KeyTyped
        // TODO add your handling code here:
        if (Con4.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con4KeyTyped

    private void Con5KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con5KeyTyped
        // TODO add your handling code here:
        if (Con5.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con5KeyTyped

    private void Con6KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con6KeyTyped
        // TODO add your handling code here:
        if (Con6.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con6KeyTyped

    private void Con7KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con7KeyTyped
        // TODO add your handling code here:
        if (Con7.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con7KeyTyped

    private void Con8KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con8KeyTyped
        // TODO add your handling code here:
        if (Con8.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con8KeyTyped

    private void Con9KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con9KeyTyped
        // TODO add your handling code here:
        if (Con9.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con9KeyTyped

    private void Con10KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con10KeyTyped
        // TODO add your handling code here:
        if (Con10.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con10KeyTyped

    private void Con11KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con11KeyTyped
        // TODO add your handling code here:
        if (Con11.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con11KeyTyped

    private void Con12KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con12KeyTyped
        // TODO add your handling code here:
        if (Con12.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con12KeyTyped

    private void Con13KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con13KeyTyped
        // TODO add your handling code here:
        if (Con13.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con13KeyTyped

    private void Con14KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con14KeyTyped
        // TODO add your handling code here:
        if (Con14.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con14KeyTyped

    private void Con15KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con15KeyTyped
        // TODO add your handling code here:
        if (Con15.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con15KeyTyped

    private void Con16KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con16KeyTyped
        // TODO add your handling code here:
        if (Con16.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con16KeyTyped

    private void Con17KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con17KeyTyped
        // TODO add your handling code here:
        if (Con17.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con17KeyTyped

    private void Con18KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con18KeyTyped
        // TODO add your handling code here:
        if (Con18.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con18KeyTyped

    private void Con19KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con19KeyTyped
        // TODO add your handling code here:
        if (Con19.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con19KeyTyped

    private void Con20KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con20KeyTyped
        // TODO add your handling code here:
        if (Con20.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con20KeyTyped

    private void Con21KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con21KeyTyped
        // TODO add your handling code here:
        if (Con21.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con21KeyTyped

    private void Con22KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con22KeyTyped
        // TODO add your handling code here:
        if (Con22.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con22KeyTyped

    private void Con23KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con23KeyTyped
        // TODO add your handling code here:
        if (Con23.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con23KeyTyped

    private void Con24KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con24KeyTyped
        // TODO add your handling code here:
        if (Con24.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con24KeyTyped

    private void Con25KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con25KeyTyped
        // TODO add your handling code here:
        if (Con25.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con25KeyTyped

    private void Head5KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Head5KeyTyped
        // TODO add your handling code here:
        if (Head5.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Head5KeyTyped

    private void Head6KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Head6KeyTyped
        // TODO add your handling code here:
        if (Head6.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Head6KeyTyped

    private void btn_pluActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_pluActionPerformed

            btnplu();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_pluActionPerformed

    private void t_pluKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_pluKeyPressed

        String get = t_plu.getText();
        String out = get.toUpperCase();
        t_plu.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataplu(cvth.Unicode2ASCII(t_plu.getText()));
            } else {
                GetDataplu(t_plu.getText());
            }

        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnplu();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escplu();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_pluKeyPressed

    private void t_pluKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_pluKeyTyped

        if (t_plu.getText().length() >= 13) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_pluKeyTyped

    private void btnpluokActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnpluokActionPerformed

        if (!t_code.getText().trim().equals("")) {

            String plu = t_plu.getText().trim();
            int tblPluSize = 0;
            if (model2 != null) {
                tblPluSize = model2.getRowCount();
            }
            boolean isFound = false;
            if (plu.length() > 0) {
                for (int i = 0; i < tblPluSize; i++) {
                    String search = (String) model2.getValueAt(i, 1);
                    if (plu.equals(search)) {
                        PUtility.ShowMsg("รายการสินค้านี้มีการกำหนดใว้แล้ว ...");
                        t_plu.setText("");
                        t_pluname.setText("");
                        isFound = true;
                        break;
                    }
                }


                if (!isFound) {
                    String[] product = addProductToCopon(plu);
                    if (product != null) {
                        if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                            if (chkdata(t_code.getText())) {
                                if (chkplu(t_code.getText(), t_plu.getText())) {
                                    btnsave();
                                    insertCuponList(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                                } else {
                                    PUtility.ShowMsg("รหัสสินค้า" + t_plu.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                                }
                            }
                        } else {
                            if (chkdata(t_code.getText())) {
                                if (chkplu(t_code.getText(), t_plu.getText())) {
                                    btnsave();
                                    insertCuponList(t_code.getText(), plu);
                                } else {
                                    PUtility.ShowMsg("รหัสสินค้า " + t_plu.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                                }
                            }
                        }
                        getCuponList(t_code.getText());
                        t_plu.setText("");
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่พบรายการสินค้านี้");
                        t_plu.setText("");
                    }
                }
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดรหัสสินค้า..");
        }
        escplu();

        // TODO add your handling code here:
    }//GEN-LAST:event_btnpluokActionPerformed

    private void btnpluokKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnpluokKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escplu();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnpluokKeyPressed

    private void btnbranchcancle2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle2ActionPerformed

        escplu();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchcancle2ActionPerformed

    private void tblpluMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblpluMousePressed

   }//GEN-LAST:event_tblpluMousePressed

    private void t_gcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_gcodeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            btngroupok.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_gcodeKeyPressed

    private void btngroupokActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btngroupokActionPerformed

        if (!t_gcode.getText().trim().equals("")) {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการเพิ่มข้อมูลกลุ่มสินค้า " + t_gcode.getText() + " ทั้งหมดใช่หรือไม่", "Confirm", JOptionPane.YES_NO_OPTION);

            if (confirm == JOptionPane.YES_OPTION) {
                String code = t_gcode.getText().trim();
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup(cvth.Unicode2ASCII(code));
                    }
                } else {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup(code);
                    }
                }
                t_gcode.setText("");
                t_plu.requestFocus();

            }
            getCuponList(t_code.getText());
        }


    }//GEN-LAST:event_btngroupokActionPerformed

    private void btn_group3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group3ActionPerformed


        listGroupfile dialog = new listGroupfile(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_gcode.setText(dialog.code);
                btngroupok.requestFocus();
            } else {
                t_plu.requestFocus();
            }
        } catch (Exception e) {
            t_plu.requestFocus();
        }


        // TODO add your handling code here:
    }//GEN-LAST:event_btn_group3ActionPerformed

    private void btn_plu1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_plu1ActionPerformed
        // TODO add your handling code here:
        btnplu1() ;
    }//GEN-LAST:event_btn_plu1ActionPerformed

    private void t_plu1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_plu1KeyPressed
        // TODO add your handling code here:
        String get = t_plu1.getText();
        String out = get.toUpperCase();
        t_plu1.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataplu1(cvth.Unicode2ASCII(t_plu1.getText()));
            } else {
                GetDataplu1(t_plu1.getText());
            }

        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnplu1();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escplu1();
        }
    }//GEN-LAST:event_t_plu1KeyPressed

    private void t_plu1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_plu1KeyTyped
        // TODO add your handling code here:
        if (t_plu1.getText().length() >= 13) {
            evt.consume();
        }
    }//GEN-LAST:event_t_plu1KeyTyped

    private void btnpluok1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnpluok1ActionPerformed
        // TODO add your handling code here:
        if (!t_code.getText().trim().equals("")) {

            String plu = t_plu1.getText().trim();
            int tblPluSize = 0;
            if (model5 != null) {
                tblPluSize = model5.getRowCount();
            }
            boolean isFound = false;
            if (plu.length() > 0) {
                for (int i = 0; i < tblPluSize; i++) {
                    String search = (String) model5.getValueAt(i, 1);
                    if (plu.equals(search)) {
                        PUtility.ShowMsg("รายการสินค้านี้มีการกำหนดใว้แล้ว ...");
                        t_plu1.setText("");
                        t_pluname1.setText("");
                        isFound = true;
                        break;
                    }
                }

                if (!isFound) {
                    String[] product = addProductToCopon(plu);
                    if (product != null) {
                        if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                            if (chkdata(t_code.getText())) {
                                if (chkplu(t_code.getText(), t_plu1.getText())) {
                                    btnsave();
                                    insertCuponList1(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                                } else {
                                    PUtility.ShowMsg("รหัสสินค้า" + t_plu1.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                                }
                            }
                        } else {
                            if (chkdata(t_code.getText())) {
                                if (chkplu(t_code.getText(), t_plu1.getText())) {
                                    btnsave();
                                    insertCuponList1(t_code.getText(), plu);
                                } else {
                                    PUtility.ShowMsg("รหัสสินค้า " + t_plu1.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                                }
                            }
                        }
                        getCuponUnList(t_code.getText());
                        t_plu1.setText("");
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่พบรายการสินค้านี้");
                        t_plu1.setText("");
                    }
                }
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดรหัสสินค้า..");
        }
        escplu1();
    }//GEN-LAST:event_btnpluok1ActionPerformed

    private void btnpluok1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnpluok1KeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnpluok1KeyPressed

    private void btnbranchcancle3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle3ActionPerformed
        // TODO add your handling code here:
        escplu1();
    }//GEN-LAST:event_btnbranchcancle3ActionPerformed

    private void tblplu1MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblplu1MousePressed
        // TODO add your handling code here:
    }//GEN-LAST:event_tblplu1MousePressed

    private void t_gcode1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_gcode1KeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            btngroupok1.requestFocus();
        }
    }//GEN-LAST:event_t_gcode1KeyPressed

    private void btngroupok1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btngroupok1ActionPerformed
        // TODO add your handling code here:
        if (!t_gcode1.getText().trim().equals("")) {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการเพิ่มข้อมูลกลุ่มสินค้า " + t_gcode1.getText() + " ทั้งหมดใช่หรือไม่", "Confirm", JOptionPane.YES_NO_OPTION);

            if (confirm == JOptionPane.YES_OPTION) {
                String code = t_gcode1.getText().trim();
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup1(cvth.Unicode2ASCII(code));
                    }
                } else {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup1(code);
                    }
                }
                t_gcode1.setText("");
                t_plu1.requestFocus();

            }
            getCuponUnList(t_code.getText());
        }
    }//GEN-LAST:event_btngroupok1ActionPerformed

    private void btn_group4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group4ActionPerformed
        // TODO add your handling code here:
        listGroupfile dialog = new listGroupfile(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_gcode1.setText(dialog.code);
                btngroupok1.requestFocus();
            } else {
                t_plu1.requestFocus();
            }
        } catch (Exception e) {
            t_plu1.requestFocus();
        }
    }//GEN-LAST:event_btn_group4ActionPerformed

    private void jMenuItem12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem12ActionPerformed
        // TODO add your handling code here:
        try {
            int[] intArray = tblplu1.getSelectedRows();

            for (int i = 0; i < intArray.length; i++) {
                String plu2 = tblplu1.getValueAt(intArray[i], 1).toString();
                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from ecuponunlist where PCode ='" + plu2 + "' and CuCode = '" + t_code.getText() + "'";
                stmt.executeUpdate(sql2);
                stmt.close();
            }
        } catch (Exception e) {
        }
        getCuponUnList(t_code.getText());
    }//GEN-LAST:event_jMenuItem12ActionPerformed

    private void jMenuItem13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem13ActionPerformed
        // TODO add your handling code here:
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from ecuponunlist where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getCuponUnList(t_code.getText());
        } catch (Exception e) {
        }
    }//GEN-LAST:event_jMenuItem13ActionPerformed

    private void Con26KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con26KeyTyped
        // TODO add your handling code here:
        if (Con26.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con26KeyTyped

    private void Con27KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con27KeyTyped
        // TODO add your handling code here:
        if (Con27.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con27KeyTyped

    private void Con28KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con28KeyTyped
        // TODO add your handling code here:
        if (Con28.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con28KeyTyped

    private void Con29KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con29KeyTyped
        // TODO add your handling code here:
        if (Con29.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con29KeyTyped

    private void Con30KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con30KeyTyped
        // TODO add your handling code here:
        if (Con30.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con30KeyTyped

    private void Con31KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con31KeyTyped
        // TODO add your handling code here:
        if (Con31.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con31KeyTyped

    private void Con32KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con32KeyTyped
        // TODO add your handling code here:
        if (Con32.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con32KeyTyped

    private void Con33KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con33KeyTyped
        // TODO add your handling code here:
        if (Con33.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con33KeyTyped

    private void Con34KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con34KeyTyped
        // TODO add your handling code here:
        if (Con34.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con34KeyTyped

    private void Con35KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_Con35KeyTyped
        // TODO add your handling code here:
        if (Con35.getText().length() >= 50) {
            evt.consume();
        }
    }//GEN-LAST:event_Con35KeyTyped

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /*
         * Set the Nimbus look and feel
         */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /*
         * If Nimbus (introduced in Java SE 6) is not available, stay with the
         * default look and feel. For details see
         * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;




                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(eCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(eCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(eCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(eCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /*
         * Create and display the dialog
         */
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                eCouponSetup dialog = new eCouponSetup(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {

                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JTextField Con1;
    private javax.swing.JTextField Con10;
    private javax.swing.JTextField Con11;
    private javax.swing.JTextField Con12;
    private javax.swing.JTextField Con13;
    private javax.swing.JTextField Con14;
    private javax.swing.JTextField Con15;
    private javax.swing.JTextField Con16;
    private javax.swing.JTextField Con17;
    private javax.swing.JTextField Con18;
    private javax.swing.JTextField Con19;
    private javax.swing.JTextField Con2;
    private javax.swing.JTextField Con20;
    private javax.swing.JTextField Con21;
    private javax.swing.JTextField Con22;
    private javax.swing.JTextField Con23;
    private javax.swing.JTextField Con24;
    private javax.swing.JTextField Con25;
    private javax.swing.JTextField Con26;
    private javax.swing.JTextField Con27;
    private javax.swing.JTextField Con28;
    private javax.swing.JTextField Con29;
    private javax.swing.JTextField Con3;
    private javax.swing.JTextField Con30;
    private javax.swing.JTextField Con31;
    private javax.swing.JTextField Con32;
    private javax.swing.JTextField Con33;
    private javax.swing.JTextField Con34;
    private javax.swing.JTextField Con35;
    private javax.swing.JTextField Con4;
    private javax.swing.JTextField Con5;
    private javax.swing.JTextField Con6;
    private javax.swing.JTextField Con7;
    private javax.swing.JTextField Con8;
    private javax.swing.JTextField Con9;
    private javax.swing.JTextField Head1;
    private javax.swing.JTextField Head2;
    private javax.swing.JTextField Head3;
    private javax.swing.JTextField Head4;
    private javax.swing.JTextField Head5;
    private javax.swing.JTextField Head6;
    private javax.swing.JPopupMenu branch;
    private javax.swing.JButton btnCancel;
    private javax.swing.JButton btnDelete;
    private javax.swing.JButton btnNew;
    private javax.swing.JButton btnSave;
    private javax.swing.JButton btn_Calendar;
    private javax.swing.JButton btn_Calendar1;
    private javax.swing.JButton btn_group;
    private javax.swing.JButton btn_group2;
    private javax.swing.JButton btn_group3;
    private javax.swing.JButton btn_group4;
    private javax.swing.JButton btn_plu;
    private javax.swing.JButton btn_plu1;
    private javax.swing.JButton btnbranchcancle;
    private javax.swing.JButton btnbranchcancle1;
    private javax.swing.JButton btnbranchcancle2;
    private javax.swing.JButton btnbranchcancle3;
    private javax.swing.JButton btnbranchok;
    private javax.swing.JButton btnbranchok1;
    private javax.swing.JButton btnfindcampaign;
    private javax.swing.JButton btngroupok;
    private javax.swing.JButton btngroupok1;
    private javax.swing.JButton btnok5;
    private javax.swing.JButton btnpluok;
    private javax.swing.JButton btnpluok1;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.ButtonGroup buttonGroup3;
    private javax.swing.ButtonGroup buttonGroup4;
    private javax.swing.ButtonGroup buttonGroup5;
    private javax.swing.ButtonGroup buttonGroup6;
    private javax.swing.ButtonGroup buttonGroup7;
    private javax.swing.JCheckBox c1;
    private javax.swing.JCheckBox c2;
    private javax.swing.JCheckBox c3;
    private javax.swing.JCheckBox c4;
    private javax.swing.JCheckBox c5;
    private javax.swing.JCheckBox c6;
    private javax.swing.JCheckBox c7;
    private javax.swing.JTextField campaign_code;
    private javax.swing.JTextField campaign_name;
    private javax.swing.JComboBox campaignlist;
    private javax.swing.JPopupMenu fixbranch;
    private javax.swing.JCheckBox formember;
    private javax.swing.JButton jButton6;
    private javax.swing.JButton jButton7;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLayeredPane jLayeredPane1;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jMenuItem10;
    private javax.swing.JMenuItem jMenuItem11;
    private javax.swing.JMenuItem jMenuItem12;
    private javax.swing.JMenuItem jMenuItem13;
    private javax.swing.JMenuItem jMenuItem6;
    private javax.swing.JMenuItem jMenuItem7;
    private javax.swing.JMenuItem jMenuItem8;
    private javax.swing.JMenuItem jMenuItem9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel18;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel20;
    private javax.swing.JPanel jPanel21;
    private javax.swing.JPanel jPanel22;
    private javax.swing.JPanel jPanel23;
    private javax.swing.JPanel jPanel24;
    private javax.swing.JPanel jPanel25;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JPopupMenu.Separator jSeparator1;
    private javax.swing.JLabel lbcampaign;
    private javax.swing.JMenuItem menuCancel;
    private javax.swing.JMenuItem menuDelete;
    private javax.swing.JMenuItem menuExit;
    private javax.swing.JMenuItem menuNew;
    private javax.swing.JMenuItem menuSave;
    private javax.swing.JPanel paneltab2;
    private javax.swing.JPanel paneltable;
    private javax.swing.JPopupMenu plu;
    private javax.swing.JPopupMenu plu1;
    private javax.swing.JRadioButton rdactive1;
    private javax.swing.JRadioButton rdactive2;
    private javax.swing.JRadioButton rdnmulti;
    private javax.swing.JRadioButton rdymulti;
    private javax.swing.JTextField strDay;
    private javax.swing.JTextField strtype;
    private javax.swing.JTextField t_barcode;
    private javax.swing.JTextField t_bcode;
    private javax.swing.JTextField t_bname;
    private javax.swing.JFormattedTextField t_buymin;
    private javax.swing.JFormattedTextField t_cnt;
    private javax.swing.JTextField t_code;
    private javax.swing.JTextField t_code2;
    private javax.swing.JLabel t_count1;
    private javax.swing.JFormattedTextField t_cutime;
    private javax.swing.JFormattedTextField t_cutime2;
    private javax.swing.JFormattedTextField t_date1;
    private javax.swing.JFormattedTextField t_date2;
    private javax.swing.JFormattedTextField t_discountbath;
    private javax.swing.JTextField t_fixbranch;
    private javax.swing.JTextField t_fixname;
    private javax.swing.JTextField t_gcode;
    private javax.swing.JTextField t_gcode1;
    private javax.swing.JTextField t_name;
    private javax.swing.JTextField t_plu;
    private javax.swing.JTextField t_plu1;
    private javax.swing.JTextField t_pluname;
    private javax.swing.JTextField t_pluname1;
    private javax.swing.JTabbedPane tab;
    private javax.swing.JTable tblCupon;
    private javax.swing.JTable tblbranch;
    private javax.swing.JTable tblfixbranch;
    private javax.swing.JTable tblplu;
    private javax.swing.JTable tblplu1;
    private javax.swing.JCheckBox td1;
    private javax.swing.JCheckBox te1;
    private javax.swing.JCheckBox tp1;
    private javax.swing.JCheckBox tt1;
    private javax.swing.JCheckBox tw1;
    // End of variables declaration//GEN-END:variables

    public void showdataintb() {
        tblCupon.setShowGrid(true);
        tblCupon.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblCupon.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tblCupon.setRowSelectionAllowed(true);
        tblCupon.setBackground(java.awt.Color.WHITE);
        tblCupon.setGridColor(java.awt.Color.gray);

        TableColumnModel tcm = tblCupon.getColumnModel();
        DefaultTableCellRenderer d;
        JTableHeader header = tblCupon.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblCupon.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblCupon.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model = (DefaultTableModel) tblCupon.getModel();
        int cnt = model.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model.removeRow(0);
            }
        }
        // Check Selected campain
        String TempStr = "";
        if (campaignlist.getSelectedItem() == null) {
            SelectedCampain = "ALL";
        } else {
            TempStr = campaignlist.getSelectedItem().toString();
            String ArrayStr[] = TempStr.split("-");
            SelectedCampain = ArrayStr[0];
        }
        try {
            String sql = "";
            stmt = (Statement) dbUtility.con.createStatement();
            if (SelectedCampain.equals("ALL")) {
                sql = "SELECT * FROM ecupon order by CuCode";
            } else {
                sql = "SELECT * FROM ecupon where campaign_code='" + SelectedCampain + "' order by CuCode";
            }
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("CuCode")),
                                    cvth.ASCII2Unicode(rs.getString("CuBarCode")),
                                    cvth.ASCII2Unicode(rs.getString("CuName")),
                                    cvth.ASCII2Unicode(Format.dateFmtShow.format(rs.getDate("CuBegin"))) + " - " + (Format.dateFmtShow.format(rs.getDate("CuEnd"))),
                                    cvth.ASCII2Unicode(rs.getString("CuStrDay")),
                                    cvth.ASCII2Unicode(rs.getString("CuSaleType")),
                                    cvth.ASCII2Unicode(rs.getString("CuDiscBath")),
                                    cvth.ASCII2Unicode(rs.getString("CuSaleMin"))});

                    } else {
                        model.addRow(new Object[]{rs.getString("CuCode"),
                                    rs.getString("CuBarCode"),
                                    rs.getString("CuName"),
                                    rs.getDate("CuBegin").toString(),
                                    rs.getDate("CuEnd").toString(),
                                    rs.getString("CuStrDay"),
                                    rs.getString("CuSaleType"),
                                    rs.getString("CuDiscBath"),
                                    rs.getString("CuSaleMin"),});
                    }
                }
            }
            t_count1.setText(tblCupon.getRowCount() + " รายการ");
        } catch (Exception e) {
        }
    }

    public void GetData(String Code) {

        if (CheckValidEnter()) {
            try {
                String sql = "select * from ecupon where CuCode='" + Code + "'";

                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_code.setText(cvth.ASCII2Unicode(rs.getString("CuCode")));
                        t_name.setText(cvth.ASCII2Unicode(rs.getString("CuName")));

                        t_code2.setText(cvth.ASCII2Unicode(rs.getString("CuCode")) + " - " + cvth.ASCII2Unicode(rs.getString("CuName")));

                        t_barcode.setText(cvth.ASCII2Unicode(rs.getString("CuBarCode")));


                        t_date1.setText(Format.dateFmtShow.format(rs.getDate("CuBegin")));
                        t_date2.setText(Format.dateFmtShow.format(rs.getDate("CuEnd")));
                        strDay.setText(cvth.ASCII2Unicode(rs.getString("CuStrDay")));

                        c1.setSelected(false);
                        c2.setSelected(false);
                        c3.setSelected(false);
                        c4.setSelected(false);
                        c5.setSelected(false);
                        c6.setSelected(false);
                        c7.setSelected(false);

                        String cu_str = strDay.getText();
                        String[] out = cu_str.split(",");
                        for (int i = 0; i < out.length; i++) {
                            if (out[i].equals("Sun")) {
                                c1.setSelected(true);
                            }
                            if (out[i].equals("Mon")) {
                                c2.setSelected(true);
                            }
                            if (out[i].equals("Tue")) {
                                c3.setSelected(true);
                            }
                            if (out[i].equals("Wed")) {
                                c4.setSelected(true);
                            }
                            if (out[i].equals("Thu")) {
                                c5.setSelected(true);
                            }
                            if (out[i].equals("Fri")) {
                                c6.setSelected(true);
                            }
                            if (out[i].equals("Sat")) {
                                c7.setSelected(true);
                            }
                        }

                        strtype.setText(cvth.ASCII2Unicode(rs.getString("CuSaleType")));

                        te1.setSelected(false);
                        tt1.setSelected(false);
                        td1.setSelected(false);
                        tp1.setSelected(false);
                        tw1.setSelected(false);

                        String sale_str = strtype.getText();
                        String[] out2 = sale_str.split(",");
                        for (int i = 0; i < out2.length; i++) {
                            if (out2[i].equals("E")) {
                                te1.setSelected(true);
                            }
                            if (out2[i].equals("T")) {
                                tt1.setSelected(true);
                            }
                            if (out2[i].equals("D")) {
                                td1.setSelected(true);
                            }
                            if (out2[i].equals("P")) {
                                tp1.setSelected(true);
                            }
                            if (out2[i].equals("W")) {
                                tw1.setSelected(true);
                            }
                        }
                        t_discountbath.setText(cvth.ASCII2Unicode(Format.doubleFmt.format(rs.getFloat("CuDiscBath"))));
                        t_buymin.setText(cvth.ASCII2Unicode(Format.doubleFmt.format(rs.getFloat("CuSaleMin"))));

                        t_code.setBackground(new java.awt.Color(255, 246, 143));
                        t_code.setEditable(false);

                        getBranchList(cvth.Unicode2ASCII(t_code.getText()));
                        getFixBranchList(cvth.Unicode2ASCII(t_code.getText()));
                        getCuponList(t_code.getText());
                        getCuponUnList(t_code.getText());
                        campaign_code.setText(cvth.ASCII2Unicode(rs.getString("campaign_code")));
                        campaign_name.setText(PUtility.getcampaignname(campaign_code.getText()));
                        t_cnt.setValue(rs.getInt("cucnt"));
                        String TempChk = "";
                       
                        TempChk = cvth.Unicode2ASCII(rs.getString("cumultiuse"));
                        if (TempChk.equals("Y")) {
                            rdymulti.setSelected(true);
                        } else {
                            rdnmulti.setSelected(true);
                        }
                       
                        t_cutime.setText(rs.getString("cutime"));
                        t_cutime2.setText(rs.getString("cutime2"));
                        
                        Head1.setText(cvth.ASCII2Unicode(rs.getString("head1")));
                        Head2.setText(cvth.ASCII2Unicode(rs.getString("head2")));
                        Head3.setText(cvth.ASCII2Unicode(rs.getString("head3")));
                        Head4.setText(cvth.ASCII2Unicode(rs.getString("head4")));
                        Head5.setText(cvth.ASCII2Unicode(rs.getString("head5")));
                        Head6.setText(cvth.ASCII2Unicode(rs.getString("head6")));
                        
                        Con1.setText(cvth.ASCII2Unicode(rs.getString("con1")));
                        Con2.setText(cvth.ASCII2Unicode(rs.getString("con2")));
                        Con3.setText(cvth.ASCII2Unicode(rs.getString("con3")));
                        Con4.setText(cvth.ASCII2Unicode(rs.getString("con4")));
                        Con5.setText(cvth.ASCII2Unicode(rs.getString("con5")));
                        Con6.setText(cvth.ASCII2Unicode(rs.getString("con6")));
                        Con7.setText(cvth.ASCII2Unicode(rs.getString("con7")));
                        Con8.setText(cvth.ASCII2Unicode(rs.getString("con8")));
                        Con9.setText(cvth.ASCII2Unicode(rs.getString("con9")));
                        Con10.setText(cvth.ASCII2Unicode(rs.getString("con10")));
                        Con11.setText(cvth.ASCII2Unicode(rs.getString("con11")));
                        Con12.setText(cvth.ASCII2Unicode(rs.getString("con12")));
                        Con13.setText(cvth.ASCII2Unicode(rs.getString("con13")));
                        Con14.setText(cvth.ASCII2Unicode(rs.getString("con14")));
                        Con15.setText(cvth.ASCII2Unicode(rs.getString("con15")));
                        Con16.setText(cvth.ASCII2Unicode(rs.getString("con16")));
                        Con17.setText(cvth.ASCII2Unicode(rs.getString("con17")));
                        Con18.setText(cvth.ASCII2Unicode(rs.getString("con18")));
                        Con19.setText(cvth.ASCII2Unicode(rs.getString("con19")));
                        Con20.setText(cvth.ASCII2Unicode(rs.getString("con20")));
                        Con21.setText(cvth.ASCII2Unicode(rs.getString("con21")));
                        Con22.setText(cvth.ASCII2Unicode(rs.getString("con22")));
                        Con23.setText(cvth.ASCII2Unicode(rs.getString("con23")));
                        Con24.setText(cvth.ASCII2Unicode(rs.getString("con24")));
                        Con25.setText(cvth.ASCII2Unicode(rs.getString("con25")));
                        Con26.setText(cvth.ASCII2Unicode(rs.getString("con26")));
                        Con27.setText(cvth.ASCII2Unicode(rs.getString("con27")));
                        Con28.setText(cvth.ASCII2Unicode(rs.getString("con28")));
                        Con29.setText(cvth.ASCII2Unicode(rs.getString("con29")));
                        Con30.setText(cvth.ASCII2Unicode(rs.getString("con30")));
                        Con31.setText(cvth.ASCII2Unicode(rs.getString("con31")));
                        Con32.setText(cvth.ASCII2Unicode(rs.getString("con32")));
                        Con33.setText(cvth.ASCII2Unicode(rs.getString("con33")));
                        Con34.setText(cvth.ASCII2Unicode(rs.getString("con34")));
                        Con35.setText(cvth.ASCII2Unicode(rs.getString("con35")));
                        if (cvth.ASCII2Unicode(rs.getString("formember")).equals("Y")) {
                           formember.setSelected(true); 
                        } else {
                            formember.setSelected(false);
                        }
                    } else {

                        t_code.setText(rs.getString("CuCode"));
                        t_name.setText(rs.getString("CuName"));
                        t_barcode.setText(rs.getString("CuBarCode"));
                        t_date1.setText(Format.dateFmtShow.format(rs.getDate("CuBegin")));
                        t_date2.setText(Format.dateFmtShow.format(rs.getDate("CuEnd")));
                        strDay.setText(rs.getString("CuStrDay"));

                        c1.setSelected(false);
                        c2.setSelected(false);
                        c3.setSelected(false);
                        c4.setSelected(false);
                        c5.setSelected(false);
                        c6.setSelected(false);
                        c7.setSelected(false);

                        String cu_str = strDay.getText();
                        String[] out = cu_str.split(",");
                        for (int i = 0; i < out.length; i++) {
                            if (out[i].equals("Sun")) {
                                c1.setSelected(true);
                            }
                            if (out[i].equals("Mon")) {
                                c2.setSelected(true);
                            }
                            if (out[i].equals("Tue")) {
                                c3.setSelected(true);
                            }
                            if (out[i].equals("Wed")) {
                                c4.setSelected(true);
                            }
                            if (out[i].equals("Thu")) {
                                c5.setSelected(true);
                            }
                            if (out[i].equals("Fri")) {
                                c6.setSelected(true);
                            }
                            if (out[i].equals("Sat")) {
                                c7.setSelected(true);
                            }
                        }

                        strtype.setText(rs.getString("CuType"));

                        te1.setSelected(false);
                        tt1.setSelected(false);
                        td1.setSelected(false);
                        tp1.setSelected(false);
                        tw1.setSelected(false);

                        String sale_str = strtype.getText();
                        String[] out2 = sale_str.split(",");
                        for (int i = 0; i < out2.length; i++) {
                            if (out2[i].equals("E")) {
                                te1.setSelected(true);
                            }
                            if (out2[i].equals("T")) {
                                tt1.setSelected(true);
                            }
                            if (out2[i].equals("D")) {
                                td1.setSelected(true);
                            }
                            if (out2[i].equals("P")) {
                                tp1.setSelected(true);
                            }
                            if (out2[i].equals("W")) {
                                tw1.setSelected(true);
                            }
                        }

                        
                      
                        t_discountbath.setText(Format.doubleFmt.format(rs.getFloat("CuDiscBath")));
                        t_buymin.setText(Format.doubleFmt.format(rs.getFloat("CuSaleMin")));
                        t_code.setBackground(new java.awt.Color(255, 246, 143));
                        t_code.setEditable(false);

                        getBranchList(t_code.getText());
                        getFixBranchList(t_code.getText());
                        getCuponList(t_code.getText());
                        getCuponUnList(t_code.getText());
                        campaign_code.setText(rs.getString("campaign_code"));
                        campaign_name.setText(PUtility.getcampaignname(campaign_code.getText()));
                        t_cnt.setValue(rs.getInt("cucnt"));
                        String TempChk = "";
                        
                        TempChk = rs.getString("cumultiuse");
                        if (TempChk.equals("Y")) {
                            rdymulti.setSelected(true);
                        } else {
                            rdnmulti.setSelected(true);
                        }
                        
                        t_cutime.setText(rs.getString("cutime"));
                        t_cutime2.setText(rs.getString("cutime2"));
                        
                        Head1.setText(rs.getString("head1"));
                        Head2.setText(rs.getString("head2"));
                        Head3.setText(rs.getString("head3"));
                        Head4.setText(rs.getString("head4"));
                        Head5.setText(rs.getString("head5"));
                        Head6.setText(rs.getString("head6"));
                        
                        Con1.setText(rs.getString("con1"));
                        Con2.setText(rs.getString("con2"));
                        Con3.setText(rs.getString("con3"));
                        Con4.setText(rs.getString("con4"));
                        Con5.setText(rs.getString("con5"));
                        Con6.setText(rs.getString("con6"));
                        Con7.setText(rs.getString("con7"));
                        Con8.setText(rs.getString("con8"));
                        Con9.setText(rs.getString("con9"));
                        Con10.setText(rs.getString("con10"));
                        Con11.setText(rs.getString("con11"));
                        Con12.setText(rs.getString("con12"));
                        Con13.setText(rs.getString("con13"));
                        Con14.setText(rs.getString("con14"));
                        Con15.setText(rs.getString("con15"));
                        Con16.setText(rs.getString("con16"));
                        Con17.setText(rs.getString("con17"));
                        Con18.setText(rs.getString("con18"));
                        Con19.setText(rs.getString("con19"));
                        Con20.setText(rs.getString("con20"));
                        Con21.setText(rs.getString("con21"));
                        Con22.setText(rs.getString("con22"));
                        Con23.setText(rs.getString("con23"));
                        Con24.setText(rs.getString("con24"));
                        Con25.setText(rs.getString("con25"));
                        Con26.setText(rs.getString("con26"));
                        Con27.setText(rs.getString("con27"));
                        Con28.setText(rs.getString("con28"));
                        Con29.setText(rs.getString("con29"));
                        Con30.setText(rs.getString("con30"));
                        Con31.setText(rs.getString("con31"));
                        Con32.setText(rs.getString("con32"));
                        Con33.setText(rs.getString("con33"));
                        Con34.setText(rs.getString("con34"));
                        Con35.setText(rs.getString("con35"));
                        if (rs.getString("formember").equals("Y")) {
                           formember.setSelected(true); 
                        } else {
                            formember.setSelected(false);
                        }
                    }
                } else {
                    campaign_code.requestFocus();
                }
                rs.close();
                stmt.close();

            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
        setActive();
    }

    public void GetDataBranch(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from branchgroup where BGroupCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_bcode.setText(cvth.ASCII2Unicode(rs.getString("BGroupCode")));
                        t_bname.setText(cvth.ASCII2Unicode(rs.getString("BGroupName")));

                    } else {
                        t_bcode.setText(rs.getString("BGroupCode"));
                        t_bname.setText(rs.getString("BGroupName"));
                    }
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลกลุ่มสาขา");
                    t_bcode.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    

    public void GetDataFixBranch(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from branfile where Code='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_fixbranch.setText(cvth.ASCII2Unicode(rs.getString("Code")));
                        t_fixname.setText(cvth.ASCII2Unicode(rs.getString("Name")));

                    } else {
                        t_fixbranch.setText(rs.getString("Code"));
                        t_fixname.setText(rs.getString("Name"));
                    }
                    btnbranchok1.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลกลุ่มสาขา");
                    t_fixbranch.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public void btnsavebranch() {

        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into eculink (BGroup,CuCode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_bcode.getText().trim()));
                prm.setString(2, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into eculink (BGroup,CuCode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, t_bcode.getText().trim());
                prm.setString(2, t_code.getText());
                prm.executeUpdate();
            }
            t_bcode.setText("");
            t_bname.setText("");
            stmt.close();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Insert Branch Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public void btnsavefixbranch() {

        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixbranchecoupon (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_fixbranch.getText().trim()));
                prm.setString(2, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixbranchecoupon (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, t_fixbranch.getText().trim());
                prm.setString(2, t_code.getText());
                prm.executeUpdate();
            }
            stmt.close();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Insert FixBranch Error", JOptionPane.ERROR_MESSAGE);
        }


    }

    

    public void getProductGroup(String group) {
        if (chkdata(t_code.getText())) {
            btnsave();
        }
        ResultSet rs;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                group = cvth.Unicode2ASCII(group);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup FROM product "
                    + "left join blink on blink.pcode=product.pcode "
                    + "left join eculink on eculink.bgroup=blink.bgroup "
                    + "where pgroup = '" + group + "' and cucode='" + t_code.getText() + "' and pactive='Y' "
                    + " order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                String plu = rs.getString("pcode");
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    if (chkdata(t_code.getText())) {
                        if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                            insertCuponList(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                        }
                    }
                } else {
                    if (chkdata(t_code.getText())) {
                        if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                            insertCuponList(t_code.getText(), plu);
                        }
                    }
                }

            }
        } catch (Exception e) {
            PUtility.ShowMsg(e.getMessage());
        }
        getCuponList(t_code.getText());
    }
     public void getProductGroup1(String group) {
        if (chkdata(t_code.getText())) {
            btnsave();
        }
        ResultSet rs;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                group = cvth.Unicode2ASCII(group);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup FROM product "
                    + "left join blink on blink.pcode=product.pcode "
                    + "left join eculink on eculink.bgroup=blink.bgroup "
                    + "where pgroup = '" + group + "' and cucode='" + t_code.getText() + "' and pactive='Y' "
                    + " order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                String plu = rs.getString("pcode");
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    if (chkdata(t_code.getText())) {
                        if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                            insertCuponList1(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                        }
                    }
                } else {
                    if (chkdata(t_code.getText())) {
                        if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                            insertCuponList1(t_code.getText(), plu);
                        }
                    }
                }

            }
        } catch (Exception e) {
            PUtility.ShowMsg(e.getMessage());
        }
        getCuponUnList(t_code.getText());
    }

    public void getBranchgroup() {

        stmt = null;
        ResultSet rs = null;
        model3 = (DefaultTableModel) tblbranch.getModel();
        int cnt = model3.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model3.removeRow(0);
            }
        }
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT * FROM branchgroup order by bgroupcode;";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model3.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("bgroupcode")),
                                    cvth.ASCII2Unicode(rs.getString("bgroupname"))});

                    } else {
                        model3.addRow(new Object[]{rs.getString("bgroupcode"),
                                    rs.getString("bgroupname")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public boolean chkdatabranchgroup(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branchgroup where bgroupcode ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branchgroup where bgroupcode ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public void getBranchList(String cupon) {

        tblbranch.setShowGrid(true);
        tblbranch.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblbranch.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblbranch.setRowSelectionAllowed(true);
        tblbranch.setBackground(java.awt.Color.WHITE);
        tblbranch.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblbranch.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblbranch.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblbranch.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model3 = (DefaultTableModel) tblbranch.getModel();
        int cnt = model3.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model3.removeRow(0);
            }
        }
        try {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                cupon = cvth.Unicode2ASCII(cupon);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT eculink.CuCode,eculink.BGroup,eculink.FixBranch,branchgroup.BGroupName  "
                    + "FROM eculink INNER JOIN ecupon ON eculink.CuCode = ecupon.CuCode "
                    + "JOIN branchgroup ON branchgroup.BGroupCode = eculink.BGroup "
                    + "where eculink.CuCode = '" + cupon + "' order by eculink.BGroup;";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model3.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("eculink.BGroup")),
                                    cvth.ASCII2Unicode(rs.getString("branchgroup.BGroupName"))});




                    } else {
                        model3.addRow(new Object[]{rs.getString("eculink.BGroup"),
                                    rs.getString("branchgroup.BGroupName")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public void getFixBranchList(String cupon) {

        tblfixbranch.setShowGrid(true);
        tblfixbranch.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblfixbranch.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblfixbranch.setRowSelectionAllowed(true);
        tblfixbranch.setBackground(java.awt.Color.WHITE);
        tblfixbranch.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblfixbranch.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblfixbranch.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblfixbranch.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model4 = (DefaultTableModel) tblfixbranch.getModel();
        int cnt = model4.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model4.removeRow(0);
            }
        }
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                cupon = cvth.Unicode2ASCII(cupon);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT fixbranchecoupon.cucode,fixbranchecoupon.bcode,branfile.Name,branfile.bgroup  "
                    + "FROM fixbranchecoupon INNER JOIN ecupon ON fixbranchecoupon.cucode = ecupon.cucode "
                    + "JOIN branfile ON branfile.Code = fixbranchecoupon.bcode "
                    + "where fixbranchecoupon.cucode = '" + cupon + "' order by branfile.bgroup,branfile.code";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model4.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("branfile.bgroup")),
                                    cvth.ASCII2Unicode(rs.getString("fixbranchecoupon.bcode")),
                                    cvth.ASCII2Unicode(rs.getString("branfile.Name"))});




                    } else {
                        model4.addRow(new Object[]{rs.getString("fixbranchecoupon.bcode"),
                                    rs.getString("branfile.Name")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public boolean CheckValidEnter() {
        boolean RetVal2 = true;

        if (t_code.getText().length() > 6) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสคูปองไม่ถูกต้อง...(ตัองมีขนาดไม่เกิน 6 ตัวอักษร)");
            RetVal2 = false;
            t_code.requestFocus();
        }
        return RetVal2;
    }

    public boolean CheckValidEnterBranch() {
        boolean RetVal2 = true;

        if (t_bcode.getText().length() > 3) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสกลุ่มสาขาไม่ถูกต้อง...(ตัองมีขนาดไม่เกิน 3 ตัวอักษร)");
            RetVal2 = false;
            t_bcode.requestFocus();
        }
        return RetVal2;
    }

    private void clearModel1() {
        int size = tblCupon.getRowCount();
        for (int i = 0; i < size; i++) {
            model.removeRow(0);
        }
    }

    

    private void clearModel3() {
        int size = tblbranch.getRowCount();
        for (int i = 0; i < size; i++) {
            model3.removeRow(0);
        }
    }

    private void clearModel4() {
        int size = tblfixbranch.getRowCount();
        for (int i = 0; i < size; i++) {
            model4.removeRow(0);
        }
    }

    public void chkactive(String date) {
        clearModel1();
        // Check Selected campain
        String TempStr = "";
        if (campaignlist.getSelectedItem() == null) {
            SelectedCampain = "ALL";
        } else {
            TempStr = campaignlist.getSelectedItem().toString();
            String ArrayStr[] = TempStr.split("-");
            SelectedCampain = ArrayStr[0];
        }
        try {
            String sql = "";
            if (SelectedCampain.equals("ALL")) {
                sql = "select * "
                        + "from ecupon "
                        + "where ('" + date + "' >= CuBegin and '" + date + "' <= CuEnd ) order by CuCode";
            } else {
                sql = "select * "
                        + "from ecupon "
                        + "where ('" + date + "' >= CuBegin) and ('" + date + "' <= CuEnd ) and (campaign_code='" + SelectedCampain + "') order by CuCode";
            }
            stmt = (Statement) dbUtility.con.createStatement();
            ResultSet rs = stmt.executeQuery(sql);

            while (rs.next()) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("CuCode")),
                                    cvth.ASCII2Unicode(rs.getString("CuBarCode")),
                                    cvth.ASCII2Unicode(rs.getString("CuName")),
                                    cvth.ASCII2Unicode(Format.dateFmtShow.format(rs.getDate("CuBegin"))) + " - " + (Format.dateFmtShow.format(rs.getDate("CuEnd"))),
                                    cvth.ASCII2Unicode(rs.getString("CuStrDay")),
                                    cvth.ASCII2Unicode(rs.getString("CuSaleType")),
                                    cvth.ASCII2Unicode(rs.getString("CuDiscBath")),
                                    cvth.ASCII2Unicode(rs.getString("CuSaleMin"))});

                    } else {
                        model.addRow(new Object[]{rs.getString("CuCode"),
                                    rs.getString("CuBarCode"),
                                    rs.getString("CuName"),
                                    rs.getDate("CuBegin").toString(),
                                    rs.getDate("CuEnd").toString(),
                                    rs.getString("CuStrDay"),
                                    rs.getString("CuSaleType"),
                                    rs.getString("CuDiscBath"),
                                    rs.getString("CuSaleMin"),});
                    }
//                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
//                    model.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("CuCode")),
//                                cvth.ASCII2Unicode(rs.getString("CuBarCode")),
//                                cvth.ASCII2Unicode(rs.getString("CuName")),
//                                cvth.ASCII2Unicode(rs.getDate("CuBegin").toString()),
//                                cvth.ASCII2Unicode(rs.getDate("CuEnd").toString()),
//                                cvth.ASCII2Unicode(rs.getString("CuStrDay")),
//                                cvth.ASCII2Unicode(rs.getString("CuType")),
//                                cvth.ASCII2Unicode(rs.getString("CuDisc")),
//                                cvth.ASCII2Unicode(rs.getString("CuDiscBath")),
//                                cvth.ASCII2Unicode(rs.getString("ChkMember")),
//                                cvth.ASCII2Unicode(rs.getString("reduleDiscount")),
//                                cvth.ASCII2Unicode(rs.getString("reduleService"))});
//                } else {
//                    model.addRow(new Object[]{rs.getString("CuCode"),
//                                rs.getString("CuBarCode"),
//                                rs.getString("CuName"),
//                                rs.getDate("CuBegin").toString(),
//                                rs.getDate("CuEnd").toString(),
//                                rs.getString("CuStrDay"),
//                                rs.getString("CuType"),
//                                rs.getString("CuDisc"),
//                                rs.getString("CuDiscBath"),
//                                rs.getString("ChkMember"),
//                                rs.getString("reduleDiscount"),
//                                rs.getString("reduleService")});
//                }
            }
            rs.close();
            stmt.close();
            t_count1.setText(tblCupon.getRowCount() + " รายการ");

        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(this, e);
        }
    }

    public String getFixBranch() {
        String TFix = "";
        try {
            String sql = "select *from fixbranchecoupon where (cucode='" + t_code.getText() + "')  order by bcode ";
            stmt = (Statement) dbUtility.con.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            int currec = 0;
            while (rs.next()) {
                currec++;
                if (currec <= 60) {
                    TFix = TFix + "," + rs.getString("bcode");
                }
            }
            rs.close();
            stmt.close();
            t_count1.setText(tblCupon.getRowCount() + " รายการ");

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e);
        }
        return TFix;
    }

    public void SaveFixBranch() {
        String FixBranch = getFixBranch();
        try {

            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "update eculink  set fixbranch = '"+FixBranch+"' where CuCode = '" + t_code.getText() + "'";
            stmt.executeUpdate(sql2);
            stmt.close();


        } catch (Exception e) {
        }

    }

    public void btnsave() {
        java.util.Date time1;
        java.util.Date time2;
        String date1 = "";
        String date2 = "";
        try {
            time1 = Format.dateFmtShow.parse(t_date1.getText());
            date1 = Format.dateFmtSql.format(time1);
            time2 = Format.dateFmtShow.parse(t_date2.getText());
            date2 = Format.dateFmtSql.format(time2);
        } catch (Exception ex) {
            date1 = "1900-01-01";
            date2 = "1900-01-01";
        }
        String formem = "";
        if (formember.isSelected()) {
            formem = "Y" ;
        } else {
            formem = "N" ;
        }
        if (CheckValidSave()) {
            if (chkdata(t_code.getText())) {
                try {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Update ecupon set CuName=?,CuBarCode=?,CuBegin=?,CuEnd=?"
                                + ",CuStrDay=?,CuSaleType=? "
                                + ",CuDiscBath=?,CuSaleMin=?,campaign_code=?,cucnt=?,cumultiuse=?,cutime=?,cutime2=?"
                                + ",head1=?,head2=?,head3=?,head4=?,head5=?,head6=?"
                                + ",con1=?,con2=?,con3=?,con4=?,con5=?,con6=?,con7=?,con8=?,con9=?,con10=?"
                                + ",con11=?,con12=?,con13=?,con14=?,con15=?,con16=?,con17=?,con18=?,con19=?,con20=?"
                                + ",con21=?,con22=?,con23=?,con24=?,con25=? "
                                + ",con26=?,con27=?,con28=?,con29=?,con30=?"
                                + ",con31=?,con32=?,con33=?,con34=?,con35=?,formember=?"
                                + " where CuCode = ?";
                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(1, cvth.Unicode2ASCII(t_name.getText()));
                        prm.setString(2, cvth.Unicode2ASCII(t_barcode.getText()));
                        prm.setString(3, cvth.Unicode2ASCII(date1));
                        prm.setString(4, cvth.Unicode2ASCII(date2));
                        prm.setString(5, cvth.Unicode2ASCII(strDay.getText()));
                        prm.setString(6, cvth.Unicode2ASCII(strtype.getText()));
                        
                        prm.setDouble(7, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(8, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(9, cvth.Unicode2ASCII(campaign_code.getText()));
                        prm.setInt(10, Integer.parseInt(t_cnt.getText()));
                        
                        if (rdymulti.isSelected()) {
                            prm.setString(11, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(11, cvth.Unicode2ASCII("N"));
                        }
                        prm.setString(12, cvth.Unicode2ASCII(t_cutime.getText().trim()));
                        prm.setString(13, cvth.Unicode2ASCII(t_cutime2.getText().trim()));
                        prm.setString(14, cvth.Unicode2ASCII(Head1.getText()));
                        prm.setString(15, cvth.Unicode2ASCII(Head2.getText()));
                        prm.setString(16, cvth.Unicode2ASCII(Head3.getText()));
                        prm.setString(17, cvth.Unicode2ASCII(Head4.getText()));
                        prm.setString(18, cvth.Unicode2ASCII(Head5.getText()));
                        prm.setString(19, cvth.Unicode2ASCII(Head6.getText()));
                        prm.setString(20, cvth.Unicode2ASCII(Con1.getText()));
                        prm.setString(21, cvth.Unicode2ASCII(Con2.getText()));
                        prm.setString(22, cvth.Unicode2ASCII(Con3.getText()));
                        prm.setString(23, cvth.Unicode2ASCII(Con4.getText()));
                        prm.setString(24, cvth.Unicode2ASCII(Con5.getText()));
                        prm.setString(25, cvth.Unicode2ASCII(Con6.getText()));
                        prm.setString(26, cvth.Unicode2ASCII(Con7.getText()));
                        prm.setString(27, cvth.Unicode2ASCII(Con8.getText()));
                        prm.setString(28, cvth.Unicode2ASCII(Con9.getText()));
                        prm.setString(29, cvth.Unicode2ASCII(Con10.getText()));
                        prm.setString(30, cvth.Unicode2ASCII(Con11.getText()));
                        prm.setString(31, cvth.Unicode2ASCII(Con12.getText()));
                        prm.setString(32, cvth.Unicode2ASCII(Con13.getText()));
                        prm.setString(33, cvth.Unicode2ASCII(Con14.getText()));
                        prm.setString(34, cvth.Unicode2ASCII(Con15.getText()));
                        prm.setString(35, cvth.Unicode2ASCII(Con16.getText()));
                        prm.setString(36, cvth.Unicode2ASCII(Con17.getText()));
                        prm.setString(37, cvth.Unicode2ASCII(Con18.getText()));
                        prm.setString(38, cvth.Unicode2ASCII(Con19.getText()));
                        prm.setString(39, cvth.Unicode2ASCII(Con20.getText()));
                        
                        prm.setString(40, cvth.Unicode2ASCII(Con21.getText()));
                        prm.setString(41, cvth.Unicode2ASCII(Con22.getText()));
                        prm.setString(42, cvth.Unicode2ASCII(Con23.getText()));
                        prm.setString(43, cvth.Unicode2ASCII(Con24.getText()));
                        prm.setString(44, cvth.Unicode2ASCII(Con25.getText()));
                        
                        prm.setString(45, cvth.Unicode2ASCII(Con26.getText()));
                        prm.setString(46, cvth.Unicode2ASCII(Con27.getText()));
                        prm.setString(47, cvth.Unicode2ASCII(Con28.getText()));
                        prm.setString(48, cvth.Unicode2ASCII(Con29.getText()));
                        prm.setString(49, cvth.Unicode2ASCII(Con30.getText()));
                        
                        prm.setString(50, cvth.Unicode2ASCII(Con31.getText()));
                        prm.setString(51, cvth.Unicode2ASCII(Con32.getText()));
                        prm.setString(52, cvth.Unicode2ASCII(Con33.getText()));
                        prm.setString(53, cvth.Unicode2ASCII(Con34.getText()));
                        prm.setString(54, cvth.Unicode2ASCII(Con35.getText()));
                        prm.setString(55, cvth.Unicode2ASCII(formem));
                        prm.setString(56, cvth.Unicode2ASCII(t_code.getText()));
                        

                        prm.executeUpdate();
                    } else {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Update ecupon set CuName=?,CuBarCode=?,CuBegin=?,CuEnd=?"
                                + ",CuStrDay=?,CuSaleType=? "
                                + ",CuDiscBath=?,CuSaleMin=?,campaign_code=?,cucnt=?,cumultiuse=?,cutime=?,cutime2=?"
                                + ",head1=?,head2=?,head3=?,head4=?,head5=?,head6=?"
                                + ",con1=?,con2=?,con3=?,con4=?,con5=?,con6=?,con7=?,con8=?,con9=?,con10=?"
                                + ",con11=?,con12=?,con13=?,con14=?,con15=?,con16=?,con17=?,con18=?,con19=?,con20=?"
                                + ",con21=?,con22=?,con23=?,con24=?,con25=?"
                                + ",con26=?,con27=?,con28=?,con29=?,con30=?"
                                + ",con31=?,con32=?,con33=?,con34=?,con35=?,formember=? "
                                + " where CuCode = ?";
                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                       
                        prm.setString(1, t_name.getText());
                        prm.setString(2, t_barcode.getText());
                        prm.setString(3, date1);
                        prm.setString(4, date2);
                        prm.setString(5, strDay.getText());
                        prm.setString(6, strtype.getText());
                        prm.setDouble(7, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(8, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(9, campaign_code.getText());
                        prm.setInt(10, Integer.parseInt(t_cnt.getValue().toString()));
                        
                        if (rdymulti.isSelected()) {
                            prm.setString(11, "Y");
                        } else {
                            prm.setString(11, "N");
                        }
                        prm.setString(12, t_cutime.getText().trim());
                        prm.setString(13, t_cutime2.getText().trim());
                        prm.setString(14, Head1.getText());
                        prm.setString(15, Head2.getText());
                        prm.setString(16, Head3.getText());
                        prm.setString(17, Head4.getText());
                        prm.setString(18, Head5.getText());
                        prm.setString(19, Head6.getText());
                        prm.setString(20, Con1.getText());
                        prm.setString(21, Con2.getText());
                        prm.setString(22, Con3.getText());
                        prm.setString(23, Con4.getText());
                        prm.setString(24, Con5.getText());
                        prm.setString(25, Con6.getText());
                        prm.setString(26, Con7.getText());
                        prm.setString(27, Con8.getText());
                        prm.setString(28, Con9.getText());
                        prm.setString(29, Con10.getText());
                        prm.setString(30, Con11.getText());
                        prm.setString(31, Con12.getText());
                        prm.setString(32, Con13.getText());
                        prm.setString(33, Con14.getText());
                        prm.setString(34, Con15.getText());
                        prm.setString(35, Con16.getText());
                        prm.setString(36, Con17.getText());
                        prm.setString(37, Con18.getText());
                        prm.setString(38, Con19.getText());
                        prm.setString(39, Con20.getText());
                        
                        prm.setString(40, Con21.getText());
                        prm.setString(41, Con22.getText());
                        prm.setString(42, Con23.getText());
                        prm.setString(43, Con24.getText());
                        prm.setString(44, Con25.getText());
                        
                        prm.setString(45, Con26.getText());
                        prm.setString(46, Con27.getText());
                        prm.setString(47, Con28.getText());
                        prm.setString(48, Con29.getText());
                        prm.setString(49, Con30.getText());
                        
                        prm.setString(50, Con31.getText());
                        prm.setString(51, Con32.getText());
                        prm.setString(52, Con33.getText());
                        prm.setString(53, Con34.getText());
                        prm.setString(54, Con35.getText());
                        prm.setString(55, formem);
                        prm.setString(56, t_code.getText());
                        
                        prm.executeUpdate();
                    }
                    stmt.close();
                } catch (Exception e) {
                    JOptionPane.showMessageDialog(this, e.getMessage(), "Save Error...", JOptionPane.ERROR_MESSAGE);
                }
            } else {
                try {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Insert into ecupon (CuCode,CuName,CuBarCode,CuBegin,CuEnd"
                                + ",CuStrDay,CuSaleType,CuDiscBath,CuSaleMin"
                                + ",campaign_code,cucnt,cumultiuse,cutime,cutime2"
                                + ",head1,head2,head3,head4,head5,head6,con1,con2,con3,con4,con5,con6,con7,con8,con9,con10"
                                + ",con11,con12,con13,con14,con15,con16,con17,con18,con19,con20,con21,con22,con23,con24,con25"
                                + ",con26,con27,con28,con29,con30,con31,con32,con33,con34,con35,formember)"
                                + " values(?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?, ?,?,?,?,?,?,?,?,?,? ,?)";
                        
                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(1, cvth.Unicode2ASCII(t_code.getText().trim()));
                        prm.setString(2, cvth.Unicode2ASCII(t_name.getText()));
                        prm.setString(3, cvth.Unicode2ASCII(t_barcode.getText()));
                        prm.setString(4, cvth.Unicode2ASCII(date1));
                        prm.setString(5, cvth.Unicode2ASCII(date2));
                        prm.setString(6, cvth.Unicode2ASCII(strDay.getText()));
                        prm.setString(7, cvth.Unicode2ASCII(strtype.getText()));
                        prm.setDouble(8, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(9, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(10, cvth.Unicode2ASCII(campaign_code.getText()));
                        prm.setInt(11, Integer.parseInt(t_cnt.getValue().toString()));
                        
                        if (rdymulti.isSelected()) {
                            prm.setString(12, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(12, cvth.Unicode2ASCII("N"));
                        }
                      
                        prm.setString(13, cvth.Unicode2ASCII(t_cutime.getText().trim()));
                        
                        prm.setString(14, cvth.Unicode2ASCII(t_cutime2.getText().trim()));
                        prm.setString(15, cvth.Unicode2ASCII(Head1.getText()));
                        prm.setString(16, cvth.Unicode2ASCII(Head2.getText()));
                        prm.setString(17, cvth.Unicode2ASCII(Head3.getText()));
                        prm.setString(18, cvth.Unicode2ASCII(Head4.getText()));
                        prm.setString(19, cvth.Unicode2ASCII(Head5.getText()));
                        prm.setString(20, cvth.Unicode2ASCII(Head6.getText()));
                        prm.setString(21, cvth.Unicode2ASCII(Con1.getText()));
                        prm.setString(22, cvth.Unicode2ASCII(Con2.getText()));
                        prm.setString(23, cvth.Unicode2ASCII(Con3.getText()));
                        prm.setString(24, cvth.Unicode2ASCII(Con4.getText()));
                        prm.setString(25, cvth.Unicode2ASCII(Con5.getText()));
                        prm.setString(26, cvth.Unicode2ASCII(Con6.getText()));
                        prm.setString(27, cvth.Unicode2ASCII(Con7.getText()));
                        prm.setString(28, cvth.Unicode2ASCII(Con8.getText()));
                        prm.setString(29, cvth.Unicode2ASCII(Con9.getText()));
                        prm.setString(30, cvth.Unicode2ASCII(Con10.getText()));
                        prm.setString(31, cvth.Unicode2ASCII(Con11.getText()));
                        prm.setString(32, cvth.Unicode2ASCII(Con12.getText()));
                        prm.setString(33, cvth.Unicode2ASCII(Con13.getText()));
                        prm.setString(34, cvth.Unicode2ASCII(Con14.getText()));
                        prm.setString(35, cvth.Unicode2ASCII(Con15.getText()));
                        prm.setString(36, cvth.Unicode2ASCII(Con16.getText()));
                        prm.setString(37, cvth.Unicode2ASCII(Con17.getText()));
                        prm.setString(38, cvth.Unicode2ASCII(Con18.getText()));
                        prm.setString(39, cvth.Unicode2ASCII(Con19.getText()));
                        prm.setString(40, cvth.Unicode2ASCII(Con20.getText()));
                        
                        prm.setString(41, cvth.Unicode2ASCII(Con21.getText()));
                        prm.setString(42, cvth.Unicode2ASCII(Con22.getText()));
                        prm.setString(43, cvth.Unicode2ASCII(Con23.getText()));
                        prm.setString(44, cvth.Unicode2ASCII(Con24.getText()));
                        prm.setString(45, cvth.Unicode2ASCII(Con25.getText()));
                        
                        prm.setString(46, cvth.Unicode2ASCII(Con26.getText()));
                        prm.setString(47, cvth.Unicode2ASCII(Con27.getText()));
                        prm.setString(48, cvth.Unicode2ASCII(Con28.getText()));
                        prm.setString(49, cvth.Unicode2ASCII(Con29.getText()));
                        prm.setString(50, cvth.Unicode2ASCII(Con30.getText()));
                        
                        prm.setString(51, cvth.Unicode2ASCII(Con31.getText()));
                        prm.setString(52, cvth.Unicode2ASCII(Con32.getText()));
                        prm.setString(53, cvth.Unicode2ASCII(Con33.getText()));
                        prm.setString(54, cvth.Unicode2ASCII(Con34.getText()));
                        prm.setString(55, cvth.Unicode2ASCII(Con35.getText()));
                        prm.setString(56, cvth.Unicode2ASCII(formem));
                        prm.executeUpdate();
                        
                       
                    } else {
                        
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Insert into ecupon (CuCode,CuName,CuBarCode,CuBegin,CuEnd"
                                + ",CuStrDay,CuSaleType,CuDiscBath,CuSaleMin"
                                + ",campaign_code,cucnt,cumultiuse,cutime,cutime2"
                                + ",head1,head2,head3,head4,head5,head6,con1,con2,con3,con4,con5,con6,con7,con8,con9,con10"
                                + ",con11,con12,con13,con14,con15,con16,con17,con18,con19,con20,con21,con22,con23,con24,con25"
                                + ",con26,con27,con28,con29,con30,con31,con32,con33,con34,con35,formember)"
                                + " values(?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,?,?,?,?,?,? ,?,?,?,?,? , ?,?,?,?,?,?,?,?,?,? ,?)";
                        
                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(1, t_code.getText().trim());
                        prm.setString(2, t_name.getText());
                        prm.setString(3, t_barcode.getText());
                        prm.setString(4, date1);
                        prm.setString(5, date2);
                        prm.setString(6, strDay.getText());
                        prm.setString(7, strtype.getText());
                        prm.setDouble(8, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(9, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(10, campaign_code.getText());
                        prm.setInt(11, Integer.parseInt(t_cnt.getValue().toString()));
                       
                        if (rdymulti.isSelected()) {
                            prm.setString(12, "Y");
                        } else {
                            prm.setString(12, "N");
                        }
                        
                        prm.setString(13, t_cutime.getText().trim());
                        prm.setString(14, t_cutime2.getText().trim());
                        prm.setString(15, Head1.getText());
                        prm.setString(16, Head2.getText());
                        prm.setString(17, Head3.getText());
                        prm.setString(18, Head4.getText());
                        prm.setString(19, Head5.getText());
                        prm.setString(20, Head6.getText());
                        prm.setString(21, Con1.getText());
                        prm.setString(22, Con2.getText());
                        prm.setString(23, Con3.getText());
                        prm.setString(24, Con4.getText());
                        prm.setString(25, Con5.getText());
                        prm.setString(26, Con6.getText());
                        prm.setString(27, Con7.getText());
                        prm.setString(28, Con8.getText());
                        prm.setString(29, Con9.getText());
                        prm.setString(30, Con10.getText());
                        prm.setString(31, Con11.getText());
                        prm.setString(32, Con12.getText());
                        prm.setString(33, Con13.getText());
                        prm.setString(34, Con14.getText());
                        prm.setString(35, Con15.getText());
                        prm.setString(36, Con16.getText());
                        prm.setString(37, Con17.getText());
                        prm.setString(38, Con18.getText());
                        prm.setString(39, Con19.getText());
                        prm.setString(40, Con20.getText());
                        
                        prm.setString(41, Con21.getText());
                        prm.setString(42, Con22.getText());
                        prm.setString(43, Con23.getText());
                        prm.setString(44, Con24.getText());
                        prm.setString(45, Con25.getText());
                        
                        prm.setString(46, Con26.getText());
                        prm.setString(47, Con27.getText());
                        prm.setString(48, Con28.getText());
                        prm.setString(49, Con29.getText());
                        prm.setString(50, Con30.getText());
                        
                        prm.setString(51, Con31.getText());
                        prm.setString(52, Con32.getText());
                        prm.setString(53, Con33.getText());
                        prm.setString(54, Con34.getText());
                        prm.setString(55, Con35.getText());
                        prm.setString(56, formem);
                        prm.executeUpdate();
                    }
                    stmt.close();

                } catch (Exception e) {
                    JOptionPane.showMessageDialog(this, e.getMessage().toString(), "Save Error...", JOptionPane.ERROR_MESSAGE);
                }
            }
            showdataintb();
            bsaveOK = true;
        }
    }
    public boolean CheckValidSave() {
        boolean chk = true;
        if (t_code.getText().length() > 8) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสคูปองไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 8 ตัวอักษร)");
            chk = false;
            t_code.requestFocus();
        } else if (t_name.getText().length() > 30) {
            JOptionPane.showMessageDialog(this, "กำหนด รายละเอียด/ชื่อคูปองไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 30 ตัวอักษร)");
            chk = false;
            t_name.requestFocus();
        } else if (t_barcode.getText().length() > 8) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัส Barcodeไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 8 ตัวอักษร)");
            chk = false;
            t_barcode.requestFocus();
        } else if (t_discountbath.getText().length() > 13) {
            JOptionPane.showMessageDialog(this, "กำหนดส่วนลดบาทไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 10 ตัวอักษร)");
            chk = false;
            t_discountbath.requestFocus();
        } else if (t_buymin.getText().length() > 13) {
            JOptionPane.showMessageDialog(this, "กำหนดยอดซื้อขั้นต่ำไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 10 ตัวอักษร)");
            chk = false;
            t_buymin.requestFocus();
        }
        //Check Fix Branch
        if (!ChkFixBranch()) {
            JOptionPane.showMessageDialog(this, "กรุณาตรวจสอบการกำหนดการใช้งานเฉพาะสาขา โดยไม่กำหนด กลุ่มสาขาที่ใช้งานได้" + "\n" + FixBranchError);
            chk = false;
        }
// ทำให้ Process การ Save ช้าลงค่อนข้างมาก        
//        if (!ChkPluList()) {
//            JOptionPane.showMessageDialog(this, "กรุณาตรวจสอบการกำหนดการใช้งานเฉพาะรายการสินค้า โดยไม่กำหนด กลุ่มสาขาที่ใช้งานได้" + "\n" + FixBranchError);
//            chk = false;
//        }

        //Check PLUList
        return chk;
    }

    public boolean ChkFixBranch() {
        boolean ret = true;
        ResultSet rs = null;
        FixBranchError = "";
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select bcode,bgroup from fixbranchecoupon "
                    + "left join branfile on code=bcode "
                    + "where cucode='" + t_code.getText() + "' ";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                String Tempbcode = rs.getString("bcode");
                String Tempbgroup = rs.getString("bgroup");
                if (!chkinbgroup(Tempbgroup)) {
                    ret = false;
                    FixBranchError = FixBranchError + "," + Tempbcode;
                }
            }

        } catch (SQLException ex) {
            Logger.getLogger(eCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean ChkPluList() {
        boolean ret = true;
        ResultSet rs = null;
        FixBranchError = "";
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from ecuponlist "
                    + "where cucode='" + t_code.getText() + "' ";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                String Tempcode = rs.getString("pcode");
                String Tempcucode = rs.getString("cucode");
                if (!chkinlist(Tempcucode, Tempcode)) {
                    ret = false;
                    FixBranchError = FixBranchError + "," + Tempcode;
                }
            }

        } catch (SQLException ex) {
            Logger.getLogger(eCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean chkinbgroup(String bgroup) {
        boolean ret = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from eculink "
                    + "where cucode='" + t_code.getText() + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.getRow() == 0) {
                while (rs.next()) {
                    if (rs.getString("bgroup").equals(bgroup)) {
                        ret = true;
                    }
                }
            }
        } catch (SQLException ex) {
            Logger.getLogger(eCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean chkinlist(String cucode, String pcode) {
        boolean ret = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select pcode from blink "
                    + "left join eculink on blink.bgroup=eculink.bgroup "
                    + "where cucode='" + cucode + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.getRow() == 0) {
                while (rs.next()) {
                    if (rs.getString("pcode").equals(pcode)) {
                        ret = true;
                    }
                }
            }
        } catch (SQLException ex) {
            Logger.getLogger(eCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean chkdata(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from ecupon where CuCode ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from ecupon where CuCode ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e);
        }
        return chk;
    }

    public boolean chkplu(String cucode, String plu) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select product.pcode from product "
                    + "left join blink on blink.pcode=product.pcode "
                    + "left join eculink on blink.bgroup=eculink.bgroup "
                    + "where CuCode ='" + cucode + "' and product.pcode='" + plu + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                chk = true;
            } else {
                chk = false;
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkculist(String cucode, String plu) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from ecuponlist "
                    + "where CuCode ='" + cucode + "' and pcode='" + plu + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                chk = true;
            } else {
                chk = false;
            }
        } catch (Exception e) {
        }
        return chk;
    }
   

    

    public boolean chkcuUnlist(String cucode, String plu) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from ecuponunlist "
                    + "where CuCode ='" + cucode + "' and pcode='" + plu + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                chk = true;
            } else {
                chk = false;
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatafixbranch(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from fixbranchecoupon where bcode ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from eculink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatafixbranch(String pk, String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from fixbranchecoupon where bcode ='" + cvth.Unicode2ASCII(pk) + "'"
                        + " and cucode = '" + cvth.Unicode2ASCII(code) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from eculink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatafixbranchingroup(String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();

                String where = "";
                for (int i = 0; i < model3.getRowCount(); i++) {
                    if (i == 0) {
                        where = "and ( branfile.bgroup = '" + model3.getValueAt(i, 0) + "'";
                    } else {
                        if (i == model3.getRowCount() - 1) {
                            where += " or branfile.bgroup = '" + model3.getValueAt(i, 0) + "' ";
                        } else if (i < 1 | i < model3.getRowCount()) {
                            where += " or branfile.bgroup = '" + model3.getValueAt(i, 0) + "'";
                        }
                    }
                }

//            String sql3 = "select bgroup,name,code "
//                    + "from branfile where " + where + " order by bgroup ";
//                
//                
//                String sql4 = "SELECT culink.CuCode,culink.BGroup,culink.FixBranch,branchgroup.BGroupName  "
//                    + "FROM culink INNER JOIN cupon ON culink.CuCode = cupon.CuCode "
//                    + "JOIN branchgroup ON branchgroup.BGroupCode = culink.BGroup "
//                    + "where culink.CuCode = '" + cupon + "' order by culink.BGroup;";

                String sql = "select branfile.code,branfile.bgroup "
                        + "from branfile  "
                        + "where branfile.code = '" + cvth.Unicode2ASCII(code) + "'  " + where + " )";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();

                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranchinfixbranch(String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();

                String where = "";
                if (model4.getRowCount() == 1) {
                    where = "and ( branfile.code = '" + model4.getValueAt(0, 1) + "')";
                } else {

                    for (int i = 0; i < model4.getRowCount(); i++) {
                        if (i == 0) {
                            where = "and ( branfile.code = '" + model4.getValueAt(i, 1) + "'";
                        } else {
                            if (i == model4.getRowCount() - 1) {
                                where += " or branfile.code = '" + model4.getValueAt(i, 1) + "' )";
                            } else if (i < 1 | i < model4.getRowCount()) {
                                where += " or branfile.code = '" + model4.getValueAt(i, 1) + "'";
                            }
                        }
                    }
                }

                String sql = "select branfile.code,branfile.bgroup "
                        + "from branfile  "
                        + "where bgroup = '" + cvth.Unicode2ASCII(code) + "' " + where + " ";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();

                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranchfile(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branfile where Code ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branfile where Code ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranch(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from eculink where BGroup ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from eculink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranch(String pk, String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from eculink where BGroup ='" + cvth.Unicode2ASCII(pk) + "'"
                        + " and cucode = '" + cvth.Unicode2ASCII(code) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from eculink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public void genday() {
        String coCode = t_code.getText().trim();
        if (coCode.length() > 0 && !t_code.isEditable()) {
            String day = "";
            if (c1.isSelected()) {
                day += ",Sun";
            }
            if (c2.isSelected()) {
                day += ",Mon";
            }
            if (c3.isSelected()) {
                day += ",Tue";
            }
            if (c4.isSelected()) {
                day += ",Wed";
            }
            if (c5.isSelected()) {
                day += ",Thu";
            }
            if (c6.isSelected()) {
                day += ",Fri";
            }
            if (c7.isSelected()) {
                day += ",Sat";
            }
            strDay.setText(day);
        } else {
            t_code.requestFocus();
        }
    }

    public void gend() {
        String proType = "";
        if (te1.isSelected()) {
            proType += ",E";
        }
        if (tt1.isSelected()) {
            proType += ",T";
        }
        if (td1.isSelected()) {
            proType += ",D";
        }
        if (tp1.isSelected()) {
            proType += ",P";
        }
        if (tw1.isSelected()) {
            proType += ",W";
        }
        strtype.setText(proType);
    }

    private void setActive() {
        setActive(true);
    }

    private void setUnActive() {
        setActive(false);
    }

    private void setActive(boolean active) {
        tab.setEnabledAt(1, active);
        tab.setEnabledAt(2, active);
        tab.setEnabledAt(3, active);
        t_name.setFocusable(active);
        t_barcode.setFocusable(active);
        t_date1.setFocusable(active);
        t_date2.setFocusable(active);
        t_discountbath.setFocusable(active);
        t_buymin.setFocusable(active);
        campaign_code.setFocusable(active);
        btnfindcampaign.setEnabled(active);

      
        btn_Calendar.setEnabled(active);
        btn_Calendar1.setEnabled(active);
        c1.setEnabled(active);
        c2.setEnabled(active);
        c3.setEnabled(active);
        c4.setEnabled(active);
        c5.setEnabled(active);
        c6.setEnabled(active);
        c7.setEnabled(active);
        te1.setEnabled(active);
        tt1.setEnabled(active);
        td1.setEnabled(active);
        tp1.setEnabled(active);
        tw1.setEnabled(active);
        rdymulti.setEnabled(active);
        rdnmulti.setEnabled(active);
        t_cnt.setFocusable(active);

       
        t_bcode.setFocusable(active);
        t_fixbranch.setFocusable(active);

//        if (active == true && chkdata(t_code.getText())) {
//            tab.setEnabledAt(1, active);
//        }


    }

    public void clearForm() {
        bsaveOK = false;
        FixBranchError = "";
        PluListError = "";
        tab.setSelectedIndex(0);
        t_barcode.requestFocus();
        t_code.setText("");
        t_code.setEditable(true);
        t_code.setBackground(java.awt.Color.white);

        t_name.setText("");
        t_cutime.setText("00:00");
        t_cutime2.setText("00:00");
        
        t_barcode.setText("");
        rdactive1.setSelected(true);
        t_date1.setText(Format.dateFmtShow.format(new java.util.Date()));
        t_date2.setText(Format.dateFmtShow.format(new java.util.Date()));
        strDay.setText("");
        c1.setSelected(false);
        c2.setSelected(false);
        c3.setSelected(false);
        c4.setSelected(false);
        c5.setSelected(false);
        c6.setSelected(false);
        c7.setSelected(false);
        te1.setSelected(false);
        tt1.setSelected(false);
        td1.setSelected(false);
        tp1.setSelected(false);
        tw1.setSelected(false);
        t_buymin.setText("0.00");
        strtype.setText("");

        t_discountbath.setText("0.00");
        formember.setSelected(false);


        //tab2
        t_code2.setText("");
        t_bcode.setText("");
        t_bname.setText("");
        t_fixbranch.setText("");
        t_fixname.setText("");
        campaign_code.setText("");
        campaign_name.setText("");
        t_cnt.setValue(1);
        rdnmulti.setSelected(true);
        Head1.setText("");
        Head2.setText("");
        Head3.setText("");
        Head4.setText("");
        Head5.setText("");
        Head6.setText("");
        Con1.setText("");
        Con2.setText("");
        Con3.setText("");
        Con4.setText("");
        Con5.setText("");
        Con6.setText("");
        Con7.setText("");
        Con8.setText("");
        Con9.setText("");
        Con10.setText("");
        Con11.setText("");
        Con12.setText("");
        Con13.setText("");
        Con14.setText("");
        Con15.setText("");
        Con16.setText("");
        Con17.setText("");
        Con18.setText("");
        Con19.setText("");
        Con20.setText("");
        Con21.setText("");
        Con22.setText("");
        Con23.setText("");
        Con24.setText("");
        Con25.setText("");
        Con26.setText("");
        Con27.setText("");
        Con28.setText("");
        Con29.setText("");
        Con30.setText("");
        Con31.setText("");
        Con32.setText("");
        Con33.setText("");
        Con34.setText("");
        Con35.setText("");

        clearModel3();
        clearModel4();

        setUnActive();
        t_code.requestFocus();
        showdataintb();
    }

    public void delete(String code) {
        try {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลรายการนี้หรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
            if (confirm == JOptionPane.YES_OPTION) {


                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Delete from ecupon where CuCode = ?";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
                stmt.close();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from ecuponlist where CuCode = ?";
                PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                prm2.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm2.executeUpdate();
                stmt.close();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql3 = "Delete from eculink where CuCode = ?";
                PreparedStatement prm3 = (PreparedStatement) dbUtility.con.prepareStatement(sql3);
                prm3.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm3.executeUpdate();
                stmt.close();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql4 = "Delete from fixbranchecoupon where CuCode = ?";
                PreparedStatement prm4 = (PreparedStatement) dbUtility.con.prepareStatement(sql4);
                prm4.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm4.executeUpdate();
                stmt.close();
                
                stmt = (Statement) dbUtility.con.createStatement();
                String sql5 = "Delete from ecuponunlist where CuCode = ?";
                PreparedStatement prm5 = (PreparedStatement) dbUtility.con.prepareStatement(sql5);
                prm5.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm5.executeUpdate();
                stmt.close();

                clearForm();
                showdataintb();
            }

        } catch (Exception e) {
        }
    }

   

    

    public void deletebranch(String code) {
        try {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลกลุ่มสาขาทั้งหมดหรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
            if (confirm == JOptionPane.YES_OPTION) {

                for (int i = 0; i < tblbranch.getRowCount(); i++) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {

                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql2 = "Delete from eculink where BGroup = ? and cucode = '" + code + "'";
                        PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                        prm2.setString(1, cvth.Unicode2ASCII(tblbranch.getValueAt(i, 0).toString()));
                        prm2.executeUpdate();
                        stmt.close();

                    } else {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql2 = "Delete from eculink where BGroup = ?";
                        PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                        prm2.setString(1, tblbranch.getValueAt(i, 0).toString());
                        prm2.executeUpdate();
                        stmt.close();
                    }
                }
                clearModel3();
            }

        } catch (Exception e) {
        }
    }
    public void btnplu() {
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        ListProduct dialog = new ListProduct(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_plu.setText(dialog.code);
                GetDataplu(dialog.code);
                btnpluok.requestFocus();
            } else {
                t_plu.requestFocus();
            }
        } catch (Exception e) {
            t_plu.requestFocus();
        }
    }
     public void btnplu1() {
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        ListProduct dialog = new ListProduct(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_plu1.setText(dialog.code);
                GetDataplu(dialog.code);
                btnpluok1.requestFocus();
            } else {
                t_plu1.requestFocus();
            }
        } catch (Exception e) {
            t_plu1.requestFocus();
        }
    }
    public void escplu() {
        t_plu.setText("");
        t_pluname.setText("");
        t_plu.requestFocus();
    }
    public void escplu1() {
        t_plu1.setText("");
        t_pluname1.setText("");
        t_plu1.requestFocus();
    }
    public void getCuponList(String cupon) {

        tblplu.setShowGrid(true);
        tblplu.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblplu.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblplu.setRowSelectionAllowed(true);
        tblplu.setBackground(java.awt.Color.WHITE);
        tblplu.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblplu.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model2 = (DefaultTableModel) tblplu.getModel();
        modelh2 = (JTableHeader) tblplu.getTableHeader();
        int cnt = model2.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model2.removeRow(0);
            }
        }
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup "
                    + "FROM product INNER JOIN ecuponlist ON product.pcode = ecuponlist.PCode  "
                    + "where cucode = '" + cupon + "' order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model2.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("pgroup")),
                                    cvth.ASCII2Unicode(rs.getString("product.pcode")),
                                    cvth.ASCII2Unicode(rs.getString("pdesc"))});


                    } else {
                        model2.addRow(new Object[]{rs.getString("pgroup"),
                                    rs.getString("product.pcode"),
                                    rs.getString("pdesc")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }
    public void getCuponUnList(String cupon) {

        tblplu1.setShowGrid(true);
        tblplu1.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblplu1.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblplu1.setRowSelectionAllowed(true);
        tblplu1.setBackground(java.awt.Color.WHITE);
        tblplu1.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblplu1.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu1.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu1.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model5 = (DefaultTableModel) tblplu1.getModel();
        modelh5 = (JTableHeader) tblplu1.getTableHeader();
        int cnt = model5.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model5.removeRow(0);
            }
        }
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup "
                    + "FROM product INNER JOIN ecuponunlist ON product.pcode = ecuponunlist.PCode  "
                    + "where cucode = '" + cupon + "' order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model5.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("pgroup")),
                                    cvth.ASCII2Unicode(rs.getString("product.pcode")),
                                    cvth.ASCII2Unicode(rs.getString("pdesc"))});


                    } else {
                        model5.addRow(new Object[]{rs.getString("pgroup"),
                                    rs.getString("product.pcode"),
                                    rs.getString("pdesc")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

}
