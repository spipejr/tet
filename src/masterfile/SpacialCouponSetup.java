/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

 /*
 * SpacialCouponSetup.java
 *
 * Created on Sep 17, 2012, 3:08:14 PM
 */
package masterfile;

import Entity.BranchCodeName;
import dbutility.dbUtility;
import frmlist.*;
import java.awt.Point;
import java.awt.event.KeyEvent;
import java.io.File;
import java.io.IOException;
import static java.lang.String.format;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JFileChooser;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.ListSelectionModel;
import javax.swing.SwingConstants;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.JTableHeader;
import javax.swing.table.TableColumnModel;
import jxl.write.WriteException;
import utilities.DateChooser.DateChooserDialog;
import utilities.DateChooser.DateUtil;
import utilititiesfunction.*;

/**
 *
 * @author natee
 */
public class SpacialCouponSetup extends javax.swing.JDialog {

    DefaultTableModel model;
    DefaultTableModel model2;
    DefaultTableModel model3;
    DefaultTableModel model4;
    DefaultTableModel model5;
    DefaultTableModel model6;
    JTableHeader modelh1;
    JTableHeader modelh2;
    JTableHeader modelh5;
    dbUtility db = new dbUtility();
    private Statement stmt;
    ThaiUtilities cvth = new ThaiUtilities();
    String formname = "spacialcouponsetup";
    String SelectedCampain = "";
    String FixBranchError = "";
    String PluListError = "";
    boolean bsaveOK = false;
    private String expdate = "";
    PreparedStatement pre = null;
    PreparedStatement preUp = null;
    ResultSet rs = null;

    /**
     * Creates new form SpacialCouponSetup
     */
    public SpacialCouponSetup(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        checkuserconfig();
        db.dbconnect();
        try {
            stmt = (Statement) dbUtility.con.createStatement();
        } catch (Exception e) {
        }
        tblCupon.setAutoCreateRowSorter(true);
        tblfixbranch.setAutoCreateRowSorter(true);
        tblplu.setAutoCreateRowSorter(true);
        loadcampainlist();
        showdataintb();
        clearForm();
        t_code.requestFocus();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        buttonGroup2 = new javax.swing.ButtonGroup();
        buttonGroup3 = new javax.swing.ButtonGroup();
        buttonGroup4 = new javax.swing.ButtonGroup();
        plu = new javax.swing.JPopupMenu();
        jMenuItem7 = new javax.swing.JMenuItem();
        jMenuItem6 = new javax.swing.JMenuItem();
        branch = new javax.swing.JPopupMenu();
        jMenuItem8 = new javax.swing.JMenuItem();
        jMenuItem9 = new javax.swing.JMenuItem();
        fixbranch = new javax.swing.JPopupMenu();
        jMenuItem10 = new javax.swing.JMenuItem();
        jMenuItem11 = new javax.swing.JMenuItem();
        buttonGroup5 = new javax.swing.ButtonGroup();
        buttonGroup6 = new javax.swing.ButtonGroup();
        buttonGroup7 = new javax.swing.ButtonGroup();
        plu1 = new javax.swing.JPopupMenu();
        jMenuItem12 = new javax.swing.JMenuItem();
        jMenuItem13 = new javax.swing.JMenuItem();
        fixbranch1 = new javax.swing.JPopupMenu();
        jMenuItem14 = new javax.swing.JMenuItem();
        jMenuItem15 = new javax.swing.JMenuItem();
        popdeleteexceptdate = new javax.swing.JPopupMenu();
        jMenuItem16 = new javax.swing.JMenuItem();
        jMenuItem17 = new javax.swing.JMenuItem();
        jPanel1 = new javax.swing.JPanel();
        btnNew = new javax.swing.JButton();
        btnCancel = new javax.swing.JButton();
        btnSave = new javax.swing.JButton();
        btnDelete = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jButton7 = new javax.swing.JButton();
        tab = new javax.swing.JTabbedPane();
        jPanel2 = new javax.swing.JPanel();
        jPanel22 = new javax.swing.JPanel();
        jPanel3 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        t_code = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        t_barcode = new javax.swing.JTextField();
        t_name = new javax.swing.JTextField();
        jLabel27 = new javax.swing.JLabel();
        btnfindcampaign = new javax.swing.JButton();
        campaign_code = new javax.swing.JTextField();
        campaign_name = new javax.swing.JTextField();
        T2POffline = new javax.swing.JCheckBox();
        T2PBrithday = new javax.swing.JCheckBox();
        jPanel4 = new javax.swing.JPanel();
        jLabel6 = new javax.swing.JLabel();
        strDay = new javax.swing.JTextField();
        jPanel5 = new javax.swing.JPanel();
        c1 = new javax.swing.JCheckBox();
        c2 = new javax.swing.JCheckBox();
        c3 = new javax.swing.JCheckBox();
        c4 = new javax.swing.JCheckBox();
        c5 = new javax.swing.JCheckBox();
        c6 = new javax.swing.JCheckBox();
        c7 = new javax.swing.JCheckBox();
        jLabel7 = new javax.swing.JLabel();
        chMember = new javax.swing.JComboBox();
        strtype = new javax.swing.JTextField();
        jPanel12 = new javax.swing.JPanel();
        te1 = new javax.swing.JCheckBox();
        tt1 = new javax.swing.JCheckBox();
        tw1 = new javax.swing.JCheckBox();
        tp1 = new javax.swing.JCheckBox();
        td1 = new javax.swing.JCheckBox();
        jLabel11 = new javax.swing.JLabel();
        jPanel9 = new javax.swing.JPanel();
        rdDiscount = new javax.swing.JRadioButton();
        rdnDiscount = new javax.swing.JRadioButton();
        jPanel10 = new javax.swing.JPanel();
        rdService = new javax.swing.JRadioButton();
        rdnService = new javax.swing.JRadioButton();
        rdyauto = new javax.swing.JRadioButton();
        rdnauto = new javax.swing.JRadioButton();
        jPanel13 = new javax.swing.JPanel();
        jLabel12 = new javax.swing.JLabel();
        t_buymin = new javax.swing.JFormattedTextField();
        jLabel14 = new javax.swing.JLabel();
        t_cutime = new javax.swing.JFormattedTextField();
        t_cutime2 = new javax.swing.JFormattedTextField();
        chkminall = new javax.swing.JCheckBox();
        maisenmemberday = new javax.swing.JCheckBox();
        jLabel8 = new javax.swing.JLabel();
        t_maisensale = new javax.swing.JFormattedTextField();
        jLabel16 = new javax.swing.JLabel();
        t_maisenfree = new javax.swing.JFormattedTextField();
        jPanel8 = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        rd1 = new javax.swing.JRadioButton();
        rd2 = new javax.swing.JRadioButton();
        jPanel11 = new javax.swing.JPanel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        t_discountper = new javax.swing.JFormattedTextField();
        t_discountbath = new javax.swing.JFormattedTextField();
        jLabel18 = new javax.swing.JLabel();
        jPanel23 = new javax.swing.JPanel();
        rdymulti = new javax.swing.JRadioButton();
        rdnmulti = new javax.swing.JRadioButton();
        rdyother = new javax.swing.JRadioButton();
        rdnother = new javax.swing.JRadioButton();
        jLabel15 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        t_cnt = new javax.swing.JFormattedTextField();
        jLabel4 = new javax.swing.JLabel();
        t_date1 = new javax.swing.JFormattedTextField();
        btn_Calendar = new javax.swing.JButton();
        jLabel5 = new javax.swing.JLabel();
        t_date2 = new javax.swing.JFormattedTextField();
        btn_Calendar1 = new javax.swing.JButton();
        paneltable = new javax.swing.JPanel();
        jPanel17 = new javax.swing.JPanel();
        jLayeredPane1 = new javax.swing.JLayeredPane();
        rdactive1 = new javax.swing.JRadioButton();
        rdactive2 = new javax.swing.JRadioButton();
        jLabel29 = new javax.swing.JLabel();
        campaignlist = new javax.swing.JComboBox();
        jPanel19 = new javax.swing.JPanel();
        t_count1 = new javax.swing.JLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblCupon = new javax.swing.JTable();
        lbcampaign = new javax.swing.JLabel();
        paneltab2 = new javax.swing.JPanel();
        jPanel14 = new javax.swing.JPanel();
        jPanel16 = new javax.swing.JPanel();
        btn_plu = new javax.swing.JButton();
        t_plu = new javax.swing.JTextField();
        btnpluok = new javax.swing.JButton();
        t_pluname = new javax.swing.JTextField();
        btnbranchcancle2 = new javax.swing.JButton();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblplu = new javax.swing.JTable();
        jLabel13 = new javax.swing.JLabel();
        t_gcode = new javax.swing.JTextField();
        btngroupok = new javax.swing.JButton();
        btn_group3 = new javax.swing.JButton();
        jPanel18 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblbranch = new javax.swing.JTable();
        btnok5 = new javax.swing.JButton();
        jPanel15 = new javax.swing.JPanel();
        t_bcode = new javax.swing.JTextField();
        btn_group = new javax.swing.JButton();
        t_bname = new javax.swing.JTextField();
        btnbranchcancle = new javax.swing.JButton();
        btnbranchok = new javax.swing.JButton();
        jPanel20 = new javax.swing.JPanel();
        jScrollPane4 = new javax.swing.JScrollPane();
        tblfixbranch = new javax.swing.JTable();
        jPanel21 = new javax.swing.JPanel();
        btnbranchok1 = new javax.swing.JButton();
        t_fixbranch = new javax.swing.JTextField();
        btn_group2 = new javax.swing.JButton();
        t_fixname = new javax.swing.JTextField();
        btnbranchcancle1 = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        t_code2 = new javax.swing.JTextField();
        jPanel24 = new javax.swing.JPanel();
        jPanel25 = new javax.swing.JPanel();
        jPanel26 = new javax.swing.JPanel();
        btn_plu1 = new javax.swing.JButton();
        t_plu1 = new javax.swing.JTextField();
        btnpluok1 = new javax.swing.JButton();
        t_pluname1 = new javax.swing.JTextField();
        btnbranchcancle3 = new javax.swing.JButton();
        jScrollPane6 = new javax.swing.JScrollPane();
        tblplu1 = new javax.swing.JTable();
        jLabel20 = new javax.swing.JLabel();
        t_gcode1 = new javax.swing.JTextField();
        btngroupok1 = new javax.swing.JButton();
        btn_group4 = new javax.swing.JButton();
        jPanel27 = new javax.swing.JPanel();
        t_code3 = new javax.swing.JTextField();
        jPanel28 = new javax.swing.JPanel();
        jScrollPane5 = new javax.swing.JScrollPane();
        tblfixbranch1 = new javax.swing.JTable();
        jPanel29 = new javax.swing.JPanel();
        btnbranchok2 = new javax.swing.JButton();
        t_fixbranch1 = new javax.swing.JTextField();
        btn_group5 = new javax.swing.JButton();
        t_fixname1 = new javax.swing.JTextField();
        btnbranchcancle4 = new javax.swing.JButton();
        jPanel30 = new javax.swing.JPanel();
        t_bcode1 = new javax.swing.JTextField();
        btn_group1 = new javax.swing.JButton();
        btnbranchcancle5 = new javax.swing.JButton();
        btnbranchok3 = new javax.swing.JButton();
        t_bname1 = new javax.swing.JTextField();
        jPanel31 = new javax.swing.JPanel();
        jPanel32 = new javax.swing.JPanel();
        jPanel33 = new javax.swing.JPanel();
        txt_dateexcept = new javax.swing.JTextField();
        btn_dateExc = new javax.swing.JButton();
        jLabel63 = new javax.swing.JLabel();
        bntok6 = new javax.swing.JButton();
        bntcancel6 = new javax.swing.JButton();
        jScrollPane7 = new javax.swing.JScrollPane();
        tbl_excdate = new javax.swing.JTable();
        jMenuBar1 = new javax.swing.JMenuBar();
        jMenu1 = new javax.swing.JMenu();
        menuNew = new javax.swing.JMenuItem();
        menuCancel = new javax.swing.JMenuItem();
        menuSave = new javax.swing.JMenuItem();
        menuDelete = new javax.swing.JMenuItem();
        jSeparator1 = new javax.swing.JPopupMenu.Separator();
        menuExit = new javax.swing.JMenuItem();

        plu.setName("popup"); // NOI18N

        jMenuItem7.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem7.setText("ลบรายการที่เลือก");
        jMenuItem7.setName("popup1"); // NOI18N
        jMenuItem7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem7ActionPerformed(evt);
            }
        });
        plu.add(jMenuItem7);

        jMenuItem6.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem6.setText("ลบทุกรายการ");
        jMenuItem6.setName("popup2"); // NOI18N
        jMenuItem6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem6ActionPerformed(evt);
            }
        });
        plu.add(jMenuItem6);

        branch.setName("popup"); // NOI18N

        jMenuItem8.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem8.setText("ลบรายการที่เลือก");
        jMenuItem8.setName("popup1"); // NOI18N
        jMenuItem8.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem8ActionPerformed(evt);
            }
        });
        branch.add(jMenuItem8);

        jMenuItem9.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem9.setText("ลบทุกรายการ");
        jMenuItem9.setName("popup2"); // NOI18N
        jMenuItem9.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem9ActionPerformed(evt);
            }
        });
        branch.add(jMenuItem9);

        fixbranch.setName("popup"); // NOI18N

        jMenuItem10.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem10.setText("ลบรายการที่เลือก");
        jMenuItem10.setName("popup1"); // NOI18N
        jMenuItem10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem10ActionPerformed(evt);
            }
        });
        fixbranch.add(jMenuItem10);

        jMenuItem11.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem11.setText("ลบทุกรายการ");
        jMenuItem11.setName("popup2"); // NOI18N
        jMenuItem11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem11ActionPerformed(evt);
            }
        });
        fixbranch.add(jMenuItem11);

        plu1.setName("popup"); // NOI18N

        jMenuItem12.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem12.setText("ลบรายการที่เลือก");
        jMenuItem12.setName("popup1"); // NOI18N
        jMenuItem12.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem12ActionPerformed(evt);
            }
        });
        plu1.add(jMenuItem12);

        jMenuItem13.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem13.setText("ลบทุกรายการ");
        jMenuItem13.setName("popup2"); // NOI18N
        jMenuItem13.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem13ActionPerformed(evt);
            }
        });
        plu1.add(jMenuItem13);

        fixbranch1.setName("popup"); // NOI18N

        jMenuItem14.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem14.setText("ลบรายการที่เลือก");
        jMenuItem14.setName("popup1"); // NOI18N
        jMenuItem14.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem14ActionPerformed(evt);
            }
        });
        fixbranch1.add(jMenuItem14);

        jMenuItem15.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem15.setText("ลบทุกรายการ");
        jMenuItem15.setName("popup2"); // NOI18N
        jMenuItem15.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem15ActionPerformed(evt);
            }
        });
        fixbranch1.add(jMenuItem15);

        jMenuItem16.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem16.setText("ลบรายการที่เลือก");
        jMenuItem16.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem16ActionPerformed(evt);
            }
        });
        popdeleteexceptdate.add(jMenuItem16);

        jMenuItem17.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jMenuItem17.setText("ลบทุกรายการ");
        jMenuItem17.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem17ActionPerformed(evt);
            }
        });
        popdeleteexceptdate.add(jMenuItem17);

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        addWindowListener(new java.awt.event.WindowAdapter() {
            public void windowOpened(java.awt.event.WindowEvent evt) {
                formWindowOpened(evt);
            }
        });

        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btnNew.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnNew.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Add-icon.png"))); // NOI18N
        btnNew.setText("เพิ่มรายการ");
        btnNew.setFocusable(false);
        btnNew.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnNew.setName("DBbtnadd"); // NOI18N
        btnNew.setRequestFocusEnabled(false);
        btnNew.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnNew.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNewActionPerformed(evt);
            }
        });

        btnCancel.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnCancel.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Cancel-icon.png"))); // NOI18N
        btnCancel.setText("ยกเลิก");
        btnCancel.setFocusable(false);
        btnCancel.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnCancel.setName("DBbtncancle"); // NOI18N
        btnCancel.setRequestFocusEnabled(false);
        btnCancel.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCancelActionPerformed(evt);
            }
        });

        btnSave.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnSave.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/save-icon.png"))); // NOI18N
        btnSave.setText("บันทึกข้อมูล");
        btnSave.setFocusable(false);
        btnSave.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnSave.setName("DBbtnsave"); // NOI18N
        btnSave.setRequestFocusEnabled(false);
        btnSave.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSaveActionPerformed(evt);
            }
        });

        btnDelete.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Delete-icons.png"))); // NOI18N
        btnDelete.setText("ลบข้อมูล");
        btnDelete.setFocusable(false);
        btnDelete.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        btnDelete.setName("DBbtndel"); // NOI18N
        btnDelete.setRequestFocusEnabled(false);
        btnDelete.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        btnDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnDeleteActionPerformed(evt);
            }
        });

        jButton6.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jButton6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Printer-icon.png"))); // NOI18N
        jButton6.setText("พิมพ์");
        jButton6.setFocusable(false);
        jButton6.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jButton6.setName("DBbtnprint"); // NOI18N
        jButton6.setRequestFocusEnabled(false);
        jButton6.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);

        jButton7.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jButton7.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/LogOut-icon.png"))); // NOI18N
        jButton7.setText("ออก");
        jButton7.setFocusable(false);
        jButton7.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jButton7.setName("DBbtnexit"); // NOI18N
        jButton7.setRequestFocusEnabled(false);
        jButton7.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jButton7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton7ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(btnNew, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(btnSave, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addComponent(jButton7, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnNew, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnCancel, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnSave, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnDelete, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jButton7, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        tab.setFocusable(false);
        tab.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tab.setPreferredSize(new java.awt.Dimension(1024, 697));
        tab.setRequestFocusEnabled(false);
        tab.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tabMousePressed(evt);
            }
        });

        jPanel2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel22.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("รหัสบัตรคูปอง");
        jLabel1.setName("D_code"); // NOI18N

        t_code.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_code.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_codeKeyTyped(evt);
            }
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_codeKeyPressed(evt);
            }
        });

        jLabel2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("ชื่อบัตรคูปอง");
        jLabel2.setName("D_name"); // NOI18N

        jLabel3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("Barcode");
        jLabel3.setName("D_barcode"); // NOI18N

        t_barcode.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_barcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_barcodeKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_barcodeKeyTyped(evt);
            }
        });

        t_name.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_name.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_nameKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_nameKeyTyped(evt);
            }
        });

        jLabel27.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel27.setText("เคมเปญ");

        btnfindcampaign.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btnfindcampaign.setFocusable(false);
        btnfindcampaign.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnfindcampaignActionPerformed(evt);
            }
        });
        btnfindcampaign.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnfindcampaignKeyPressed(evt);
            }
        });

        campaign_code.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        campaign_code.setText("jTextField1");
        campaign_code.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                campaign_codeFocusLost(evt);
            }
        });
        campaign_code.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                campaign_codeKeyPressed(evt);
            }
        });

        campaign_name.setBackground(new java.awt.Color(245, 245, 172));
        campaign_name.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        campaign_name.setText("jTextField2");
        campaign_name.setFocusable(false);

        T2POffline.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        T2POffline.setText("T2P Off Line");

        T2PBrithday.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        T2PBrithday.setText("Brithday Offline");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jLabel2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jLabel1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 123, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(t_barcode, javax.swing.GroupLayout.PREFERRED_SIZE, 136, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(T2POffline, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(T2PBrithday)
                        .addGap(0, 18, Short.MAX_VALUE))
                    .addComponent(t_name)
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addComponent(t_code, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel27)
                        .addGap(2, 2, 2)
                        .addComponent(btnfindcampaign, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(campaign_code, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(campaign_name))))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel3Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(campaign_name, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel3Layout.createSequentialGroup()
                        .addGap(12, 12, 12)
                        .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jLabel27, javax.swing.GroupLayout.Alignment.TRAILING)
                                .addComponent(btnfindcampaign, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(campaign_code, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(t_code, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel1)))))
                .addGap(0, 0, 0)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(t_name, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel2))
                .addGap(0, 0, Short.MAX_VALUE)
                .addGroup(jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(t_barcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel3)
                    .addComponent(T2POffline)
                    .addComponent(T2PBrithday))
                .addGap(13, 13, 13))
        );

        jPanel4.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel6.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel6.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel6.setText("ใช้ได้เฉพาะวัน (Day)"); // NOI18N
        jLabel6.setName("DBstrday"); // NOI18N

        strDay.setEditable(false);
        strDay.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        jPanel5.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        c1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c1.setText("วันอาทิตย์");
        c1.setEnabled(false);
        c1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c1ActionPerformed(evt);
            }
        });

        c2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c2.setText("วันจันทร์");
        c2.setEnabled(false);
        c2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c2ActionPerformed(evt);
            }
        });

        c3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c3.setText("วันอังคาร");
        c3.setEnabled(false);
        c3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c3ActionPerformed(evt);
            }
        });

        c4.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c4.setText("วันพุธ");
        c4.setEnabled(false);
        c4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c4ActionPerformed(evt);
            }
        });

        c5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c5.setText("วันพฤหัสฯ");
        c5.setEnabled(false);
        c5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c5ActionPerformed(evt);
            }
        });

        c6.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c6.setText("วันศุกร์");
        c6.setEnabled(false);
        c6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c6ActionPerformed(evt);
            }
        });

        c7.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        c7.setText("วันเสาร์");
        c7.setEnabled(false);
        c7.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                c7ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addComponent(c1)
                .addGap(0, 0, 0)
                .addComponent(c2)
                .addGap(0, 0, 0)
                .addComponent(c3)
                .addGap(0, 0, 0)
                .addComponent(c4)
                .addGap(0, 0, 0)
                .addComponent(c5)
                .addGap(0, 0, 0)
                .addComponent(c6)
                .addGap(0, 0, 0)
                .addComponent(c7)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(c1)
                    .addComponent(c2)
                    .addComponent(c3)
                    .addComponent(c4)
                    .addComponent(c5)
                    .addComponent(c6)
                    .addComponent(c7))
                .addContainerGap())
        );

        jLabel7.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel7.setText("ใช้เป็นส่วนลดหลัก"); // NOI18N
        jLabel7.setName("DBmaindiscount"); // NOI18N

        chMember.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Y", "N" }));
        chMember.setEnabled(false);
        chMember.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                chMemberKeyPressed(evt);
            }
        });

        strtype.setEditable(false);

        jPanel12.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        te1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        te1.setText("Eat-In");
        te1.setEnabled(false);
        te1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                te1ActionPerformed(evt);
            }
        });

        tt1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tt1.setText("Take Away");
        tt1.setEnabled(false);
        tt1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tt1ActionPerformed(evt);
            }
        });

        tw1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tw1.setText("Whole Sale");
        tw1.setEnabled(false);
        tw1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tw1ActionPerformed(evt);
            }
        });

        tp1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        tp1.setText("Pinto");
        tp1.setEnabled(false);
        tp1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tp1ActionPerformed(evt);
            }
        });

        td1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        td1.setText("Delivery");
        td1.setEnabled(false);
        td1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                td1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(te1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tt1)
                .addGap(6, 6, 6)
                .addComponent(td1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tp1)
                .addGap(4, 4, 4)
                .addComponent(tw1)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(te1)
                .addComponent(tt1)
                .addComponent(td1)
                .addComponent(tp1)
                .addComponent(tw1))
        );

        jLabel11.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel11.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel11.setText("Sale Type"); // NOI18N
        jLabel11.setName("DBsaletype"); // NOI18N

        buttonGroup1.add(rdDiscount);
        rdDiscount.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdDiscount.setText("Redule ส่วนลดได้");
        rdDiscount.setName("D_redulediscounty"); // NOI18N

        buttonGroup1.add(rdnDiscount);
        rdnDiscount.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdnDiscount.setText("Redule ส่วนลดไม่ได้");
        rdnDiscount.setName("D_redulediscountn"); // NOI18N

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addComponent(rdDiscount)
                .addGap(18, 18, 18)
                .addComponent(rdnDiscount, javax.swing.GroupLayout.DEFAULT_SIZE, 150, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(rdDiscount)
                .addComponent(rdnDiscount))
        );

        buttonGroup2.add(rdService);
        rdService.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdService.setText("Redule ค่าบริการได้");
        rdService.setName("D_reduleservicey"); // NOI18N

        buttonGroup2.add(rdnService);
        rdnService.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdnService.setText("Redule ค่าบริการไม่ได้");
        rdnService.setName("D_reduleservicen"); // NOI18N

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addComponent(rdService)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(rdnService, javax.swing.GroupLayout.DEFAULT_SIZE, 148, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(rdService)
                .addComponent(rdnService))
        );

        buttonGroup5.add(rdyauto);
        rdyauto.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdyauto.setText("ให้ส่วนลดแบบ Auto");

        buttonGroup5.add(rdnauto);
        rdnauto.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdnauto.setText("ให้ส่วนลดแบบ Mannual");

        jPanel13.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel12.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel12.setText("ยอดซื้อขั้นต่ำ");
        jLabel12.setName("D_min"); // NOI18N

        t_buymin.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        t_buymin.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_buymin.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_buymin.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_buyminFocusGained(evt);
            }
        });
        t_buymin.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_buyminKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel12)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_buymin, javax.swing.GroupLayout.DEFAULT_SIZE, 87, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel12)
                    .addComponent(t_buymin, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jLabel14.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel14.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel14.setText("เวลา"); // NOI18N
        jLabel14.setName("DBsaletype"); // NOI18N

        t_cutime.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("HH:mm"))));
        t_cutime.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        t_cutime.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_cutime.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_cutimeFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_cutimeFocusLost(evt);
            }
        });

        t_cutime2.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("HH:mm"))));
        t_cutime2.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        t_cutime2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_cutime2.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_cutime2FocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_cutime2FocusLost(evt);
            }
        });

        chkminall.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        chkminall.setText("คำนวณขั้นต่ำจากทั้งบิล");

        maisenmemberday.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        maisenmemberday.setText("Maisen Member Day");

        jLabel8.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel8.setText("จำนวนขาย");

        t_maisensale.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0"))));
        t_maisensale.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_maisensale.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_maisensale.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_maisensaleFocusGained(evt);
            }
        });
        t_maisensale.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_maisensaleKeyPressed(evt);
            }
        });

        jLabel16.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel16.setText("จำนวนแถม");

        t_maisenfree.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0"))));
        t_maisenfree.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_maisenfree.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_maisenfree.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_maisenfreeFocusGained(evt);
            }
        });
        t_maisenfree.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_maisenfreeKeyPressed(evt);
            }
        });

        jPanel8.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel7.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        buttonGroup3.add(rd1);
        rd1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rd1.setText("(A) ให้ส่วนลดได้เฉพาะรายการที่กำหนด");
        rd1.setName("D_saletypea"); // NOI18N

        buttonGroup3.add(rd2);
        rd2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rd2.setText("(B) ให้ส่วนลดได้ทุกรายการที่ลดได้");
        rd2.setName("D_saletypeb"); // NOI18N
        rd2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rd2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGroup(jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(rd2, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(rd1, javax.swing.GroupLayout.Alignment.LEADING))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addComponent(rd1)
                .addGap(0, 0, 0)
                .addComponent(rd2)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel11.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jLabel9.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel9.setText("ส่วนลดเป็น %");
        jLabel9.setName("D_disper"); // NOI18N

        jLabel10.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel10.setText("ส่วนลด (บาท)");
        jLabel10.setName("D_disbath"); // NOI18N

        t_discountper.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0.00"))));
        t_discountper.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_discountper.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_discountper.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_discountperFocusGained(evt);
            }
            public void focusLost(java.awt.event.FocusEvent evt) {
                t_discountperFocusLost(evt);
            }
        });
        t_discountper.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_discountperKeyTyped(evt);
            }
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_discountperKeyPressed(evt);
            }
        });

        t_discountbath.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#,##0.00"))));
        t_discountbath.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        t_discountbath.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_discountbath.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                t_discountbathFocusGained(evt);
            }
        });
        t_discountbath.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_discountbathKeyPressed(evt);
            }
        });

        jLabel18.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel18.setText("%");

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel9)
                    .addComponent(jLabel10))
                .addGap(31, 31, 31)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(t_discountper, javax.swing.GroupLayout.DEFAULT_SIZE, 63, Short.MAX_VALUE)
                    .addComponent(t_discountbath))
                .addGap(4, 4, 4)
                .addComponent(jLabel18)
                .addContainerGap(24, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel9)
                    .addComponent(t_discountper, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel18))
                .addGap(0, 0, 0)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel10)
                    .addComponent(t_discountbath, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        jPanel23.setBorder(javax.swing.BorderFactory.createTitledBorder("Condition For Type B (Discount Bath)"));

        buttonGroup6.add(rdymulti);
        rdymulti.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdymulti.setText("ให้ส่วนลดแบบทวีคูณ");

        buttonGroup6.add(rdnmulti);
        rdnmulti.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdnmulti.setText("ให้ส่วนลดได้ครั้งเดียว");

        buttonGroup7.add(rdyother);
        rdyother.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdyother.setText("ใช้ร่วมกับส่วนลดอื่นได้");

        buttonGroup7.add(rdnother);
        rdnother.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdnother.setText("ใช้ร่วมกับส่วนลดอื่นไม่ได้");

        jLabel15.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel15.setText("จำนวนคูปองที่สามารถใช้ได้");

        jLabel19.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel19.setText("ใบ");

        t_cnt.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.NumberFormatter(new java.text.DecimalFormat("#0"))));
        t_cnt.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        t_cnt.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_cnt.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_cntKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel23Layout = new javax.swing.GroupLayout(jPanel23);
        jPanel23.setLayout(jPanel23Layout);
        jPanel23Layout.setHorizontalGroup(
            jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel23Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel23Layout.createSequentialGroup()
                        .addComponent(rdymulti)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(rdnmulti)
                        .addGap(53, 53, 53)
                        .addComponent(jLabel15))
                    .addGroup(jPanel23Layout.createSequentialGroup()
                        .addComponent(rdyother)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(rdnother)
                        .addGap(58, 58, 58)
                        .addComponent(t_cnt, javax.swing.GroupLayout.PREFERRED_SIZE, 53, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel19)))
                .addContainerGap(38, Short.MAX_VALUE))
        );
        jPanel23Layout.setVerticalGroup(
            jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel23Layout.createSequentialGroup()
                .addGroup(jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rdymulti)
                    .addComponent(rdnmulti)
                    .addComponent(jLabel15))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel23Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rdyother)
                    .addComponent(rdnother)
                    .addComponent(jLabel19)
                    .addComponent(t_cnt, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(jPanel7, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addComponent(jPanel23, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel8Layout.createSequentialGroup()
                .addGroup(jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel7, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel23, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addComponent(jPanel12, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                        .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addGroup(jPanel4Layout.createSequentialGroup()
                                            .addComponent(jLabel7)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addComponent(chMember, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addComponent(chkminall)
                                    .addComponent(maisenmemberday))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addGroup(jPanel4Layout.createSequentialGroup()
                                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                            .addGroup(jPanel4Layout.createSequentialGroup()
                                                .addComponent(jLabel8)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(t_maisensale))
                                            .addComponent(rdyauto))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(rdnauto)
                                            .addGroup(jPanel4Layout.createSequentialGroup()
                                                .addGap(0, 0, Short.MAX_VALUE)
                                                .addComponent(jLabel16)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(t_maisenfree, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE))))))
                            .addGroup(jPanel4Layout.createSequentialGroup()
                                .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 159, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(strDay, javax.swing.GroupLayout.PREFERRED_SIZE, 314, javax.swing.GroupLayout.PREFERRED_SIZE))))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGap(52, 52, 52)
                        .addComponent(jLabel11, javax.swing.GroupLayout.PREFERRED_SIZE, 115, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(strtype, javax.swing.GroupLayout.PREFERRED_SIZE, 127, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel14)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(t_cutime, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(t_cutime2, javax.swing.GroupLayout.PREFERRED_SIZE, 47, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel8, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel4Layout.createSequentialGroup()
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel6)
                    .addComponent(strDay, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel11)
                    .addComponent(strtype, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel14)
                    .addComponent(t_cutime, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_cutime2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(0, 0, 0)
                .addComponent(jPanel12, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, 0)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addComponent(jPanel9, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(rdyauto)
                            .addComponent(rdnauto)))
                    .addGroup(jPanel4Layout.createSequentialGroup()
                        .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel7)
                            .addComponent(chMember, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(chkminall)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(maisenmemberday)
                        .addComponent(jLabel8))
                    .addGroup(jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(t_maisensale, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel16)
                        .addComponent(t_maisenfree, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel8, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        jLabel4.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel4.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabel4.setText("ช่วงวันที่สามารถให้ส่วนลดได้");
        jLabel4.setName("D_datesale"); // NOI18N

        t_date1.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                t_date1ActionPerformed(evt);
            }
        });
        t_date1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date1KeyPressed(evt);
            }
        });

        btn_Calendar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CalendarActionPerformed(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel5.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel5.setText("ถึง");
        jLabel5.setName("D_to"); // NOI18N

        t_date2.setFormatterFactory(new javax.swing.text.DefaultFormatterFactory(new javax.swing.text.DateFormatter(new java.text.SimpleDateFormat("dd/MM/yyyy"))));
        t_date2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_date2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_date2KeyPressed(evt);
            }
        });

        btn_Calendar1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_Calendar1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_Calendar1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel22Layout = new javax.swing.GroupLayout(jPanel22);
        jPanel22.setLayout(jPanel22Layout);
        jPanel22Layout.setHorizontalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel22Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel22Layout.createSequentialGroup()
                        .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())
                    .addGroup(jPanel22Layout.createSequentialGroup()
                        .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 173, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(t_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(5, 5, 5)
                        .addComponent(btn_Calendar, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 26, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, 0)
                        .addComponent(t_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 104, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btn_Calendar1, javax.swing.GroupLayout.PREFERRED_SIZE, 35, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(jPanel4, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
        );
        jPanel22Layout.setVerticalGroup(
            jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel22Layout.createSequentialGroup()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel22Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel4)
                        .addComponent(jLabel5)
                        .addComponent(t_date1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(t_date2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_Calendar, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_Calendar1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(198, Short.MAX_VALUE))
        );

        jLayeredPane1.setBorder(javax.swing.BorderFactory.createTitledBorder("Condition Selected"));

        buttonGroup4.add(rdactive1);
        rdactive1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdactive1.setSelected(true);
        rdactive1.setText("แสดงรายการทั้งหมด");
        rdactive1.setName("D_showall"); // NOI18N
        rdactive1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdactive1ActionPerformed(evt);
            }
        });
        jLayeredPane1.add(rdactive1);
        rdactive1.setBounds(60, 60, 140, 32);

        buttonGroup4.add(rdactive2);
        rdactive2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        rdactive2.setText("แสดงเฉพาะที่ Active");
        rdactive2.setName("D_showactive"); // NOI18N
        rdactive2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rdactive2ActionPerformed(evt);
            }
        });
        jLayeredPane1.add(rdactive2);
        rdactive2.setBounds(210, 60, 180, 32);

        jLabel29.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel29.setText("เคมเปญ");
        jLayeredPane1.add(jLabel29);
        jLabel29.setBounds(10, 30, 43, 30);

        campaignlist.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        campaignlist.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));
        campaignlist.setPreferredSize(new java.awt.Dimension(78, 30));
        campaignlist.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                campaignlistActionPerformed(evt);
            }
        });
        jLayeredPane1.add(campaignlist);
        campaignlist.setBounds(60, 30, 300, 30);

        javax.swing.GroupLayout jPanel17Layout = new javax.swing.GroupLayout(jPanel17);
        jPanel17.setLayout(jPanel17Layout);
        jPanel17Layout.setHorizontalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jLayeredPane1)
        );
        jPanel17Layout.setVerticalGroup(
            jPanel17Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel17Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLayeredPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel19.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        t_count1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_count1.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        t_count1.setText("จำนวนรายการ 0 รายการ");
        t_count1.setName("D_countlist"); // NOI18N

        javax.swing.GroupLayout jPanel19Layout = new javax.swing.GroupLayout(jPanel19);
        jPanel19.setLayout(jPanel19Layout);
        jPanel19Layout.setHorizontalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel19Layout.createSequentialGroup()
                .addComponent(t_count1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel19Layout.setVerticalGroup(
            jPanel19Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(t_count1)
        );

        tblCupon.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        tblCupon.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "รหัส", "Barcode", "ชื่อบัตรคูปอง", "วันที่เริ่มต้น - วันที่สิ้นสุด", "ใช้เฉพาะวัน", "SaleType", "Redule ส่วนลด", "Redule ค่าบริการ", "ประเภทคูปอง", "ส่วนลด %", "ส่วนลดบาท", "ยอดซื้อขั้นต่ำ"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false, false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblCupon.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                tblCuponMouseReleased(evt);
            }
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblCuponMouseClicked(evt);
            }
        });
        tblCupon.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                tblCuponKeyPressed(evt);
            }
        });
        jScrollPane1.setViewportView(tblCupon);
        if (tblCupon.getColumnModel().getColumnCount() > 0) {
            tblCupon.getColumnModel().getColumn(0).setPreferredWidth(60);
            tblCupon.getColumnModel().getColumn(1).setPreferredWidth(70);
            tblCupon.getColumnModel().getColumn(2).setPreferredWidth(160);
            tblCupon.getColumnModel().getColumn(3).setPreferredWidth(160);
            tblCupon.getColumnModel().getColumn(4).setPreferredWidth(140);
            tblCupon.getColumnModel().getColumn(5).setPreferredWidth(120);
            tblCupon.getColumnModel().getColumn(6).setPreferredWidth(90);
            tblCupon.getColumnModel().getColumn(7).setPreferredWidth(90);
            tblCupon.getColumnModel().getColumn(8).setPreferredWidth(70);
            tblCupon.getColumnModel().getColumn(9).setPreferredWidth(80);
            tblCupon.getColumnModel().getColumn(10).setPreferredWidth(80);
            tblCupon.getColumnModel().getColumn(11).setPreferredWidth(100);
        }

        lbcampaign.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        lbcampaign.setText("เคมเปญ  001 เคมเปญวันแม่แห่งชาติ");

        javax.swing.GroupLayout paneltableLayout = new javax.swing.GroupLayout(paneltable);
        paneltable.setLayout(paneltableLayout);
        paneltableLayout.setHorizontalGroup(
            paneltableLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(paneltableLayout.createSequentialGroup()
                .addGroup(paneltableLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel17, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel19, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 418, Short.MAX_VALUE)
                    .addComponent(lbcampaign, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        paneltableLayout.setVerticalGroup(
            paneltableLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(paneltableLayout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 376, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(lbcampaign)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel19, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel17, javax.swing.GroupLayout.PREFERRED_SIZE, 119, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addComponent(paneltable, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel22, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(paneltable, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        tab.addTab("Setup Cupon", jPanel2);

        paneltab2.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jPanel14.setBorder(javax.swing.BorderFactory.createTitledBorder("Setup PLU For This Coupon"));

        jPanel16.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btn_plu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_plu.setFocusable(false);
        btn_plu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_pluActionPerformed(evt);
            }
        });

        t_plu.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_plu.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_pluKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_pluKeyTyped(evt);
            }
        });

        btnpluok.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnpluok.setText("ตกลง (OK)");
        btnpluok.setName("DBbtnok"); // NOI18N
        btnpluok.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnpluokActionPerformed(evt);
            }
        });
        btnpluok.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnpluokKeyPressed(evt);
            }
        });

        t_pluname.setEditable(false);
        t_pluname.setBackground(new java.awt.Color(249, 252, 186));
        t_pluname.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle2.setText("ยกเลิก (Cancel)");
        btnbranchcancle2.setName("DBbtncancle"); // NOI18N
        btnbranchcancle2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle2ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addComponent(btn_plu, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 111, Short.MAX_VALUE))
                    .addComponent(t_plu))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(t_pluname, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel16Layout.createSequentialGroup()
                        .addComponent(btnpluok, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnbranchcancle2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addComponent(t_plu, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_plu, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addComponent(t_pluname, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnpluok, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnbranchcancle2, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        tblplu.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่ม", "รหัสสินค้า", "ชื่อสินค้า"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblplu.setComponentPopupMenu(plu);
        tblplu.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        tblplu.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblpluMousePressed(evt);
            }
        });
        jScrollPane3.setViewportView(tblplu);
        if (tblplu.getColumnModel().getColumnCount() > 0) {
            tblplu.getColumnModel().getColumn(0).setPreferredWidth(40);
            tblplu.getColumnModel().getColumn(1).setPreferredWidth(90);
            tblplu.getColumnModel().getColumn(2).setPreferredWidth(180);
        }

        jLabel13.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel13.setText("รหัสกลุ่ม");
        jLabel13.setName("D_groupcode"); // NOI18N

        t_gcode.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_gcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_gcodeKeyPressed(evt);
            }
        });

        btngroupok.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btngroupok.setText("เลือกทั้งกลุ่ม");
        btngroupok.setName("DBbtnallgroup"); // NOI18N
        btngroupok.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btngroupokActionPerformed(evt);
            }
        });

        btn_group3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group3.setFocusable(false);
        btn_group3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addComponent(jLabel13)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_gcode, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_group3, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btngroupok, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addComponent(jPanel16, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel13)
                        .addComponent(t_gcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btngroupok, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane3, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel18.setBorder(javax.swing.BorderFactory.createTitledBorder("Branch Group Setup"));

        tblbranch.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่มสาขา", "ชื่อกลุ่มสาชา"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblbranch.setComponentPopupMenu(branch);
        tblbranch.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblbranchMousePressed(evt);
            }
        });
        jScrollPane2.setViewportView(tblbranch);
        if (tblbranch.getColumnModel().getColumnCount() > 0) {
            tblbranch.getColumnModel().getColumn(0).setPreferredWidth(70);
            tblbranch.getColumnModel().getColumn(1).setPreferredWidth(160);
        }

        btnok5.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btnok5.setText("Link All Group");
        btnok5.setName("DBbtnok"); // NOI18N
        btnok5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnok5ActionPerformed(evt);
            }
        });

        t_bcode.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_bcode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_bcodeKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_bcodeKeyTyped(evt);
            }
        });

        btn_group.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group.setFocusable(false);
        btn_group.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_groupActionPerformed(evt);
            }
        });

        t_bname.setEditable(false);
        t_bname.setBackground(new java.awt.Color(249, 252, 186));
        t_bname.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle.setText("ยกเลิก(Cancel)");
        btnbranchcancle.setName("DBbtncancle"); // NOI18N
        btnbranchcancle.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancleActionPerformed(evt);
            }
        });

        btnbranchok.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchok.setText("ตกลง (OK)");
        btnbranchok.setName("DBbtnok"); // NOI18N
        btnbranchok.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchokActionPerformed(evt);
            }
        });
        btnbranchok.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnbranchokKeyPressed(evt);
            }
        });

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addComponent(t_bcode, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_bname))
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addComponent(btn_group, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnbranchok)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnbranchcancle, javax.swing.GroupLayout.PREFERRED_SIZE, 104, Short.MAX_VALUE))
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(t_bcode, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_bname, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btn_group, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnbranchok, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnbranchcancle, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))))
        );

        javax.swing.GroupLayout jPanel18Layout = new javax.swing.GroupLayout(jPanel18);
        jPanel18.setLayout(jPanel18Layout);
        jPanel18Layout.setHorizontalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel18Layout.createSequentialGroup()
                .addGroup(jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(btnok5)
                    .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                    .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(0, 3, Short.MAX_VALUE))
        );
        jPanel18Layout.setVerticalGroup(
            jPanel18Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel18Layout.createSequentialGroup()
                .addComponent(jPanel15, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 366, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnok5, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        jPanel20.setBorder(javax.swing.BorderFactory.createTitledBorder("Fix Branch Setup"));

        tblfixbranch.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่มสาขา", "รหัสสาขา", "ชื่อสาขา"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblfixbranch.setComponentPopupMenu(fixbranch);
        tblfixbranch.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblfixbranchMousePressed(evt);
            }
        });
        jScrollPane4.setViewportView(tblfixbranch);
        if (tblfixbranch.getColumnModel().getColumnCount() > 0) {
            tblfixbranch.getColumnModel().getColumn(0).setPreferredWidth(70);
            tblfixbranch.getColumnModel().getColumn(1).setPreferredWidth(60);
            tblfixbranch.getColumnModel().getColumn(2).setPreferredWidth(250);
        }

        jPanel21.setOpaque(false);

        btnbranchok1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchok1.setText("ตกลง (OK)");
        btnbranchok1.setName("DBbtnok"); // NOI18N
        btnbranchok1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchok1ActionPerformed(evt);
            }
        });
        btnbranchok1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnbranchok1KeyPressed(evt);
            }
        });

        t_fixbranch.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_fixbranch.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_fixbranchKeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_fixbranchKeyTyped(evt);
            }
        });

        btn_group2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group2.setFocusable(false);
        btn_group2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group2ActionPerformed(evt);
            }
        });

        t_fixname.setEditable(false);
        t_fixname.setBackground(new java.awt.Color(249, 252, 186));
        t_fixname.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle1.setText("ยกเลิก(Cancel)");
        btnbranchcancle1.setName("DBbtncancle"); // NOI18N
        btnbranchcancle1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel21Layout = new javax.swing.GroupLayout(jPanel21);
        jPanel21.setLayout(jPanel21Layout);
        jPanel21Layout.setHorizontalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel21Layout.createSequentialGroup()
                .addComponent(t_fixbranch, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(t_fixname, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(86, 86, 86))
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addComponent(btn_group2, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnbranchok1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnbranchcancle1, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel21Layout.setVerticalGroup(
            jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel21Layout.createSequentialGroup()
                .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(t_fixbranch, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_fixname, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel21Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnbranchok1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnbranchcancle1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        javax.swing.GroupLayout jPanel20Layout = new javax.swing.GroupLayout(jPanel20);
        jPanel20.setLayout(jPanel20Layout);
        jPanel20Layout.setHorizontalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
            .addGroup(jPanel20Layout.createSequentialGroup()
                .addComponent(jPanel21, javax.swing.GroupLayout.PREFERRED_SIZE, 292, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 24, Short.MAX_VALUE))
        );
        jPanel20Layout.setVerticalGroup(
            jPanel20Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel20Layout.createSequentialGroup()
                .addComponent(jPanel21, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.PREFERRED_SIZE, 0, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel6.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        t_code2.setEditable(false);
        t_code2.setBackground(new java.awt.Color(254, 192, 165));
        t_code2.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(t_code2, javax.swing.GroupLayout.PREFERRED_SIZE, 551, javax.swing.GroupLayout.PREFERRED_SIZE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel6Layout.createSequentialGroup()
                .addGap(0, 0, Short.MAX_VALUE)
                .addComponent(t_code2, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        javax.swing.GroupLayout paneltab2Layout = new javax.swing.GroupLayout(paneltab2);
        paneltab2.setLayout(paneltab2Layout);
        paneltab2Layout.setHorizontalGroup(
            paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(paneltab2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(paneltab2Layout.createSequentialGroup()
                        .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                    .addGroup(paneltab2Layout.createSequentialGroup()
                        .addComponent(jPanel18, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(5, 5, 5)
                        .addComponent(jPanel20, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        paneltab2Layout.setVerticalGroup(
            paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, paneltab2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(paneltab2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel20, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel18, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(jPanel14, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(24, Short.MAX_VALUE))
        );

        tab.addTab("BranchGroup & Product", paneltab2);

        jPanel25.setBorder(javax.swing.BorderFactory.createTitledBorder("Setup Except PLU For This Coupon"));

        jPanel26.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btn_plu1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_plu1.setFocusable(false);
        btn_plu1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_plu1ActionPerformed(evt);
            }
        });

        t_plu1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_plu1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_plu1KeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_plu1KeyTyped(evt);
            }
        });

        btnpluok1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnpluok1.setText("ตกลง (OK)");
        btnpluok1.setName("DBbtnok"); // NOI18N
        btnpluok1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnpluok1ActionPerformed(evt);
            }
        });
        btnpluok1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnpluok1KeyPressed(evt);
            }
        });

        t_pluname1.setEditable(false);
        t_pluname1.setBackground(new java.awt.Color(249, 252, 186));
        t_pluname1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle3.setText("ยกเลิก (Cancel)");
        btnbranchcancle3.setName("DBbtncancle"); // NOI18N
        btnbranchcancle3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle3ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel26Layout = new javax.swing.GroupLayout(jPanel26);
        jPanel26.setLayout(jPanel26Layout);
        jPanel26Layout.setHorizontalGroup(
            jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel26Layout.createSequentialGroup()
                .addGroup(jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel26Layout.createSequentialGroup()
                        .addComponent(btn_plu1, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addComponent(t_plu1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(t_pluname1, javax.swing.GroupLayout.PREFERRED_SIZE, 234, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel26Layout.createSequentialGroup()
                        .addComponent(btnpluok1, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(btnbranchcancle3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
        );
        jPanel26Layout.setVerticalGroup(
            jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel26Layout.createSequentialGroup()
                .addComponent(t_plu1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_plu1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
            .addGroup(jPanel26Layout.createSequentialGroup()
                .addComponent(t_pluname1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel26Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnpluok1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnbranchcancle3, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        tblplu1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่ม", "รหัสสินค้า", "ชื่อสินค้า"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.Object.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblplu1.setComponentPopupMenu(plu1);
        tblplu1.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        tblplu1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblplu1MousePressed(evt);
            }
        });
        jScrollPane6.setViewportView(tblplu1);
        if (tblplu1.getColumnModel().getColumnCount() > 0) {
            tblplu1.getColumnModel().getColumn(0).setPreferredWidth(50);
            tblplu1.getColumnModel().getColumn(1).setPreferredWidth(80);
            tblplu1.getColumnModel().getColumn(2).setPreferredWidth(250);
        }

        jLabel20.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        jLabel20.setText("รหัสกลุ่ม");
        jLabel20.setName("D_groupcode"); // NOI18N

        t_gcode1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_gcode1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_gcode1KeyPressed(evt);
            }
        });

        btngroupok1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        btngroupok1.setText("เลือกทั้งกลุ่ม");
        btngroupok1.setName("DBbtnallgroup"); // NOI18N
        btngroupok1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btngroupok1ActionPerformed(evt);
            }
        });

        btn_group4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group4.setFocusable(false);
        btn_group4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel25Layout = new javax.swing.GroupLayout(jPanel25);
        jPanel25.setLayout(jPanel25Layout);
        jPanel25Layout.setHorizontalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 452, Short.MAX_VALUE)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addComponent(jLabel20)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_gcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btn_group4, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btngroupok1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
            .addComponent(jPanel26, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel25Layout.setVerticalGroup(
            jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel25Layout.createSequentialGroup()
                .addComponent(jPanel26, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel25Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel20)
                        .addComponent(t_gcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btngroupok1, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group4, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.DEFAULT_SIZE, 418, Short.MAX_VALUE)
                .addContainerGap())
        );

        javax.swing.GroupLayout jPanel24Layout = new javax.swing.GroupLayout(jPanel24);
        jPanel24.setLayout(jPanel24Layout);
        jPanel24Layout.setHorizontalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel25, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(528, Short.MAX_VALUE))
        );
        jPanel24Layout.setVerticalGroup(
            jPanel24Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel24Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel25, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(16, 16, 16))
        );

        tab.addTab("Setup Except Plu", jPanel24);

        t_code3.setEditable(false);
        t_code3.setBackground(new java.awt.Color(254, 192, 165));
        t_code3.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N

        jPanel28.setBorder(javax.swing.BorderFactory.createTitledBorder("Setup Branch For GP Promotion                         Select By Branch Group"));

        tblfixbranch1.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "กลุ่มสาขา", "รหัสสาขา", "ชื่อสาขา"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class
            };
            boolean[] canEdit = new boolean [] {
                false, false, false
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblfixbranch1.setComponentPopupMenu(fixbranch1);
        tblfixbranch1.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mousePressed(java.awt.event.MouseEvent evt) {
                tblfixbranch1MousePressed(evt);
            }
        });
        jScrollPane5.setViewportView(tblfixbranch1);
        if (tblfixbranch1.getColumnModel().getColumnCount() > 0) {
            tblfixbranch1.getColumnModel().getColumn(0).setPreferredWidth(70);
            tblfixbranch1.getColumnModel().getColumn(1).setPreferredWidth(60);
            tblfixbranch1.getColumnModel().getColumn(2).setPreferredWidth(250);
        }

        jPanel29.setOpaque(false);

        btnbranchok2.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchok2.setText("ตกลง (OK)");
        btnbranchok2.setName("DBbtnok"); // NOI18N
        btnbranchok2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchok2ActionPerformed(evt);
            }
        });
        btnbranchok2.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnbranchok2KeyPressed(evt);
            }
        });

        t_fixbranch1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_fixbranch1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_fixbranch1KeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_fixbranch1KeyTyped(evt);
            }
        });

        btn_group5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group5.setFocusable(false);
        btn_group5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group5ActionPerformed(evt);
            }
        });

        t_fixname1.setEditable(false);
        t_fixname1.setBackground(new java.awt.Color(249, 252, 186));
        t_fixname1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        btnbranchcancle4.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle4.setText("ยกเลิก(Cancel)");
        btnbranchcancle4.setName("DBbtncancle"); // NOI18N
        btnbranchcancle4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel29Layout = new javax.swing.GroupLayout(jPanel29);
        jPanel29.setLayout(jPanel29Layout);
        jPanel29Layout.setHorizontalGroup(
            jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel29Layout.createSequentialGroup()
                .addComponent(t_fixbranch1, javax.swing.GroupLayout.PREFERRED_SIZE, 71, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(t_fixname1, javax.swing.GroupLayout.PREFERRED_SIZE, 212, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(86, 86, 86))
            .addGroup(jPanel29Layout.createSequentialGroup()
                .addComponent(btn_group5, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnbranchok2, javax.swing.GroupLayout.PREFERRED_SIZE, 98, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnbranchcancle4, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel29Layout.setVerticalGroup(
            jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel29Layout.createSequentialGroup()
                .addGroup(jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(t_fixbranch1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_fixname1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel29Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnbranchok2, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnbranchcancle4, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_group5, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)))
        );

        t_bcode1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        t_bcode1.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                t_bcode1KeyPressed(evt);
            }
            public void keyTyped(java.awt.event.KeyEvent evt) {
                t_bcode1KeyTyped(evt);
            }
        });

        btn_group1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Windows-Magnifier-icon.png"))); // NOI18N
        btn_group1.setFocusable(false);
        btn_group1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_group1ActionPerformed(evt);
            }
        });

        btnbranchcancle5.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchcancle5.setText("ยกเลิก(Cancel)");
        btnbranchcancle5.setName("DBbtncancle"); // NOI18N
        btnbranchcancle5.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchcancle5ActionPerformed(evt);
            }
        });

        btnbranchok3.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        btnbranchok3.setText("ตกลง (OK)");
        btnbranchok3.setName("DBbtnok"); // NOI18N
        btnbranchok3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnbranchok3ActionPerformed(evt);
            }
        });
        btnbranchok3.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                btnbranchok3KeyPressed(evt);
            }
        });

        t_bname1.setEditable(false);
        t_bname1.setBackground(new java.awt.Color(249, 252, 186));
        t_bname1.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N

        javax.swing.GroupLayout jPanel30Layout = new javax.swing.GroupLayout(jPanel30);
        jPanel30.setLayout(jPanel30Layout);
        jPanel30Layout.setHorizontalGroup(
            jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel30Layout.createSequentialGroup()
                .addComponent(t_bcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(t_bname1))
            .addGroup(jPanel30Layout.createSequentialGroup()
                .addComponent(btn_group1, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(btnbranchok3)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnbranchcancle5, javax.swing.GroupLayout.PREFERRED_SIZE, 104, Short.MAX_VALUE))
        );
        jPanel30Layout.setVerticalGroup(
            jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel30Layout.createSequentialGroup()
                .addGroup(jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(t_bcode1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(t_bname1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btn_group1, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jPanel30Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnbranchok3, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnbranchcancle5, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))))
        );

        javax.swing.GroupLayout jPanel28Layout = new javax.swing.GroupLayout(jPanel28);
        jPanel28.setLayout(jPanel28Layout);
        jPanel28Layout.setHorizontalGroup(
            jPanel28Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel28Layout.createSequentialGroup()
                .addComponent(jPanel29, javax.swing.GroupLayout.PREFERRED_SIZE, 292, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel30, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(8, 8, 8))
            .addGroup(jPanel28Layout.createSequentialGroup()
                .addComponent(jScrollPane5)
                .addContainerGap())
        );
        jPanel28Layout.setVerticalGroup(
            jPanel28Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel28Layout.createSequentialGroup()
                .addGroup(jPanel28Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel29, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jPanel30, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.DEFAULT_SIZE, 438, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel27Layout = new javax.swing.GroupLayout(jPanel27);
        jPanel27.setLayout(jPanel27Layout);
        jPanel27Layout.setHorizontalGroup(
            jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel27Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(t_code3, javax.swing.GroupLayout.DEFAULT_SIZE, 551, Short.MAX_VALUE)
                    .addComponent(jPanel28, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(441, Short.MAX_VALUE))
        );
        jPanel27Layout.setVerticalGroup(
            jPanel27Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel27Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(t_code3, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel28, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        tab.addTab("Setup Branch For GP Promotion", jPanel27);

        jPanel32.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
        jPanel32.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jPanel33.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel33.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        txt_dateexcept.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        txt_dateexcept.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                txt_dateexceptKeyPressed(evt);
            }
        });
        jPanel33.add(txt_dateexcept, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 10, 90, 30));

        btn_dateExc.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Date-and-Time-icon .png"))); // NOI18N
        btn_dateExc.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_dateExcActionPerformed(evt);
            }
        });
        jPanel33.add(btn_dateExc, new org.netbeans.lib.awtextra.AbsoluteConstraints(200, 10, 35, 30));

        jLabel63.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jLabel63.setText("กำหนดวันที่ใช้งาน");
        jPanel33.add(jLabel63, new org.netbeans.lib.awtextra.AbsoluteConstraints(5, 14, 100, -1));

        bntok6.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        bntok6.setText("ตกลง (OK)");
        bntok6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bntok6ActionPerformed(evt);
            }
        });
        jPanel33.add(bntok6, new org.netbeans.lib.awtextra.AbsoluteConstraints(110, 45, 110, 30));

        bntcancel6.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        bntcancel6.setText("ยกเลิก (Cancel)");
        bntcancel6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bntcancel6ActionPerformed(evt);
            }
        });
        jPanel33.add(bntcancel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(225, 45, 130, 30));

        jPanel32.add(jPanel33, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 10, 420, 85));

        tbl_excdate.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null},
                {null},
                {null},
                {null}
            },
            new String [] {
                "วันที่ใช้งานได้"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tbl_excdate.setComponentPopupMenu(popdeleteexceptdate);
        jScrollPane7.setViewportView(tbl_excdate);
        if (tbl_excdate.getColumnModel().getColumnCount() > 0) {
            tbl_excdate.getColumnModel().getColumn(0).setPreferredWidth(100);
        }

        jPanel32.add(jScrollPane7, new org.netbeans.lib.awtextra.AbsoluteConstraints(10, 100, 420, 460));

        javax.swing.GroupLayout jPanel31Layout = new javax.swing.GroupLayout(jPanel31);
        jPanel31.setLayout(jPanel31Layout);
        jPanel31Layout.setHorizontalGroup(
            jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel31Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel32, javax.swing.GroupLayout.PREFERRED_SIZE, 450, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(549, Short.MAX_VALUE))
        );
        jPanel31Layout.setVerticalGroup(
            jPanel31Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel31Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel32, javax.swing.GroupLayout.PREFERRED_SIZE, 571, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(28, Short.MAX_VALUE))
        );

        tab.addTab("Set Date For Maisen Member Day", jPanel31);

        jMenu1.setText("ฟังก์ชั่น");
        jMenu1.setFont(new java.awt.Font("Norasi", 1, 14)); // NOI18N
        jMenu1.setName("menufuc"); // NOI18N

        menuNew.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_N, java.awt.event.InputEvent.CTRL_MASK));
        menuNew.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuNew.setText("เพิ่มรายการ");
        menuNew.setName("madd"); // NOI18N
        menuNew.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuNewActionPerformed(evt);
            }
        });
        jMenu1.add(menuNew);

        menuCancel.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_I, java.awt.event.InputEvent.CTRL_MASK));
        menuCancel.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuCancel.setText("ยกเลิก");
        menuCancel.setName("mcancle"); // NOI18N
        menuCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuCancelActionPerformed(evt);
            }
        });
        jMenu1.add(menuCancel);

        menuSave.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_S, java.awt.event.InputEvent.CTRL_MASK));
        menuSave.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuSave.setText("บันทึกข้อมูล");
        menuSave.setName("msave"); // NOI18N
        menuSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                menuSaveActionPerformed(evt);
            }
        });
        jMenu1.add(menuSave);

        menuDelete.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_R, java.awt.event.InputEvent.CTRL_MASK));
        menuDelete.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuDelete.setText("ลบข้อมูล");
        menuDelete.setName("mdel"); // NOI18N
        jMenu1.add(menuDelete);
        jMenu1.add(jSeparator1);

        menuExit.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_E, java.awt.event.InputEvent.CTRL_MASK));
        menuExit.setFont(new java.awt.Font("Norasi", 0, 14)); // NOI18N
        menuExit.setText("ออก");
        menuExit.setName("mexit"); // NOI18N
        jMenu1.add(menuExit);

        jMenuBar1.add(jMenu1);

        setJMenuBar(jMenuBar1);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(jPanel1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(tab, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.PREFERRED_SIZE, 1016, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(8, 8, 8))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(tab, javax.swing.GroupLayout.PREFERRED_SIZE, 647, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        setSize(new java.awt.Dimension(1024, 790));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    public void loadcampainlist() {
        ResultSet rs = null;
        campaignlist.removeAllItems();
        campaignlist.addItem("ALL-แสดงทั้งหมด...");
        try {
            stmt = (java.sql.Statement) dbUtility.con.createStatement();
            String sql = "select * from campaignfile order by campaign_code ";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                campaignlist.addItem(cvth.ASCII2Unicode(rs.getString("campaign_code")) + "-" + cvth.ASCII2Unicode(rs.getString("campaign_name")));
            }
        } catch (SQLException ex) {
            PUtility.ShowMsg(ex.getMessage().toString());
        }
    }

    private void checkuserconfig() {
        //MenuName = Mast1
        UserLogin userrec = UserLogin.userlogin;
        if (userrec.getMast19().equals("1")) {
            btnNew.setEnabled(false);
            btnSave.setEnabled(false);
            btnDelete.setEnabled(false);
            menuNew.setEnabled(false);
            menuSave.setEnabled(false);
            menuSave.setEnabled(false);
            btn_group.setEnabled(false);
            btnbranchok.setEnabled(false);
            btn_group2.setEnabled(false);
            btnbranchok1.setEnabled(false);
            btnpluok.setEnabled(false);
            btngroupok.setEnabled(false);
            plu.setEnabled(false);
            btnpluok1.setEnabled(false);
            btngroupok1.setEnabled(false);
            plu1.setEnabled(false);
        }
        if (userrec.getMast19().equals("2")) {
            btnNew.setEnabled(true);
            btnSave.setEnabled(true);
            btnDelete.setEnabled(false);
            menuNew.setEnabled(true);
            menuSave.setEnabled(true);
            menuSave.setEnabled(false);
            btn_group.setEnabled(true);
            btnbranchok.setEnabled(true);
            btn_group2.setEnabled(true);
            btnbranchok1.setEnabled(true);
            btnpluok.setEnabled(true);
            btngroupok.setEnabled(true);
            plu.setEnabled(false);
            btnpluok1.setEnabled(true);
            btngroupok1.setEnabled(true);
            plu1.setEnabled(false);
        }
        if (userrec.getMast19().equals("3")) {
            btnNew.setEnabled(true);
            btnSave.setEnabled(true);
            btnDelete.setEnabled(true);
            menuNew.setEnabled(true);
            menuSave.setEnabled(true);
            menuSave.setEnabled(true);
            btn_group.setEnabled(true);
            btnbranchok.setEnabled(true);
            btn_group2.setEnabled(true);
            btnbranchok1.setEnabled(true);
            btnpluok.setEnabled(true);
            btngroupok.setEnabled(true);
            plu.setEnabled(true);
            btnpluok1.setEnabled(true);
            btngroupok1.setEnabled(true);
            plu1.setEnabled(true);
        }
    }
    private void t_codeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_codeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            if (!t_code.getText().trim().equals("")) {
                if (chkdata(t_code.getText())) {
                    String Code = "";
                    Code = t_code.getText().trim();
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        GetData(cvth.Unicode2ASCII(Code));
                    } else {
                        GetData(Code);
                    }
                } else {
                    setActive();
                    t_code.setBackground(new java.awt.Color(255, 246, 143));
                    t_code.setEditable(false);

                }
                campaign_code.requestFocus();
                tab.setEnabledAt(1, true);
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_codeKeyPressed

    private void tblCuponMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblCuponMouseReleased

        if (evt.getClickCount() == 2) {
            int index = tblCupon.getSelectedRow();
            String creditcode = tblCupon.getValueAt(index, 0).toString();
            if (t_code.getText().equals("")) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    GetData(cvth.Unicode2ASCII(creditcode));
                } else {
                    GetData(creditcode);
                }
            } else if (!t_code.getText().equals(creditcode)) {
                int confirm = JOptionPane.showConfirmDialog(this, "คุณมีการเพิ่มหรือแก้ไขข้อมูลอยู่ คุณต้องการยกเลิกการเพิ่มหรือแก้ไขข้อมูลนั้นหรือไม่", "Confirm", JOptionPane.YES_NO_OPTION);
                if (confirm == JOptionPane.YES_OPTION) {
//                    GetData(creditcode);
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        GetData(cvth.Unicode2ASCII(creditcode));
                    } else {
                        GetData(creditcode);
                    }
                }
            }
            t_code.setBackground(new java.awt.Color(255, 246, 143));
            t_code.setEditable(false);
            campaign_code.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_tblCuponMouseReleased

    private void rdactive2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdactive2ActionPerformed

        chkactive(Format.dateFmtSql.format(new java.util.Date()));
        // TODO add your handling code here:
    }//GEN-LAST:event_rdactive2ActionPerformed

    private void rdactive1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rdactive1ActionPerformed

        showdataintb();
        // TODO add your handling code here:
    }//GEN-LAST:event_rdactive1ActionPerformed

    public boolean removePluCuponList(String code) {
        Statement stmt = null;
        boolean isRemove = false;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "delete from cuponlist Where pcode = '" + code + "';";
            int deleteRow = stmt.executeUpdate(sql);
            if (deleteRow > 0) {
                isRemove = true;
                System.out.print("remove cupon success ");
            }
        } catch (Exception e) {
            System.out.print("Error : remove menulist error ");
        }

        return isRemove;
    }

    public String[] addProductToCopon(String plu) {
        Statement stmt = null;
        ResultSet rs = null;
        String[] product = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT pcode,pdesc,pprice11 FROM product   where pcode = '" + plu + "';";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                product = new String[2];
                product[0] = rs.getString("pcode");
                product[1] = rs.getString("pdesc");
            }
        } catch (Exception e) {
        }
        return product;
    }

    public boolean insertCuponList(String cocode, String pcode) {
        Statement stmt = null;
        boolean isupdate = false;
        int rowInsert = 0;
        String sql = "";

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            sql = "insert into cuponlist values('" + cocode + "','" + pcode + "')";
            rowInsert = stmt.executeUpdate(sql);
            if (rowInsert > 0) {
                isupdate = true;
            }
        } catch (Exception e) {
        }
        return isupdate;
    }

    public void escplu() {
        t_plu.setText("");
        t_pluname.setText("");
        t_plu.requestFocus();
    }
    private void t_pluKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_pluKeyPressed

        String get = t_plu.getText();
        String out = get.toUpperCase();
        t_plu.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataplu(cvth.Unicode2ASCII(t_plu.getText()));
            } else {
                GetDataplu(t_plu.getText());
            }

        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnplu();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escplu();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_pluKeyPressed

    private void c1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c1ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c1ActionPerformed

    private void c2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c2ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c2ActionPerformed

    private void btnNewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNewActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnNewActionPerformed

    private void btnCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnCancelActionPerformed

    private void c3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c3ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c3ActionPerformed

    private void c4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c4ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c4ActionPerformed

    private void c5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c5ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c5ActionPerformed

    private void c6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c6ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c6ActionPerformed

    private void c7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_c7ActionPerformed

        genday();
        // TODO add your handling code here:
    }//GEN-LAST:event_c7ActionPerformed

    public void btndate1() {
        try {
            Point point = btn_Calendar.getLocation();
            point.setLocation(point.getX() + 1, point.getY() + 1);
            utilities.DateChooser.DateChooserDialog dcd = new utilities.DateChooser.DateChooserDialog(null, true, point);
            dcd.setVisible(true);
            t_date1.setText(Format.dateFmtShow.format(dcd.getSelectedDate().getTime()));
            t_date2.requestFocus();
        } catch (Exception e) {
            t_date2.requestFocus();
        }
    }

    private void btn_CalendarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CalendarActionPerformed
        DateUtil.showDateChooserDialog(t_date1, btn_Calendar);
        t_date1.requestFocus();
        //btndate1();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_CalendarActionPerformed

    public void btndate2() {
        try {
            Point point = btn_Calendar1.getLocation();
            point.setLocation(point.getX() + 1, point.getY() + 1);
            utilities.DateChooser.DateChooserDialog dcd = new utilities.DateChooser.DateChooserDialog(null, true, point);
            dcd.setVisible(true);
            t_date2.setText(Format.dateFmtShow.format(dcd.getSelectedDate().getTime()));
            t_discountper.requestFocus();
        } catch (Exception e) {
            t_discountper.requestFocus();
        }
    }

    public void expcouponback() {
        Export2Excel test = new Export2Excel();
        JFileChooser chooser = new JFileChooser();

        try {
            File f = new File(new File("cupon.xls").getCanonicalPath());

            chooser.setSelectedFile(f);
        } catch (IOException e) {
        }
        chooser.showSaveDialog(this);

        File curFile = chooser.getSelectedFile();

        try {
            test.setOutputFile(curFile.toString());
            test.write(model, modelh1);
        } catch (IOException ex) {
        } catch (WriteException ex) {
        }
        // TODO add your handling code here:
    }

    public void exppluback() {
        Export2Excel test = new Export2Excel();
        JFileChooser chooser = new JFileChooser();

        try {
            File f = new File(new File("plu.xls").getCanonicalPath());

            chooser.setSelectedFile(f);
        } catch (IOException e) {
        }
        chooser.showSaveDialog(this);

        File curFile = chooser.getSelectedFile();

        try {
            test.setOutputFile(curFile.toString());
            test.write(model2, modelh2);
        } catch (IOException ex) {
        } catch (WriteException ex) {
        }
        // TODO add your handling code here:
    }

    private void btn_Calendar1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_Calendar1ActionPerformed
        DateUtil.showDateChooserDialog(t_date2, btn_Calendar1);
        t_date2.requestFocus();
        //btndate2();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_Calendar1ActionPerformed

    private void btnSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSaveActionPerformed

        if (!t_code.getText().trim().equals("")) {
            btnsave();
            SaveFixBranch();
            if (bsaveOK) {
                clearForm();
            }
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnSaveActionPerformed

    private void te1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_te1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_te1ActionPerformed

    private void tt1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tt1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_tt1ActionPerformed

    private void td1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_td1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_td1ActionPerformed

    private void tp1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tp1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_tp1ActionPerformed

    private void tw1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tw1ActionPerformed

        gend();
        // TODO add your handling code here:
    }//GEN-LAST:event_tw1ActionPerformed

    private void jButton7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton7ActionPerformed

        dispose();
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton7ActionPerformed

    private void t_barcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_barcodeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date1.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_barcodeKeyPressed

    private void t_nameKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_nameKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_barcode.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_nameKeyPressed

    private void chMemberKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_chMemberKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_discountper.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_chMemberKeyPressed

    private void t_discountperKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_discountperKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_discountbath.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountperKeyPressed

    private void t_discountbathKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_discountbathKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_cnt.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountbathKeyPressed

    private void t_buyminKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_buyminKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_discountper.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_buyminKeyPressed

    private void btnbranchokActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchokActionPerformed

        String get = t_bcode.getText();
        String out = get.toUpperCase();
        t_bcode.setText(out);
        if (!chkdatabranch(t_bcode.getText(), t_code.getText())) {
            if (chkdatabranchgroup(t_bcode.getText())) {
                btnsave();
                if (chkdata(t_code.getText())) {
                    btnsavebranch();
                    getBranchList(t_code.getText());
                }
            } else {
                JOptionPane.showMessageDialog(this, "ไม่มีข้อมูล BranchGroup นี้ในระบบ..");
            }
        } else {
            JOptionPane.showMessageDialog(this, "ข้อมูล BranchGroup นี้มีอยู่แล้ว..");
        }

        t_bcode.requestFocus();
    }//GEN-LAST:event_btnbranchokActionPerformed
    private void btnbranchcancleActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancleActionPerformed

        escbranch();

        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchcancleActionPerformed

    public void btngroup() {
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        BrowserBranchGroup dialog = new BrowserBranchGroup(new NimbusFrame(), true, point);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                BranchCodeName hrb = dialog.getDataRecord();
                t_bcode.setText(dialog.code);
                GetDataBranch(dialog.code);
                btnbranchok.requestFocus();
            } else {
                t_bcode.requestFocus();
            }
        } catch (Exception e) {
            t_bcode.requestFocus();
        }
    }

    private void btn_groupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_groupActionPerformed

        btngroup();
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_groupActionPerformed

    public void escbranch() {
        t_bcode.setText("");
        t_bname.setText("");
        t_bcode.requestFocus();
    }

    public void escbranch1() {
        t_bcode1.setText("");
        t_bname1.setText("");
        t_bcode1.requestFocus();
    }

    private void t_bcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_bcodeKeyPressed

        String get = t_bcode.getText();
        String out = get.toUpperCase();
        t_bcode.setText(out);
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            String Code = "";
            Code = t_bcode.getText();
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataBranch(cvth.ASCII2Unicode(Code));
                btnbranchok.requestFocus();
            } else {
                GetDataBranch(Code);
                btnbranchok.requestFocus();
            }
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btngroup();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escbranch();
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_t_bcodeKeyPressed

    public void saveallplu() {
        try {
            for (int i = 0; i < tblplu.getRowCount(); i++) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {

                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "insert into cuponlist (CuCode,PCode) values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                    prm2.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                    prm2.setString(2, cvth.Unicode2ASCII(tblplu.getValueAt(i, 1).toString()));
                    prm2.executeUpdate();
                    stmt.close();

                } else {
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "insert into cuponlist (CuCode,PCode) values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                    prm2.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                    prm2.setString(2, tblplu.getValueAt(i, 1).toString());
                    prm2.executeUpdate();
                    stmt.close();
                }
            }

        } catch (Exception e) {
        }
    }

    private void btngroupokActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btngroupokActionPerformed

        if (!t_gcode.getText().trim().equals("")) {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการเพิ่มข้อมูลกลุ่มสินค้า " + t_gcode.getText() + " ทั้งหมดใช่หรือไม่", "Confirm", JOptionPane.YES_NO_OPTION);

            if (confirm == JOptionPane.YES_OPTION) {
                String code = t_gcode.getText().trim();
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup(cvth.Unicode2ASCII(code));
                    }
                } else {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup(code);
                    }
                }
                t_gcode.setText("");
                t_plu.requestFocus();

            }
        }


    }//GEN-LAST:event_btngroupokActionPerformed

    public void btnplu() {
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        ListProduct dialog = new ListProduct(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_plu.setText(dialog.code);
                GetDataplu(dialog.code);
                btnpluok.requestFocus();
            } else {
                t_plu.requestFocus();
            }
        } catch (Exception e) {
            t_plu.requestFocus();
        }
    }

    private void btn_pluActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_pluActionPerformed

        //if (!rd2.isSelected()) {
        btnplu();
        //} else {
        //    JOptionPane.showMessageDialog(this, "คุณกำหนดประเภทการให้ส่วนลดเป็น B อยู่");
        // }
        // TODO add your handling code here:
    }//GEN-LAST:event_btn_pluActionPerformed

    private void menuNewActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuNewActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_menuNewActionPerformed

    private void menuCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuCancelActionPerformed

        clearForm();
        // TODO add your handling code here:
    }//GEN-LAST:event_menuCancelActionPerformed

    private void menuSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_menuSaveActionPerformed

        if (!t_code.getText().trim().equals("")) {
            btnsave();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_menuSaveActionPerformed

    private void btnDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnDeleteActionPerformed

        if (!t_code.getText().trim().equals("")) {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                String Code = cvth.Unicode2ASCII(t_code.getText());
                delete(Code);
            } else {
                String Code = t_code.getText();
                delete(Code);
            }

        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnDeleteActionPerformed

    public void saveallbranch() {
        try {
            for (int i = 0; i < tblbranch.getRowCount(); i++) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {

                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "insert into culink (CuCode,BGroup) values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                    prm2.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                    prm2.setString(2, cvth.Unicode2ASCII(tblbranch.getValueAt(i, 0).toString()));
                    prm2.executeUpdate();
                    stmt.close();

                } else {
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "insert into culink (CuCode,BGroup) values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                    prm2.setString(1, t_code.getText());
                    prm2.setString(1, tblbranch.getValueAt(i, 0).toString());
                    prm2.executeUpdate();
                    stmt.close();
                }
            }

        } catch (Exception e) {
        }
    }

    private void btnok5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnok5ActionPerformed

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from culink where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getBranchgroup();
            saveallbranch();

        } catch (Exception e) {
        }

    }//GEN-LAST:event_btnok5ActionPerformed

    public void escfixbranch() {
        t_fixbranch.setText("");
        t_fixname.setText("");
        t_fixbranch.requestFocus();
    }

    public void escgpbranch() {
        t_fixbranch1.setText("");
        t_fixname1.setText("");
        t_fixbranch1.requestFocus();
    }

    private void t_fixbranchKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_fixbranchKeyPressed

        String get = t_fixbranch.getText();
        String out = get.toUpperCase();
        t_fixbranch.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            String Code;
            Code = t_fixbranch.getText();
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataFixBranch(cvth.ASCII2Unicode(Code));
            } else {
                GetDataFixBranch(Code);
            }
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnfixbranch();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escfixbranch();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_fixbranchKeyPressed

    private void btnbranchok1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchok1ActionPerformed

        if (tblbranch.getRowCount() > 0) {
            if (chkdatafixbranchingroup(t_fixbranch.getText())) {
                if (!chkdatafixbranch(t_fixbranch.getText(), t_code.getText())) {
                    if (chkdatabranchfile(t_fixbranch.getText())) {
                        btnsave();
                        if (chkdata(t_code.getText())) {
                            btnsavefixbranch();
                            getFixBranchList(t_code.getText());
                        }
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่มีข้อมูลสาขานี้ในระบบ..");
                    }
                } else {
                    JOptionPane.showMessageDialog(this, "ข้อมูลสาขานี้มีอยู่แล้ว..");
                }
            } else {
                JOptionPane.showMessageDialog(this, "สาขานี้ไม่มีในกลุ่มที่กำหนด..");
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดกลุ่มสาขาก่อน...");
        }
        escfixbranch();

        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchok1ActionPerformed

    public void btnfixbranch() {
        model3 = (DefaultTableModel) tblbranch.getModel();
        BrowserBranchmult list = new BrowserBranchmult(new NimbusFrame(), true, t_code.getText(), model3);
        list.setVisible(true);
        clearModel4();
        getFixBranchList(t_code.getText());
    }

    public void btngpbranch() {
        model3 = (DefaultTableModel) tblbranch.getModel();
        BrowserBranchmult6 list = new BrowserBranchmult6(new NimbusFrame(), true, t_code.getText(), model3);
        list.setVisible(true);
        clearModel6();
        getgpBranchList(t_code.getText());
    }

    private void btn_group2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group2ActionPerformed

        if (tblbranch.getRowCount() == 0) {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดกลุ่มสาขาก่อน...");
        } else {
            btnfixbranch();
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_btn_group2ActionPerformed

    private void t_gcodeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_gcodeKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            btngroupok.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_gcodeKeyPressed

    private void btnbranchcancle1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle1ActionPerformed

        escfixbranch();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchcancle1ActionPerformed

    private void tabMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tabMousePressed

        if (tab.getSelectedIndex() == 1) {

//            paneltable.setVisible(false);
//            paneltab2.setPreferredSize(new Dimension(1023, 625));
            t_plu.requestFocus();

        }
        if (tab.getSelectedIndex() == 0) {

//            paneltable.setVisible(true);
            t_barcode.requestFocus();

        }

    }//GEN-LAST:event_tabMousePressed

    private void btnpluokActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnpluokActionPerformed

        if (!t_code.getText().trim().equals("")) {

            String plu = t_plu.getText().trim();
            int tblPluSize = 0;
            if (model2 != null) {
                tblPluSize = model2.getRowCount();
            }
            boolean isFound = false;
            if (plu.length() > 0) {
                for (int i = 0; i < tblPluSize; i++) {
                    String search = (String) model2.getValueAt(i, 1);
                    if (plu.equals(search)) {
                        PUtility.ShowMsg("รายการสินค้านี้มีการกำหนดใว้แล้ว ...");
                        t_plu.setText("");
                        t_pluname.setText("");
                        isFound = true;
                        break;
                    }
                }

                if (!isFound) {
                    String[] product = addProductToCopon(plu);
                    if (product != null) {
                        if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                            if (chkdata(t_code.getText())) {
                                if (chkplu(t_code.getText(), t_plu.getText())) {
                                    btnsave();
                                    insertCuponList(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                                } else {
                                    PUtility.ShowMsg("รหัสสินค้า" + t_plu.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                                }
                            }
                        } else if (chkdata(t_code.getText())) {
                            if (chkplu(t_code.getText(), t_plu.getText())) {
                                btnsave();
                                insertCuponList(t_code.getText(), plu);
                            } else {
                                PUtility.ShowMsg("รหัสสินค้า " + t_plu.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                            }
                        }
                        getCuponList(t_code.getText());
                        t_plu.setText("");
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่พบรายการสินค้านี้");
                        t_plu.setText("");
                    }
                }
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดรหัสสินค้า..");
        }
        escplu();

        // TODO add your handling code here:
    }//GEN-LAST:event_btnpluokActionPerformed

    private void btn_group3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group3ActionPerformed

        listGroupfile dialog = new listGroupfile(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_gcode.setText(dialog.code);
                btngroupok.requestFocus();
            } else {
                t_plu.requestFocus();
            }
        } catch (Exception e) {
            t_plu.requestFocus();
        }

        // TODO add your handling code here:
    }//GEN-LAST:event_btn_group3ActionPerformed

    private void t_pluKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_pluKeyTyped

        if (t_plu.getText().length() >= 13) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_pluKeyTyped

    private void t_bcodeKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_bcodeKeyTyped

        if (t_bcode.getText().length() >= 3) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_bcodeKeyTyped

    private void t_fixbranchKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_fixbranchKeyTyped

        if (t_fixbranch.getText().length() >= 12) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_fixbranchKeyTyped

    private void tblpluMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblpluMousePressed
    }//GEN-LAST:event_tblpluMousePressed

    private void tblbranchMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblbranchMousePressed
    }//GEN-LAST:event_tblbranchMousePressed

    private void tblfixbranchMousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblfixbranchMousePressed
    }//GEN-LAST:event_tblfixbranchMousePressed

    private void btnbranchcancle2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle2ActionPerformed

        escplu();
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchcancle2ActionPerformed

    private void btnpluokKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnpluokKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escplu();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnpluokKeyPressed

    private void btnbranchokKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnbranchokKeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escbranch();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchokKeyPressed

    private void btnbranchok1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnbranchok1KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escfixbranch();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchok1KeyPressed

    private void rd2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rd2ActionPerformed
    }//GEN-LAST:event_rd2ActionPerformed

    private void jMenuItem7ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem7ActionPerformed

        try {
            int[] intArray = tblplu.getSelectedRows();

            for (int i = 0; i < intArray.length; i++) {
                String plu2 = tblplu.getValueAt(intArray[i], 1).toString();
                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from cuponlist where PCode ='" + plu2 + "' and CuCode = '" + t_code.getText() + "'";
                stmt.executeUpdate(sql2);
                stmt.close();
            }
        } catch (Exception e) {
        }
        getCuponList(t_code.getText());

        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem7ActionPerformed

    private void jMenuItem6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem6ActionPerformed

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from cuponlist where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getCuponList(t_code.getText());
        } catch (Exception e) {
        }

    }//GEN-LAST:event_jMenuItem6ActionPerformed

    private void jMenuItem8ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem8ActionPerformed

        try {
            if (tblbranch.getSelectedRowCount() > 0) {
                int[] intArray = tblbranch.getSelectedRows();
                for (int s = 0; s < intArray.length; s++) {
                    String Tempbgroup = tblbranch.getValueAt(intArray[s], 0).toString();
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "delete from culink where bgroup = '" + Tempbgroup + "' and CuCode = '" + t_code.getText() + "'";
                    stmt.executeUpdate(sql2);
                    stmt.close();
                }
            }
        } catch (Exception e) {
        }
        getBranchList(t_code.getText());
        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem8ActionPerformed

    private void jMenuItem9ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem9ActionPerformed

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "delete from culink where cucode = '" + t_code.getText() + "'";
            stmt.executeUpdate(sql2);
            stmt.close();
        } catch (Exception e) {
        }
        getBranchList(t_code.getText());

        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem9ActionPerformed

    private void jMenuItem10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem10ActionPerformed

        try {

            int[] intArray = new int[tblfixbranch.getRowCount()];
            for (int i = 0; i < tblfixbranch.getRowCount(); i++) {
                intArray = tblfixbranch.getSelectedRows();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from fixbranch where bcode = ? and CuCode = '" + t_code.getText() + "'";
                PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                prm2.setString(1, tblfixbranch.getValueAt(intArray[i], 1).toString());
                prm2.executeUpdate();
                stmt.close();

            }

        } catch (Exception e) {
        }

        getFixBranchList(t_code.getText());
        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem10ActionPerformed

    private void jMenuItem11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem11ActionPerformed

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from fixbranch where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getFixBranchList(t_code.getText());
        } catch (Exception e) {
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem11ActionPerformed

    private void t_codeKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_codeKeyTyped

        if (t_code.getText().length() >= 6) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_codeKeyTyped

    private void t_barcodeKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_barcodeKeyTyped

        if (t_barcode.getText().length() >= 8) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_barcodeKeyTyped

    private void t_nameKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_nameKeyTyped

        if (t_name.getText().length() >= 30) {
            evt.consume();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_nameKeyTyped

    private void t_date1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date1KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_date2.requestFocus();
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            DateUtil.showDateChooserDialog(t_date1, btn_Calendar);
            t_date1.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1KeyPressed

    private void t_date2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_date2KeyPressed

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_buymin.requestFocus();
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            DateUtil.showDateChooserDialog(t_date2, btn_Calendar1);
            t_date2.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date2KeyPressed

    private void t_discountperKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_discountperKeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountperKeyTyped

    private void t_discountperFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_discountperFocusGained

        t_discountper.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountperFocusGained

    private void t_discountbathFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_discountbathFocusGained

        t_discountbath.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountbathFocusGained

    private void t_buyminFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_buyminFocusGained

        t_buymin.selectAll();
        // TODO add your handling code here:
    }//GEN-LAST:event_t_buyminFocusGained

    private void t_discountperFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_discountperFocusLost

        double disper = Double.parseDouble(t_discountper.getValue().toString());
        if (disper > 100) {
            JOptionPane.showMessageDialog(this, "ส่วนลดห้ามเกิน 100%");
            t_discountper.setText("0.00");
            t_discountper.requestFocus();
        }
        // TODO add your handling code here:
    }//GEN-LAST:event_t_discountperFocusLost

    private void btnfindcampaignActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnfindcampaignActionPerformed
        // TODO add your handling code here:
        listCampaign dialog = new listCampaign(new NimbusFrame(), true);
        dialog.setVisible(true);
        try {
            if (!dialog.bcode.equals("")) {
                campaign_code.setText(dialog.bcode);
                campaign_code.requestFocus();
            } else {
                campaign_code.requestFocus();
            }
        } catch (Exception e) {
            campaign_code.requestFocus();
        }
    }//GEN-LAST:event_btnfindcampaignActionPerformed

    private void btnfindcampaignKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnfindcampaignKeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnfindcampaignKeyPressed

    private void tblCuponMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblCuponMouseClicked
        // TODO add your handling code here:
        int indexrow = tblCupon.getSelectedRow();
        String TempCode = tblCupon.getValueAt(indexrow, 0).toString();
        String TempCampaign = PUtility.getcampaigncode2(TempCode);
        lbcampaign.setText("เคมเปญ... " + TempCampaign + "-" + PUtility.getcampaignname(TempCampaign));
    }//GEN-LAST:event_tblCuponMouseClicked

    private void tblCuponKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tblCuponKeyPressed
        // TODO add your handling code here:
        if ((evt.getKeyCode() == KeyEvent.VK_UP) || (evt.getKeyCode() == KeyEvent.VK_DOWN)) {
            int indexrow = tblCupon.getSelectedRow();
            String TempCode = tblCupon.getValueAt(indexrow, 0).toString();
            String TempCampaign = PUtility.getcampaigncode2(TempCode);
            lbcampaign.setText("เคมเปญ... " + TempCampaign + "-" + PUtility.getcampaignname(TempCampaign));
        }
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            int indexrow = tblCupon.getSelectedRow();
            String TempCode = tblCupon.getValueAt(indexrow, 0).toString();
            t_code.setText(TempCode);
            if (!t_code.getText().trim().equals("")) {
                if (chkdata(t_code.getText())) {
                    String Code = "";
                    Code = t_code.getText().trim();
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        GetData(cvth.Unicode2ASCII(Code));
                    } else {
                        GetData(Code);
                    }
                } else {
                    setActive();
                    t_code.setBackground(new java.awt.Color(255, 246, 143));
                    t_code.setEditable(false);

                }
                tab.setEnabledAt(1, true);
            }
            campaign_code.requestFocus();

        }
    }//GEN-LAST:event_tblCuponKeyPressed

    private void campaign_codeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_campaign_codeFocusLost
        // TODO add your handling code here:
        campaign_name.setText(PUtility.getcampaignname(campaign_code.getText()));
    }//GEN-LAST:event_campaign_codeFocusLost

    private void campaign_codeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_campaign_codeKeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_name.requestFocus();
        }
    }//GEN-LAST:event_campaign_codeKeyPressed

    private void t_cntKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_cntKeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_name.requestFocus();
        }
    }//GEN-LAST:event_t_cntKeyPressed

    private void campaignlistActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_campaignlistActionPerformed
        // TODO add your handling code here:
        if (rdactive1.isSelected()) {
            showdataintb();
        } else {
            chkactive(Format.dateFmtSql.format(new java.util.Date()));
        }
    }//GEN-LAST:event_campaignlistActionPerformed

    private void t_cutimeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutimeFocusGained
        // TODO add your handling code here:
        t_cutime.selectAll();
    }//GEN-LAST:event_t_cutimeFocusGained

    private void t_cutimeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutimeFocusLost
        // TODO add your handling code here:
        String ArrayStr[] = t_cutime.getText().split(":");

        int timehr = Integer.parseInt(ArrayStr[0]);
        int timemm = Integer.parseInt(ArrayStr[1]);
        if (timehr > 24 | timemm > 60) {
            JOptionPane.showMessageDialog(this, "เวลาไม่ถูกต้อง");
        }
    }//GEN-LAST:event_t_cutimeFocusLost

    private void t_cutime2FocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutime2FocusGained
        // TODO add your handling code here:
        t_cutime2.selectAll();
    }//GEN-LAST:event_t_cutime2FocusGained

    private void t_cutime2FocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_cutime2FocusLost
        // TODO add your handling code here:
        String ArrayStr[] = t_cutime2.getText().split(":");

        int timehr = Integer.parseInt(ArrayStr[0]);
        int timemm = Integer.parseInt(ArrayStr[1]);
        if (timehr > 24 | timemm > 60) {
            JOptionPane.showMessageDialog(this, "เวลาไม่ถูกต้อง");
        }
    }//GEN-LAST:event_t_cutime2FocusLost

    private void formWindowOpened(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_formWindowOpened
        t_code.requestFocus();
        // TODO add your handling code here:
    }//GEN-LAST:event_formWindowOpened

    private void t_date1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_t_date1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_t_date1ActionPerformed

    private void btn_plu1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_plu1ActionPerformed
        // TODO add your handling code here:
        btnplu1();
    }//GEN-LAST:event_btn_plu1ActionPerformed

    private void t_plu1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_plu1KeyPressed
        // TODO add your handling code here:
        String get = t_plu1.getText();
        String out = get.toUpperCase();
        t_plu1.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataplu1(cvth.Unicode2ASCII(t_plu1.getText()));
            } else {
                GetDataplu1(t_plu1.getText());
            }

        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btnplu1();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escplu1();
        }
    }//GEN-LAST:event_t_plu1KeyPressed

    private void t_plu1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_plu1KeyTyped
        // TODO add your handling code here:
        if (t_plu1.getText().length() >= 13) {
            evt.consume();
        }
    }//GEN-LAST:event_t_plu1KeyTyped

    private void btnpluok1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnpluok1ActionPerformed
        // TODO add your handling code here:
        if (!t_code.getText().trim().equals("")) {

            String plu = t_plu1.getText().trim();
            int tblPluSize = 0;
            if (model5 != null) {
                tblPluSize = model5.getRowCount();
            }
            boolean isFound = false;
            if (plu.length() > 0) {
                for (int i = 0; i < tblPluSize; i++) {
                    String search = (String) model5.getValueAt(i, 1);
                    if (plu.equals(search)) {
                        PUtility.ShowMsg("รายการสินค้านี้มีการกำหนดใว้แล้ว ...");
                        t_plu1.setText("");
                        t_pluname1.setText("");
                        isFound = true;
                        break;
                    }
                }

                if (!isFound) {
                    String[] product = addProductToCopon(plu);
                    if (product != null) {
                        if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                            if (chkdata(t_code.getText())) {
                                if (chkplu(t_code.getText(), t_plu1.getText())) {
                                    btnsave();
                                    insertCuponList1(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                                } else {
                                    PUtility.ShowMsg("รหัสสินค้า" + t_plu1.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                                }
                            }
                        } else if (chkdata(t_code.getText())) {
                            if (chkplu(t_code.getText(), t_plu1.getText())) {
                                btnsave();
                                insertCuponList1(t_code.getText(), plu);
                            } else {
                                PUtility.ShowMsg("รหัสสินค้า " + t_plu1.getText() + " ไม่อยู่ในกลุ่มสาขาที่สามารถ กำหนดได้ ..");
                            }
                        }
                        getCuponUnList(t_code.getText());
                        t_plu1.setText("");
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่พบรายการสินค้านี้");
                        t_plu1.setText("");
                    }
                }
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดรหัสสินค้า..");
        }
        escplu1();
    }//GEN-LAST:event_btnpluok1ActionPerformed

    private void btnpluok1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnpluok1KeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnpluok1KeyPressed

    private void btnbranchcancle3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle3ActionPerformed
        // TODO add your handling code here:
        escplu1();
    }//GEN-LAST:event_btnbranchcancle3ActionPerformed

    private void tblplu1MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblplu1MousePressed
        // TODO add your handling code here:
    }//GEN-LAST:event_tblplu1MousePressed

    private void t_gcode1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_gcode1KeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            btngroupok1.requestFocus();
        }
    }//GEN-LAST:event_t_gcode1KeyPressed

    private void btngroupok1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btngroupok1ActionPerformed
        // TODO add your handling code here:
        if (!t_gcode1.getText().trim().equals("")) {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการเพิ่มข้อมูลกลุ่มสินค้า " + t_gcode1.getText() + " ทั้งหมดใช่หรือไม่", "Confirm", JOptionPane.YES_NO_OPTION);

            if (confirm == JOptionPane.YES_OPTION) {
                String code = t_gcode1.getText().trim();
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup1(cvth.Unicode2ASCII(code));
                    }
                } else {
                    btnsave();
                    if (chkdata(t_code.getText())) {
                        getProductGroup1(code);
                    }
                }
                t_gcode1.setText("");
                t_plu1.requestFocus();

            }
            getCuponUnList(t_code.getText());
        }
    }//GEN-LAST:event_btngroupok1ActionPerformed

    private void btn_group4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group4ActionPerformed
        // TODO add your handling code here:
        listGroupfile dialog = new listGroupfile(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_gcode1.setText(dialog.code);
                btngroupok1.requestFocus();
            } else {
                t_plu1.requestFocus();
            }
        } catch (Exception e) {
            t_plu1.requestFocus();
        }
    }//GEN-LAST:event_btn_group4ActionPerformed

    private void jMenuItem12ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem12ActionPerformed
        // TODO add your handling code here:
        try {
            int[] intArray = tblplu1.getSelectedRows();

            for (int i = 0; i < intArray.length; i++) {
                String plu2 = tblplu1.getValueAt(intArray[i], 1).toString();
                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from cuponunlist where PCode ='" + plu2 + "' and CuCode = '" + t_code.getText() + "'";
                stmt.executeUpdate(sql2);
                stmt.close();
            }
        } catch (Exception e) {
        }
        getCuponUnList(t_code.getText());
    }//GEN-LAST:event_jMenuItem12ActionPerformed

    private void jMenuItem13ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem13ActionPerformed
        // TODO add your handling code here:
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from cuponunlist where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getCuponUnList(t_code.getText());
        } catch (Exception e) {
        }
    }//GEN-LAST:event_jMenuItem13ActionPerformed

    private void tblfixbranch1MousePressed(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblfixbranch1MousePressed
        // TODO add your handling code here:
    }//GEN-LAST:event_tblfixbranch1MousePressed

    private void btnbranchok2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchok2ActionPerformed
        // TODO add your handling code here:
        if (tblbranch.getRowCount() > 0) {
            if (chkdatafixbranchingroup(t_fixbranch1.getText())) {
                if (!chkdatagpbranch(t_fixbranch1.getText(), t_code.getText())) {
                    if (chkdatabranchfile(t_fixbranch1.getText())) {
                        btnsave();
                        if (chkdata(t_code.getText())) {
                            btnsavegpbranch();
                            getgpBranchList(t_code.getText());
                        }
                    } else {
                        JOptionPane.showMessageDialog(this, "ไม่มีข้อมูลสาขานี้ในระบบ..");
                    }
                } else {
                    JOptionPane.showMessageDialog(this, "ข้อมูลสาขานี้มีอยู่แล้ว..");
                }
            } else {
                JOptionPane.showMessageDialog(this, "สาขานี้ไม่มีในกลุ่มที่กำหนด..");
            }
        } else {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดกลุ่มสาขาก่อน...");
        }
        escgpbranch();
    }//GEN-LAST:event_btnbranchok2ActionPerformed

    private void btnbranchok2KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnbranchok2KeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escgpbranch();
        }
    }//GEN-LAST:event_btnbranchok2KeyPressed

    private void t_fixbranch1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_fixbranch1KeyPressed
        // TODO add your handling code here:
        String get = t_fixbranch1.getText();
        String out = get.toUpperCase();
        t_fixbranch1.setText(out);

        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            String Code;
            Code = t_fixbranch1.getText();
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataGPBranch(cvth.ASCII2Unicode(Code));
            } else {
                GetDataGPBranch(Code);
            }
        }
        if (evt.getKeyCode() == KeyEvent.VK_F1) {
            btngpbranch();
        }
        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escgpbranch();
        }
    }//GEN-LAST:event_t_fixbranch1KeyPressed

    private void t_fixbranch1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_fixbranch1KeyTyped
        // TODO add your handling code here:
        if (t_fixbranch1.getText().length() >= 12) {
            evt.consume();
        }
    }//GEN-LAST:event_t_fixbranch1KeyTyped

    private void btn_group5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group5ActionPerformed
        // TODO add your handling code here:
        if (tblbranch.getRowCount() == 0) {
            JOptionPane.showMessageDialog(this, "กรุณากำหนดกลุ่มสาขาก่อน...");
        } else {
            btngpbranch();
        }
    }//GEN-LAST:event_btn_group5ActionPerformed

    private void btnbranchcancle4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle4ActionPerformed
        // TODO add your handling code here:
        escgpbranch();
    }//GEN-LAST:event_btnbranchcancle4ActionPerformed

    private void jMenuItem14ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem14ActionPerformed
        // TODO add your handling code here:
        try {

            int[] intArray = new int[tblfixbranch1.getRowCount()];
            for (int i = 0; i < tblfixbranch1.getRowCount(); i++) {
                intArray = tblfixbranch1.getSelectedRows();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from fixgpcoupon where bcode = ? and CuCode = '" + t_code.getText() + "'";
                PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                prm2.setString(1, tblfixbranch1.getValueAt(intArray[i], 1).toString());
                prm2.executeUpdate();
                stmt.close();

            }

        } catch (Exception e) {
        }

        getgpBranchList(t_code.getText());
    }//GEN-LAST:event_jMenuItem14ActionPerformed

    private void jMenuItem15ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem15ActionPerformed
        // TODO add your handling code here:
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "Delete from fixgpcoupon where CuCode = ?";
            PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
            prm2.setString(1, t_code.getText());
            prm2.executeUpdate();
            stmt.close();
            getgpBranchList(t_code.getText());
        } catch (Exception e) {
        }
    }//GEN-LAST:event_jMenuItem15ActionPerformed

    private void t_bcode1KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_bcode1KeyPressed
        // TODO add your handling code here:
        String get = t_bcode1.getText();
        String out = get.toUpperCase();
        t_bcode1.setText(out);
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            String Code = "";
            Code = t_bcode1.getText();
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                GetDataBranch(cvth.ASCII2Unicode(Code));
                btnbranchok1.requestFocus();
            } else {
                GetDataBranch(Code);
                btnbranchok1.requestFocus();
            }
        }

        if (evt.getKeyCode() == KeyEvent.VK_ESCAPE) {
            escbranch1();
        }
    }//GEN-LAST:event_t_bcode1KeyPressed

    private void t_bcode1KeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_bcode1KeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_t_bcode1KeyTyped

    private void btn_group1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_group1ActionPerformed
        // TODO add your handling code here:
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        BrowserBranchGroup dialog = new BrowserBranchGroup(new NimbusFrame(), true, point);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                BranchCodeName hrb = dialog.getDataRecord();
                t_bcode1.setText(dialog.code);
                GetDataBranch1(dialog.code);
                btnbranchok1.requestFocus();
            } else {
                t_bcode1.requestFocus();
            }
        } catch (Exception e) {
            t_bcode1.requestFocus();
        }
    }//GEN-LAST:event_btn_group1ActionPerformed

    private void btnbranchcancle5ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchcancle5ActionPerformed
        // TODO add your handling code here:
        escbranch1();
    }//GEN-LAST:event_btnbranchcancle5ActionPerformed

    private void btnbranchok3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnbranchok3ActionPerformed
        // TODO add your handling code here:
        if (chkdatabranchgroup(t_bcode1.getText())) {
            if (chkdataingroup(t_bcode1.getText())) {
                try {
                    ResultSet rs = null;
                    stmt = (com.mysql.jdbc.Statement) db.con.createStatement();
                    String sql = "select * from branfile  where bgroup ='" + t_bcode1.getText() + "' and pactive='Y' ";
                    rs = stmt.executeQuery(sql);
                    rs.first();
                    if (rs.getRow() == 0) {
                    } else {
                        do {
                            String TempCode = rs.getString("code");
                            if (!chkdatagpbranch(TempCode, t_code.getText())) {
                                if (chkdatabranchfile(TempCode)) {
                                    btnsave();
                                    if (chkdata(t_code.getText())) {
                                        btnsavegpbranch(TempCode);
                                        getgpBranchList(t_code.getText());
                                    }
                                } else {
                                    JOptionPane.showMessageDialog(this, "ไม่มีข้อมูลสาขานี้ในระบบ..");
                                }
                            }
                        } while (rs.next());
                    }

                } catch (Exception e) {
                    JOptionPane.showMessageDialog(this, e);
                }
            } else {
                JOptionPane.showMessageDialog(this, "Branch Group ไม่อยู่ในกลุ่ม ");
            }

        } else {
            JOptionPane.showMessageDialog(this, "ไม่มีข้อมูล BranchGroup นี้ในระบบ..");
        }
        escbranch1();
    }//GEN-LAST:event_btnbranchok3ActionPerformed

    private void btnbranchok3KeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_btnbranchok3KeyPressed
        // TODO add your handling code here:
    }//GEN-LAST:event_btnbranchok3KeyPressed

    private void t_maisensaleFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_maisensaleFocusGained
        // TODO add your handling code here:
        t_maisensale.selectAll();
    }//GEN-LAST:event_t_maisensaleFocusGained

    private void t_maisensaleKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_maisensaleKeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_maisenfree.requestFocus();
        }
    }//GEN-LAST:event_t_maisensaleKeyPressed

    private void t_maisenfreeFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_t_maisenfreeFocusGained
        // TODO add your handling code here:
        t_maisenfree.selectAll();
    }//GEN-LAST:event_t_maisenfreeFocusGained

    private void t_maisenfreeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_t_maisenfreeKeyPressed
        // TODO add your handling code here:
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            t_discountper.requestFocus();
        }
    }//GEN-LAST:event_t_maisenfreeKeyPressed

    private void txt_dateexceptKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txt_dateexceptKeyPressed
        if (evt.getKeyCode() == evt.VK_ENTER) {
            if (txt_dateexcept.getText().length() <= 0) {
                JOptionPane.showMessageDialog(null, "กรุณาระบบุวันที่ที่ต้องการ...");
                txt_dateexcept.requestFocus();
                return;
            }
        }
    }//GEN-LAST:event_txt_dateexceptKeyPressed
    private boolean checkDate() {
        boolean chkDate = false;
        try {
            expdate = convertDateshowToSQL(txt_dateexcept.getText().trim());
            chkDate = true;
        } catch (Exception e) {
            e.printStackTrace();
        }
        return chkDate;
    }

    private void addExceptdate() {
        if (checkDate()) {
            java.util.Date time1;
            String date1 = "";
            try {
                time1 = Format.dateFmtShow.parse(txt_dateexcept.getText());
                date1 = Format.dateFmtSql.format(time1);
            } catch (Exception ex) {
                date1 = "1900-01-01";
            }
            try {
                String sql = "select * from cuponfixdate where cucode=? and fixdate=? ";
                String ins = "insert into cuponfixdate(fixdate, cucode) values(?,?)";
                pre = dbUtility.con.prepareStatement(sql);
                pre.setString(1, t_code.getText());
                pre.setString(2, date1);
                rs = pre.executeQuery();
                rs.first();
                if (rs.getRow() != 0) {
                    txt_dateexcept.setText("");
                    txt_dateexcept.requestFocus();
                } else {
                    preUp = dbUtility.con.prepareStatement(ins);
                    preUp.setString(1, date1);
                    preUp.setString(2, t_code.getText());
                    preUp.executeUpdate();
                }
                txt_dateexcept.setText("");
                txt_dateexcept.requestFocus();
                loadExceptdate(t_code.getText());
            } catch (Exception e) {
            } finally {
                try {
                    if (pre != null) {
                        pre.close();
                        pre = null;
                    }
                    if (preUp != null) {
                        preUp.close();
                        preUp = null;
                    }
                    if (rs != null) {
                        rs.close();
                        rs = null;
                    }
                } catch (Exception e) {
                    JOptionPane.showMessageDialog(null, e.getMessage());
                }
            }
        } else {
            JOptionPane.showMessageDialog(null, "กรุณาระบุวันที่ให้ถูกต้อง เช่น 01/01/2009");
            txt_dateexcept.requestFocus();
            txt_dateexcept.selectAll();
        }
    }

    private void loadExceptdate(String procode) {
        tbl_excdate.setShowGrid(true);
        tbl_excdate.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tbl_excdate.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tbl_excdate.setRowSelectionAllowed(true);
        tbl_excdate.setBackground(java.awt.Color.WHITE);
        tbl_excdate.setGridColor(java.awt.Color.gray);
        tbl_excdate.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION); // select row (shift + row or ctrl + row)

        ((DefaultTableCellRenderer) tbl_excdate.getTableHeader().getDefaultRenderer()).setHorizontalAlignment(JLabel.CENTER);

        TableColumnModel tcm = tbl_excdate.getColumnModel();
        DefaultTableCellRenderer d;
        JTableHeader header = tbl_excdate.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.BOLD, 14));
        tbl_excdate.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tbl_excdate.setRowHeight(25);

        d = new DefaultTableCellRenderer();
        d.setHorizontalAlignment(SwingConstants.CENTER);
        tcm.getColumn(0).setCellRenderer(d);

        model6 = (DefaultTableModel) tbl_excdate.getModel();
        int rowCount = model6.getRowCount();
        for (int i = 0; i < rowCount; i++) {
            model6.removeRow(0);
        }

        try {
            String sql = "select * from cuponfixdate where cucode=? order by fixdate";
            pre = dbUtility.con.prepareStatement(sql);
            pre.setString(1, procode);
            rs = pre.executeQuery();
            rs.first();
            if (rs.getRow() != 0) {
                do {
                    model6.addRow(new Object[]{
                        Format.dateFmtShow.format(rs.getDate("fixdate"))
                    });
                } while (rs.next());
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e.getMessage());
        } finally {
            try {
                if (pre != null) {
                    pre.close();
                    pre = null;
                }
                if (rs != null) {
                    rs.close();
                    rs = null;
                }
            } catch (Exception e) {
            }
        }
    }
    private void btn_dateExcActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_dateExcActionPerformed
        DateUtil.showDateChooserDialog(txt_dateexcept, btn_dateExc);
    }//GEN-LAST:event_btn_dateExcActionPerformed

    private void bntok6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bntok6ActionPerformed
        addExceptdate();
    }//GEN-LAST:event_bntok6ActionPerformed

    private void bntcancel6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bntcancel6ActionPerformed
        txt_dateexcept.setText("");
    }//GEN-LAST:event_bntcancel6ActionPerformed

    private void jMenuItem16ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem16ActionPerformed
        deleteExcdate();
    }//GEN-LAST:event_jMenuItem16ActionPerformed

    private void jMenuItem17ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem17ActionPerformed
        deleteExcdateAll();
    }//GEN-LAST:event_jMenuItem17ActionPerformed
    private void deleteExcdate() {
        String procode = t_code.getText().trim();
        String excdate = "";
        int[] selectedRow = tbl_excdate.getSelectedRows();
        try {
            String sql = "delete from cuponfixdate where cucode=? and fixdate=?";

            for (int i = selectedRow.length - 1; i >= 0; i--) {
                int row = selectedRow[i];
                excdate = convertDateshowToSQL(tbl_excdate.getValueAt(row, 0).toString());
                pre = dbUtility.con.prepareStatement(sql);
                pre.setString(1, procode);
                pre.setString(2, excdate);
                pre.executeUpdate();
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e.getMessage());
        } finally {
            try {
                if (pre != null) {
                    pre.close();
                    pre = null;
                }
                if (pre != null) {
                    pre.close();
                    pre = null;
                }
                if (rs != null) {
                    rs.close();
                    rs = null;
                }
            } catch (Exception e) {
            }
        }
        loadExceptdate(procode);
    }

    private void deleteExcdateAll() {
        String procode = t_code.getText().trim();
        String sql = "delete from cuponfixdate where cucode=?";
        try {
            pre = dbUtility.con.prepareStatement(sql);
            pre.setString(1, procode);
            pre.executeUpdate();

        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e.getMessage());
        } finally {
            try {
                if (pre != null) {
                    pre.close();
                    pre = null;
                }
                if (pre != null) {
                    pre.close();
                    pre = null;
                }
                if (rs != null) {
                    rs.close();
                    rs = null;
                }
            } catch (Exception e) {
            }
        }
        loadExceptdate(procode);
    }

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /*
         * Set the Nimbus look and feel
         */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /*
         * If Nimbus (introduced in Java SE 6) is not available, stay with the
         * default look and feel. For details see
         * http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;

                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(SpacialCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(SpacialCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(SpacialCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(SpacialCouponSetup.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /*
         * Create and display the dialog
         */
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                SpacialCouponSetup dialog = new SpacialCouponSetup(new javax.swing.JFrame(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {

                    @Override
                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JCheckBox T2PBrithday;
    private javax.swing.JCheckBox T2POffline;
    private javax.swing.JButton bntcancel6;
    private javax.swing.JButton bntok6;
    private javax.swing.JPopupMenu branch;
    private javax.swing.JButton btnCancel;
    private javax.swing.JButton btnDelete;
    private javax.swing.JButton btnNew;
    private javax.swing.JButton btnSave;
    private javax.swing.JButton btn_Calendar;
    private javax.swing.JButton btn_Calendar1;
    private javax.swing.JButton btn_dateExc;
    private javax.swing.JButton btn_group;
    private javax.swing.JButton btn_group1;
    private javax.swing.JButton btn_group2;
    private javax.swing.JButton btn_group3;
    private javax.swing.JButton btn_group4;
    private javax.swing.JButton btn_group5;
    private javax.swing.JButton btn_plu;
    private javax.swing.JButton btn_plu1;
    private javax.swing.JButton btnbranchcancle;
    private javax.swing.JButton btnbranchcancle1;
    private javax.swing.JButton btnbranchcancle2;
    private javax.swing.JButton btnbranchcancle3;
    private javax.swing.JButton btnbranchcancle4;
    private javax.swing.JButton btnbranchcancle5;
    private javax.swing.JButton btnbranchok;
    private javax.swing.JButton btnbranchok1;
    private javax.swing.JButton btnbranchok2;
    private javax.swing.JButton btnbranchok3;
    private javax.swing.JButton btnfindcampaign;
    private javax.swing.JButton btngroupok;
    private javax.swing.JButton btngroupok1;
    private javax.swing.JButton btnok5;
    private javax.swing.JButton btnpluok;
    private javax.swing.JButton btnpluok1;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.ButtonGroup buttonGroup2;
    private javax.swing.ButtonGroup buttonGroup3;
    private javax.swing.ButtonGroup buttonGroup4;
    private javax.swing.ButtonGroup buttonGroup5;
    private javax.swing.ButtonGroup buttonGroup6;
    private javax.swing.ButtonGroup buttonGroup7;
    private javax.swing.JCheckBox c1;
    private javax.swing.JCheckBox c2;
    private javax.swing.JCheckBox c3;
    private javax.swing.JCheckBox c4;
    private javax.swing.JCheckBox c5;
    private javax.swing.JCheckBox c6;
    private javax.swing.JCheckBox c7;
    private javax.swing.JTextField campaign_code;
    private javax.swing.JTextField campaign_name;
    private javax.swing.JComboBox campaignlist;
    private javax.swing.JComboBox chMember;
    private javax.swing.JCheckBox chkminall;
    private javax.swing.JPopupMenu fixbranch;
    private javax.swing.JPopupMenu fixbranch1;
    private javax.swing.JButton jButton6;
    private javax.swing.JButton jButton7;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel63;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JLayeredPane jLayeredPane1;
    private javax.swing.JMenu jMenu1;
    private javax.swing.JMenuBar jMenuBar1;
    private javax.swing.JMenuItem jMenuItem10;
    private javax.swing.JMenuItem jMenuItem11;
    private javax.swing.JMenuItem jMenuItem12;
    private javax.swing.JMenuItem jMenuItem13;
    private javax.swing.JMenuItem jMenuItem14;
    private javax.swing.JMenuItem jMenuItem15;
    private javax.swing.JMenuItem jMenuItem16;
    private javax.swing.JMenuItem jMenuItem17;
    private javax.swing.JMenuItem jMenuItem6;
    private javax.swing.JMenuItem jMenuItem7;
    private javax.swing.JMenuItem jMenuItem8;
    private javax.swing.JMenuItem jMenuItem9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel18;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel20;
    private javax.swing.JPanel jPanel21;
    private javax.swing.JPanel jPanel22;
    private javax.swing.JPanel jPanel23;
    private javax.swing.JPanel jPanel24;
    private javax.swing.JPanel jPanel25;
    private javax.swing.JPanel jPanel26;
    private javax.swing.JPanel jPanel27;
    private javax.swing.JPanel jPanel28;
    private javax.swing.JPanel jPanel29;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel30;
    private javax.swing.JPanel jPanel31;
    private javax.swing.JPanel jPanel32;
    private javax.swing.JPanel jPanel33;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JPopupMenu.Separator jSeparator1;
    private javax.swing.JLabel lbcampaign;
    private javax.swing.JCheckBox maisenmemberday;
    private javax.swing.JMenuItem menuCancel;
    private javax.swing.JMenuItem menuDelete;
    private javax.swing.JMenuItem menuExit;
    private javax.swing.JMenuItem menuNew;
    private javax.swing.JMenuItem menuSave;
    private javax.swing.JPanel paneltab2;
    private javax.swing.JPanel paneltable;
    private javax.swing.JPopupMenu plu;
    private javax.swing.JPopupMenu plu1;
    private javax.swing.JPopupMenu popdeleteexceptdate;
    private javax.swing.JRadioButton rd1;
    private javax.swing.JRadioButton rd2;
    private javax.swing.JRadioButton rdDiscount;
    private javax.swing.JRadioButton rdService;
    private javax.swing.JRadioButton rdactive1;
    private javax.swing.JRadioButton rdactive2;
    private javax.swing.JRadioButton rdnDiscount;
    private javax.swing.JRadioButton rdnService;
    private javax.swing.JRadioButton rdnauto;
    private javax.swing.JRadioButton rdnmulti;
    private javax.swing.JRadioButton rdnother;
    private javax.swing.JRadioButton rdyauto;
    private javax.swing.JRadioButton rdymulti;
    private javax.swing.JRadioButton rdyother;
    private javax.swing.JTextField strDay;
    private javax.swing.JTextField strtype;
    private javax.swing.JTextField t_barcode;
    private javax.swing.JTextField t_bcode;
    private javax.swing.JTextField t_bcode1;
    private javax.swing.JTextField t_bname;
    private javax.swing.JTextField t_bname1;
    private javax.swing.JFormattedTextField t_buymin;
    private javax.swing.JFormattedTextField t_cnt;
    private javax.swing.JTextField t_code;
    private javax.swing.JTextField t_code2;
    private javax.swing.JTextField t_code3;
    private javax.swing.JLabel t_count1;
    private javax.swing.JFormattedTextField t_cutime;
    private javax.swing.JFormattedTextField t_cutime2;
    private javax.swing.JFormattedTextField t_date1;
    private javax.swing.JFormattedTextField t_date2;
    private javax.swing.JFormattedTextField t_discountbath;
    private javax.swing.JFormattedTextField t_discountper;
    private javax.swing.JTextField t_fixbranch;
    private javax.swing.JTextField t_fixbranch1;
    private javax.swing.JTextField t_fixname;
    private javax.swing.JTextField t_fixname1;
    private javax.swing.JTextField t_gcode;
    private javax.swing.JTextField t_gcode1;
    private javax.swing.JFormattedTextField t_maisenfree;
    private javax.swing.JFormattedTextField t_maisensale;
    private javax.swing.JTextField t_name;
    private javax.swing.JTextField t_plu;
    private javax.swing.JTextField t_plu1;
    private javax.swing.JTextField t_pluname;
    private javax.swing.JTextField t_pluname1;
    private javax.swing.JTabbedPane tab;
    private javax.swing.JTable tblCupon;
    private javax.swing.JTable tbl_excdate;
    private javax.swing.JTable tblbranch;
    private javax.swing.JTable tblfixbranch;
    private javax.swing.JTable tblfixbranch1;
    private javax.swing.JTable tblplu;
    private javax.swing.JTable tblplu1;
    private javax.swing.JCheckBox td1;
    private javax.swing.JCheckBox te1;
    private javax.swing.JCheckBox tp1;
    private javax.swing.JCheckBox tt1;
    private javax.swing.JCheckBox tw1;
    private javax.swing.JTextField txt_dateexcept;
    // End of variables declaration//GEN-END:variables

    public void showdataintb() {
        tblCupon.setShowGrid(true);
        tblCupon.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblCupon.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        tblCupon.setRowSelectionAllowed(true);
        tblCupon.setBackground(java.awt.Color.WHITE);
        tblCupon.setGridColor(java.awt.Color.gray);

        TableColumnModel tcm = tblCupon.getColumnModel();
        DefaultTableCellRenderer d;
        JTableHeader header = tblCupon.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblCupon.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblCupon.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model = (DefaultTableModel) tblCupon.getModel();
        int cnt = model.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model.removeRow(0);
            }
        }
        // Check Selected campain
        String TempStr = "";
        if (campaignlist.getSelectedItem() == null) {
            SelectedCampain = "ALL";
        } else {
            TempStr = campaignlist.getSelectedItem().toString();
            String ArrayStr[] = TempStr.split("-");
            SelectedCampain = ArrayStr[0];
        }
        try {
            String sql = "";
            stmt = (Statement) dbUtility.con.createStatement();
            if (SelectedCampain.equals("ALL")) {
                sql = "SELECT * FROM cupon order by CuCode";
            } else {
                sql = "SELECT * FROM cupon where campaign_code='" + SelectedCampain + "' order by CuCode";
            }
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("CuCode")),
                            cvth.ASCII2Unicode(rs.getString("CuBarCode")),
                            cvth.ASCII2Unicode(rs.getString("CuName")),
                            cvth.ASCII2Unicode(Format.dateFmtShow.format(rs.getDate("CuBegin"))) + " - " + (Format.dateFmtShow.format(rs.getDate("CuEnd"))),
                            cvth.ASCII2Unicode(rs.getString("CuStrDay")),
                            cvth.ASCII2Unicode(rs.getString("CuSaleType")),
                            cvth.ASCII2Unicode(rs.getString("reduleDiscount")),
                            cvth.ASCII2Unicode(rs.getString("reduleService")),
                            cvth.ASCII2Unicode(rs.getString("CuType")),
                            cvth.ASCII2Unicode(rs.getString("CuDisc")),
                            cvth.ASCII2Unicode(rs.getString("CuDiscBath")),
                            cvth.ASCII2Unicode(rs.getString("CuSaleMin"))});

                    } else {
                        model.addRow(new Object[]{rs.getString("CuCode"),
                            rs.getString("CuBarCode"),
                            rs.getString("CuName"),
                            rs.getDate("CuBegin").toString(),
                            rs.getDate("CuEnd").toString(),
                            rs.getString("CuStrDay"),
                            rs.getString("CuType"),
                            rs.getString("CuADisc"),
                            rs.getString("CuADiscBath"),
                            rs.getString("ChkMember"),
                            rs.getString("reduleDiscount"),
                            rs.getString("reduleService")});
                    }
                }
            }
            t_count1.setText(tblCupon.getRowCount() + " รายการ");
        } catch (Exception e) {
        }
    }

    public void GetData(String Code) {

        if (CheckValidEnter()) {
            try {
                String sql = "select * from cupon where CuCode='" + Code + "'";

                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_code.setText(cvth.ASCII2Unicode(rs.getString("CuCode")));
                        t_name.setText(cvth.ASCII2Unicode(rs.getString("CuName")));

                        t_code2.setText(cvth.ASCII2Unicode(rs.getString("CuCode")) + " - " + cvth.ASCII2Unicode(rs.getString("CuName")));
                        t_code3.setText(cvth.ASCII2Unicode(rs.getString("CuCode")) + " - " + cvth.ASCII2Unicode(rs.getString("CuName")));

                        t_barcode.setText(cvth.ASCII2Unicode(rs.getString("CuBarCode")));

                        t_date1.setText(Format.dateFmtShow.format(rs.getDate("CuBegin")));
                        t_date2.setText(Format.dateFmtShow.format(rs.getDate("CuEnd")));
                        strDay.setText(cvth.ASCII2Unicode(rs.getString("CuStrDay")));

                        c1.setSelected(false);
                        c2.setSelected(false);
                        c3.setSelected(false);
                        c4.setSelected(false);
                        c5.setSelected(false);
                        c6.setSelected(false);
                        c7.setSelected(false);

                        String cu_str = strDay.getText();
                        String[] out = cu_str.split(",");
                        for (int i = 0; i < out.length; i++) {
                            if (out[i].equals("Sun")) {
                                c1.setSelected(true);
                            }
                            if (out[i].equals("Mon")) {
                                c2.setSelected(true);
                            }
                            if (out[i].equals("Tue")) {
                                c3.setSelected(true);
                            }
                            if (out[i].equals("Wed")) {
                                c4.setSelected(true);
                            }
                            if (out[i].equals("Thu")) {
                                c5.setSelected(true);
                            }
                            if (out[i].equals("Fri")) {
                                c6.setSelected(true);
                            }
                            if (out[i].equals("Sat")) {
                                c7.setSelected(true);
                            }
                        }

                        strtype.setText(cvth.ASCII2Unicode(rs.getString("CuSaleType")));

                        te1.setSelected(false);
                        tt1.setSelected(false);
                        td1.setSelected(false);
                        tp1.setSelected(false);
                        tw1.setSelected(false);

                        String sale_str = strtype.getText();
                        String[] out2 = sale_str.split(",");
                        for (int i = 0; i < out2.length; i++) {
                            if (out2[i].equals("E")) {
                                te1.setSelected(true);
                            }
                            if (out2[i].equals("T")) {
                                tt1.setSelected(true);
                            }
                            if (out2[i].equals("D")) {
                                td1.setSelected(true);
                            }
                            if (out2[i].equals("P")) {
                                tp1.setSelected(true);
                            }
                            if (out2[i].equals("W")) {
                                tw1.setSelected(true);
                            }
                        }
                        if (rs.getString("offline").equals("Y")) {
                            T2POffline.setSelected(true);
                        } else {
                            T2POffline.setSelected(false);
                        }
                        if (rs.getString("maisenbirthday").equals("Y")) {
                            maisenmemberday.setSelected(true);
                        } else {
                            maisenmemberday.setSelected(false);
                        }
                        t_maisensale.setText(rs.getString("saleqty"));
                        t_maisenfree.setText(rs.getString("freeqty"));
                        if (rs.getString("offlinebirthday").equals("Y")) {
                            T2PBrithday.setSelected(true);
                        } else {
                            T2PBrithday.setSelected(false);
                        }
                        if (cvth.ASCII2Unicode(rs.getString("ChkMember")).equals("Y")) {
                            chMember.setSelectedIndex(0);
                        } else {
                            chMember.setSelectedIndex(1);
                        }
                        if (cvth.ASCII2Unicode(rs.getString("reduleDiscount")).equals("Y")) {
                            rdDiscount.setSelected(true);
                        } else {
                            rdnDiscount.setSelected(true);
                        }
                        if (cvth.ASCII2Unicode(rs.getString("reduleService")).equals("Y")) {
                            rdService.setSelected(true);
                        } else {
                            rdnService.setSelected(true);
                        }
                        if (cvth.ASCII2Unicode(rs.getString("CuType")).equals("A")) {//CuType
                            rd1.setSelected(true);
                        } else {
                            rd2.setSelected(true);
                        }
                        t_discountper.setText(cvth.ASCII2Unicode(rs.getString("CuDisc")));
                        t_discountbath.setText(cvth.ASCII2Unicode(Format.doubleFmt.format(rs.getFloat("CuDiscBath"))));
                        t_buymin.setText(cvth.ASCII2Unicode(Format.doubleFmt.format(rs.getFloat("CuSaleMin"))));
                        if (rs.getString("chkminall").equals("Y")) {
                            chkminall.setSelected(true);
                        } else {
                            chkminall.setSelected(false);
                        }
                        t_code.setBackground(new java.awt.Color(255, 246, 143));
                        t_code.setEditable(false);

                        getCuponList(cvth.Unicode2ASCII(t_code.getText()));
                        getCuponUnList(cvth.Unicode2ASCII(t_code.getText()));
                        getBranchList(cvth.Unicode2ASCII(t_code.getText()));
                        getFixBranchList(cvth.Unicode2ASCII(t_code.getText()));
                        getgpBranchList(cvth.Unicode2ASCII(t_code.getText()));
                        campaign_code.setText(cvth.ASCII2Unicode(rs.getString("campaign_code")));
                        campaign_name.setText(PUtility.getcampaignname(campaign_code.getText()));
                        t_cnt.setValue(rs.getInt("cucnt"));
                        String TempChk = "";
                        TempChk = cvth.Unicode2ASCII(rs.getString("cuauto"));
                        if (TempChk.equals("Y")) {
                            rdyauto.setSelected(true);
                        } else {
                            rdnauto.setSelected(true);
                        }
                        TempChk = cvth.Unicode2ASCII(rs.getString("cumultiuse"));
                        if (TempChk.equals("Y")) {
                            rdymulti.setSelected(true);
                        } else {
                            rdnmulti.setSelected(true);
                        }
                        TempChk = cvth.Unicode2ASCII(rs.getString("usewithother"));
                        if (TempChk.equals("Y")) {
                            rdyother.setSelected(true);
                        } else {
                            rdnother.setSelected(true);
                        }
                        t_cutime.setText(rs.getString("cutime"));
                        t_cutime2.setText(rs.getString("cutime2"));
                        loadExceptdate(t_code.getText());

                    } else {

                        t_code.setText(rs.getString("CuCode"));
                        t_name.setText(rs.getString("CuName"));
                        t_barcode.setText(rs.getString("CuBarCode"));
                        t_date1.setText(Format.dateFmtShow.format(rs.getDate("CuBegin")));
                        t_date2.setText(Format.dateFmtShow.format(rs.getDate("CuEnd")));
                        strDay.setText(rs.getString("CuStrDay"));

                        c1.setSelected(false);
                        c2.setSelected(false);
                        c3.setSelected(false);
                        c4.setSelected(false);
                        c5.setSelected(false);
                        c6.setSelected(false);
                        c7.setSelected(false);

                        String cu_str = strDay.getText();
                        String[] out = cu_str.split(",");
                        for (int i = 0; i < out.length; i++) {
                            if (out[i].equals("Sun")) {
                                c1.setSelected(true);
                            }
                            if (out[i].equals("Mon")) {
                                c2.setSelected(true);
                            }
                            if (out[i].equals("Tue")) {
                                c3.setSelected(true);
                            }
                            if (out[i].equals("Wed")) {
                                c4.setSelected(true);
                            }
                            if (out[i].equals("Thu")) {
                                c5.setSelected(true);
                            }
                            if (out[i].equals("Fri")) {
                                c6.setSelected(true);
                            }
                            if (out[i].equals("Sat")) {
                                c7.setSelected(true);
                            }
                        }

                        strtype.setText(rs.getString("CuType"));

                        te1.setSelected(false);
                        tt1.setSelected(false);
                        td1.setSelected(false);
                        tp1.setSelected(false);
                        tw1.setSelected(false);

                        String sale_str = strtype.getText();
                        String[] out2 = sale_str.split(",");
                        for (int i = 0; i < out2.length; i++) {
                            if (out2[i].equals("E")) {
                                te1.setSelected(true);
                            }
                            if (out2[i].equals("T")) {
                                tt1.setSelected(true);
                            }
                            if (out2[i].equals("D")) {
                                td1.setSelected(true);
                            }
                            if (out2[i].equals("P")) {
                                tp1.setSelected(true);
                            }
                            if (out2[i].equals("W")) {
                                tw1.setSelected(true);
                            }
                        }

                        if (rs.getString("offline").equals("Y")) {
                            T2POffline.setSelected(true);
                        } else {
                            T2POffline.setSelected(false);
                        }
                        if (rs.getString("offlinebirthday").equals("Y")) {
                            T2PBrithday.setSelected(true);
                        } else {
                            T2PBrithday.setSelected(false);
                        }
                        if (rs.getString("mmaisenbirthday").equals("Y")) {
                            maisenmemberday.setSelected(true);
                        } else {
                            maisenmemberday.setSelected(false);
                        }
                        t_maisensale.setText(rs.getString("saleqty"));
                        t_maisenfree.setText(rs.getString("freeqty"));
                        if (rs.getString("ChkMember").equals("Y")) {
                            chMember.setSelectedIndex(0);
                        } else {
                            chMember.setSelectedIndex(1);
                        }
                        if (rs.getString("reduleDiscount").equals("Y")) {
                            rdDiscount.setSelected(true);
                        } else {
                            rdnDiscount.setSelected(true);
                        }
                        if (rs.getString("reduleService").equals("Y")) {
                            rdService.setSelected(true);
                        } else {
                            rdnService.setSelected(true);
                        }
                        if (rs.getString("CuType").equals("A")) {//CuType

                            rdactive1.setSelected(true);
                        } else {
                            rdactive2.setSelected(true);
                        }

                        t_discountper.setText(rs.getString("CuDisc"));
                        t_discountbath.setText(Format.doubleFmt.format(rs.getFloat("CuDiscBath")));
                        t_buymin.setText(Format.doubleFmt.format(rs.getFloat("CuSaleMin")));
                        if (rs.getString("chkminall").equals("Y")) {
                            chkminall.setSelected(true);
                        } else {
                            chkminall.setSelected(false);
                        }
                        t_code.setBackground(new java.awt.Color(255, 246, 143));
                        t_code.setEditable(false);

                        getCuponList(t_code.getText());
                        getCuponUnList(t_code.getText());
                        getBranchList(t_code.getText());
                        getFixBranchList(t_code.getText());
                        getgpBranchList(t_code.getText());
                        campaign_code.setText(rs.getString("campaign_code"));
                        campaign_name.setText(PUtility.getcampaignname(campaign_code.getText()));
                        t_cnt.setValue(rs.getInt("cucnt"));
                        String TempChk = "";
                        TempChk = rs.getString("cuauto");
                        if (TempChk.equals("Y")) {
                            rdyauto.setSelected(true);
                        } else {
                            rdnauto.setSelected(true);
                        }
                        TempChk = rs.getString("cumultiuse");
                        if (TempChk.equals("Y")) {
                            rdymulti.setSelected(true);
                        } else {
                            rdnmulti.setSelected(true);
                        }
                        TempChk = rs.getString("usewithother");
                        if (TempChk.equals("Y")) {
                            rdyother.setSelected(true);
                        } else {
                            rdnother.setSelected(true);
                        }
                        t_cutime.setText(rs.getString("cutime"));
                        t_cutime2.setText(rs.getString("cutime2"));
                        loadExceptdate(t_code.getText());
                    }
                } else {
                    campaign_code.requestFocus();
                }
                rs.close();
                stmt.close();

            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
        setActive();
    }

    public void GetDataBranch(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from branchgroup where BGroupCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_bcode.setText(cvth.ASCII2Unicode(rs.getString("BGroupCode")));
                        t_bname.setText(cvth.ASCII2Unicode(rs.getString("BGroupName")));

                    } else {
                        t_bcode.setText(rs.getString("BGroupCode"));
                        t_bname.setText(rs.getString("BGroupName"));
                    }
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลกลุ่มสาขา");
                    t_bcode.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public void GetDataBranch1(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from branchgroup where BGroupCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_bcode1.setText(cvth.ASCII2Unicode(rs.getString("BGroupCode")));
                        t_bname1.setText(cvth.ASCII2Unicode(rs.getString("BGroupName")));

                    } else {
                        t_bcode1.setText(rs.getString("BGroupCode"));
                        t_bname1.setText(rs.getString("BGroupName"));
                    }
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลกลุ่มสาขา");
                    t_bcode1.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public void GetDataplu(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from product where PCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_plu.setText(cvth.ASCII2Unicode(rs.getString("PCode")));
                        t_pluname.setText(cvth.ASCII2Unicode(rs.getString("PDesc")));
                    } else {
                        t_plu.setText(rs.getString("PCode"));
                        t_pluname.setText(rs.getString("PDesc"));
                    }
                    btnpluok.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลสินค้า");
                    t_plu.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public void GetDataFixBranch(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from branfile where Code='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_fixbranch.setText(cvth.ASCII2Unicode(rs.getString("Code")));
                        t_fixname.setText(cvth.ASCII2Unicode(rs.getString("Name")));

                    } else {
                        t_fixbranch.setText(rs.getString("Code"));
                        t_fixname.setText(rs.getString("Name"));
                    }
                    btnbranchok1.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลกลุ่มสาขา");
                    t_fixbranch.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public void GetDataGPBranch(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from branfile where Code='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_fixbranch1.setText(cvth.ASCII2Unicode(rs.getString("Code")));
                        t_fixname1.setText(cvth.ASCII2Unicode(rs.getString("Name")));

                    } else {
                        t_fixbranch1.setText(rs.getString("Code"));
                        t_fixname1.setText(rs.getString("Name"));
                    }
                    btnbranchok2.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลกลุ่มสาขา");
                    t_fixbranch1.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public void btnsavebranch() {

        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into culink (BGroup,CuCode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_bcode.getText().trim()));
                prm.setString(2, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into culink (BGroup,CuCode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, t_bcode.getText().trim());
                prm.setString(2, t_code.getText());
                prm.executeUpdate();
            }
            t_bcode.setText("");
            t_bname.setText("");
            stmt.close();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Insert Branch Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public void btnsavefixbranch() {

        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixbranch (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_fixbranch.getText().trim()));
                prm.setString(2, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixbranch (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, t_fixbranch.getText().trim());
                prm.setString(2, t_code.getText());
                prm.executeUpdate();
            }
            stmt.close();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Insert FixBranch Error", JOptionPane.ERROR_MESSAGE);
        }

    }

    public void btnsavegpbranch() {

        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixgpcoupon (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_fixbranch1.getText().trim()));
                prm.setString(2, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixgpcoupon (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, t_fixbranch1.getText().trim());
                prm.setString(2, t_code.getText());
                prm.executeUpdate();
            }
            stmt.close();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Insert GP Branch Error", JOptionPane.ERROR_MESSAGE);
        }

    }

    public void btnsavegpbranch(String t_fixbranch) {

        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixgpcoupon (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_fixbranch.trim()));
                prm.setString(2, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Insert into fixgpcoupon (bcode,cucode) values(?,?)";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, t_fixbranch.trim());
                prm.setString(2, t_code.getText());
                prm.executeUpdate();
            }
            stmt.close();
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e.getMessage(), "Insert GP Branch Error", JOptionPane.ERROR_MESSAGE);
        }

    }

    public void getCuponList(String cupon) {

        tblplu.setShowGrid(true);
        tblplu.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblplu.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblplu.setRowSelectionAllowed(true);
        tblplu.setBackground(java.awt.Color.WHITE);
        tblplu.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblplu.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model2 = (DefaultTableModel) tblplu.getModel();
        modelh2 = (JTableHeader) tblplu.getTableHeader();
        int cnt = model2.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model2.removeRow(0);
            }
        }
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup "
                    + "FROM product INNER JOIN cuponlist ON product.pcode = cuponlist.PCode  "
                    + "where cucode = '" + cupon + "' order by pgroup,product.pcode;";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model2.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("pgroup")),
                            cvth.ASCII2Unicode(rs.getString("product.pcode")),
                            cvth.ASCII2Unicode(rs.getString("pdesc"))});

                    } else {
                        model2.addRow(new Object[]{rs.getString("pgroup"),
                            rs.getString("product.pcode"),
                            rs.getString("pdesc")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public void getProductGroup(String group) {
        if (chkdata(t_code.getText())) {
            btnsave();
        }
        ResultSet rs;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                group = cvth.Unicode2ASCII(group);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup FROM product "
                    + "left join blink on blink.pcode=product.pcode "
                    + "left join culink on culink.bgroup=blink.bgroup "
                    + "where pgroup = '" + group + "' and cucode='" + t_code.getText() + "' "
                    + " order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                String plu = rs.getString("pcode");
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    if (chkdata(t_code.getText())) {
                        if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                            insertCuponList(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                        }
                    }
                } else if (chkdata(t_code.getText())) {
                    if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                        insertCuponList(t_code.getText(), plu);
                    }
                }
                getCuponList(t_code.getText());

            }
        } catch (Exception e) {
            PUtility.ShowMsg(e.getMessage());
        }
    }

    public void getBranchgroup() {

        stmt = null;
        ResultSet rs = null;
        model3 = (DefaultTableModel) tblbranch.getModel();
        int cnt = model3.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model3.removeRow(0);
            }
        }
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT * FROM branchgroup order by bgroupcode;";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model3.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("bgroupcode")),
                            cvth.ASCII2Unicode(rs.getString("bgroupname"))});

                    } else {
                        model3.addRow(new Object[]{rs.getString("bgroupcode"),
                            rs.getString("bgroupname")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public boolean chkdatabranchgroup(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branchgroup where bgroupcode ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branchgroup where bgroupcode ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public void getBranchList(String cupon) {

        tblbranch.setShowGrid(true);
        tblbranch.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblbranch.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblbranch.setRowSelectionAllowed(true);
        tblbranch.setBackground(java.awt.Color.WHITE);
        tblbranch.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblbranch.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblbranch.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblbranch.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model3 = (DefaultTableModel) tblbranch.getModel();
        int cnt = model3.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model3.removeRow(0);
            }
        }
        try {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                cupon = cvth.Unicode2ASCII(cupon);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT culink.CuCode,culink.BGroup,culink.FixBranch,branchgroup.BGroupName  "
                    + "FROM culink INNER JOIN cupon ON culink.CuCode = cupon.CuCode "
                    + "JOIN branchgroup ON branchgroup.BGroupCode = culink.BGroup "
                    + "where culink.CuCode = '" + cupon + "' order by culink.BGroup;";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model3.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("culink.BGroup")),
                            cvth.ASCII2Unicode(rs.getString("branchgroup.BGroupName"))});

                    } else {
                        model3.addRow(new Object[]{rs.getString("culink.BGroup"),
                            rs.getString("branchgroup.BGroupName")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public void getFixBranchList(String cupon) {

        tblfixbranch.setShowGrid(true);
        tblfixbranch.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblfixbranch.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblfixbranch.setRowSelectionAllowed(true);
        tblfixbranch.setBackground(java.awt.Color.WHITE);
        tblfixbranch.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblfixbranch.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblfixbranch.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblfixbranch.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model4 = (DefaultTableModel) tblfixbranch.getModel();
        int cnt = model4.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model4.removeRow(0);
            }
        }
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                cupon = cvth.Unicode2ASCII(cupon);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT fixbranch.cucode,fixbranch.bcode,branfile.Name,branfile.bgroup  "
                    + "FROM fixbranch INNER JOIN cupon ON fixbranch.cucode = cupon.cucode "
                    + "JOIN branfile ON branfile.Code = fixbranch.bcode "
                    + "where fixbranch.cucode = '" + cupon + "' order by branfile.bgroup,branfile.code";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model4.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("branfile.bgroup")),
                            cvth.ASCII2Unicode(rs.getString("fixbranch.bcode")),
                            cvth.ASCII2Unicode(rs.getString("branfile.Name"))});

                    } else {
                        model4.addRow(new Object[]{rs.getString("fixbranch.bcode"),
                            rs.getString("branfile.Name")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public void getgpBranchList(String cupon) {

        tblfixbranch1.setShowGrid(true);
        tblfixbranch1.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblfixbranch1.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblfixbranch1.setRowSelectionAllowed(true);
        tblfixbranch1.setBackground(java.awt.Color.WHITE);
        tblfixbranch1.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblfixbranch1.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblfixbranch1.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblfixbranch1.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model6 = (DefaultTableModel) tblfixbranch1.getModel();
        int cnt = model6.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model6.removeRow(0);
            }
        }
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                cupon = cvth.Unicode2ASCII(cupon);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT fixgpcoupon.cucode,fixgpcoupon.bcode,branfile.Name,branfile.bgroup  "
                    + "FROM fixgpcoupon INNER JOIN cupon ON fixgpcoupon.cucode = cupon.cucode "
                    + "JOIN branfile ON branfile.Code = fixgpcoupon.bcode "
                    + "where fixgpcoupon.cucode = '" + cupon + "' order by branfile.bgroup,branfile.code";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model6.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("branfile.bgroup")),
                            cvth.ASCII2Unicode(rs.getString("fixgpcoupon.bcode")),
                            cvth.ASCII2Unicode(rs.getString("branfile.Name"))});

                    } else {
                        model6.addRow(new Object[]{rs.getString("fixgpcoupon.bcode"),
                            rs.getString("branfile.Name")});
                    }
                }
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e.getMessage());
        }
    }

    public boolean CheckValidEnter() {
        boolean RetVal2 = true;

        if (t_code.getText().length() > 6) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสคูปองไม่ถูกต้อง...(ตัองมีขนาดไม่เกิน 6 ตัวอักษร)");
            RetVal2 = false;
            t_code.requestFocus();
        }
        return RetVal2;
    }

    public boolean CheckValidEnterBranch() {
        boolean RetVal2 = true;

        if (t_bcode.getText().length() > 3) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสกลุ่มสาขาไม่ถูกต้อง...(ตัองมีขนาดไม่เกิน 3 ตัวอักษร)");
            RetVal2 = false;
            t_bcode.requestFocus();
        }
        return RetVal2;
    }

    private void clearModel1() {
        int size = tblCupon.getRowCount();
        for (int i = 0; i < size; i++) {
            model.removeRow(0);
        }
    }

    private void clearModel2() {
        int size = tblplu.getRowCount();
        for (int i = 0; i < size; i++) {
            model2.removeRow(0);
        }
    }

    private void clearModel3() {
        int size = tblbranch.getRowCount();
        for (int i = 0; i < size; i++) {
            model3.removeRow(0);
        }
    }

    private void clearModel4() {
        int size = tblfixbranch.getRowCount();
        for (int i = 0; i < size; i++) {
            model4.removeRow(0);
        }
    }

    private void clearModel6() {
        int size = tblfixbranch1.getRowCount();
        for (int i = 0; i < size; i++) {
            model6.removeRow(0);
        }
    }

    public void chkactive(String date) {
        clearModel1();
        // Check Selected campain
        String TempStr = "";
        if (campaignlist.getSelectedItem() == null) {
            SelectedCampain = "ALL";
        } else {
            TempStr = campaignlist.getSelectedItem().toString();
            String ArrayStr[] = TempStr.split("-");
            SelectedCampain = ArrayStr[0];
        }
        try {
            String sql = "";
            if (SelectedCampain.equals("ALL")) {
                sql = "select * "
                        + "from cupon "
                        + "where ('" + date + "' >= CuBegin and '" + date + "' <= CuEnd ) order by CuCode";
            } else {
                sql = "select * "
                        + "from cupon "
                        + "where ('" + date + "' >= CuBegin) and ('" + date + "' <= CuEnd ) and (campaign_code='" + SelectedCampain + "') order by CuCode";
            }
            stmt = (Statement) dbUtility.con.createStatement();
            ResultSet rs = stmt.executeQuery(sql);

            while (rs.next()) {
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    model.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("CuCode")),
                        cvth.ASCII2Unicode(rs.getString("CuBarCode")),
                        cvth.ASCII2Unicode(rs.getString("CuName")),
                        cvth.ASCII2Unicode(rs.getDate("CuBegin").toString()),
                        cvth.ASCII2Unicode(rs.getDate("CuEnd").toString()),
                        cvth.ASCII2Unicode(rs.getString("CuStrDay")),
                        cvth.ASCII2Unicode(rs.getString("CuType")),
                        cvth.ASCII2Unicode(rs.getString("CuDisc")),
                        cvth.ASCII2Unicode(rs.getString("CuDiscBath")),
                        cvth.ASCII2Unicode(rs.getString("ChkMember")),
                        cvth.ASCII2Unicode(rs.getString("reduleDiscount")),
                        cvth.ASCII2Unicode(rs.getString("reduleService"))});
                } else {
                    model.addRow(new Object[]{rs.getString("CuCode"),
                        rs.getString("CuBarCode"),
                        rs.getString("CuName"),
                        rs.getDate("CuBegin").toString(),
                        rs.getDate("CuEnd").toString(),
                        rs.getString("CuStrDay"),
                        rs.getString("CuType"),
                        rs.getString("CuDisc"),
                        rs.getString("CuDiscBath"),
                        rs.getString("ChkMember"),
                        rs.getString("reduleDiscount"),
                        rs.getString("reduleService")});
                }
            }
            rs.close();
            stmt.close();
            t_count1.setText(tblCupon.getRowCount() + " รายการ");

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e);
        }
    }

    public String getFixBranch() {
        String TFix = "";
        try {
            String sql = "select *from fixbranch where (cucode='" + t_code.getText() + "')  order by bcode ";
            stmt = (Statement) dbUtility.con.createStatement();
            ResultSet rs = stmt.executeQuery(sql);
            int currec = 0;
            while (rs.next()) {
                currec++;
                if (currec <= 60) {
                    TFix = TFix + "," + rs.getString("bcode");
                }
            }
            rs.close();
            stmt.close();
            t_count1.setText(tblCupon.getRowCount() + " รายการ");

        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e);
        }
        return TFix;
    }

    public void SaveFixBranch() {
        String FixBranch = getFixBranch();
        try {

            stmt = (Statement) dbUtility.con.createStatement();
            String sql2 = "update culink  set fixbranch = '" + FixBranch + "' where CuCode = '" + t_code.getText() + "'";
            stmt.executeUpdate(sql2);
            stmt.close();

        } catch (Exception e) {
        }

    }

    public void btnsave() {
        java.util.Date time1;
        java.util.Date time2;
        String date1 = "";
        String date2 = "";
        try {
            time1 = Format.dateFmtShow.parse(t_date1.getText());
            date1 = Format.dateFmtSql.format(time1);
            time2 = Format.dateFmtShow.parse(t_date2.getText());
            date2 = Format.dateFmtSql.format(time2);
        } catch (Exception ex) {
            date1 = "1900-01-01";
            date2 = "1900-01-01";
        }
        if (CheckValidSave()) {
            if (chkdata(t_code.getText())) {
                try {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Update cupon set CuName=?,CuBarCode=?,CuBegin=?,CuEnd=?"
                                + ",CuStrDay=?,CuSaleType=?,ChkMember=?,reduleDiscount=?,reduleService=?,CuType=?"
                                + ",CuDisc=?,CuDiscBath=?,CuSaleMin=?,campaign_code=?,cucnt=?,cuauto=?,cumultiuse=?,usewithother=?,cutime=?,cutime2=?,chkminall=?,offline=?,offlinebirthday=? ,maisenbirthday=? ,saleqty=? ,freeqty=? "
                                + " where CuCode = ?";
                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(19, cvth.Unicode2ASCII(t_cutime.getText().trim()));
                        prm.setString(20, cvth.Unicode2ASCII(t_cutime2.getText().trim()));
                        if (chkminall.isSelected()) {
                            prm.setString(21, "Y");
                        } else {
                            prm.setString(21, "N");
                        }
                        if (T2POffline.isSelected()) {
                            prm.setString(22, "Y");
                        } else {
                            prm.setString(22, "N");
                        }
                        if (T2PBrithday.isSelected()) {
                            prm.setString(23, "Y");
                        } else {
                            prm.setString(23, "N");
                        }
                        //------------------
                        if (maisenmemberday.isSelected()) {
                            prm.setString(24, "Y");
                        } else {
                            prm.setString(24, "N");
                        }
                        prm.setInt(25, Integer.parseInt(t_maisensale.getText()));
                        prm.setInt(26, Integer.parseInt(t_maisenfree.getText()));
                        prm.setString(27, cvth.Unicode2ASCII(t_code.getText().trim()));
                        prm.setString(1, cvth.Unicode2ASCII(t_name.getText()));
                        prm.setString(2, cvth.Unicode2ASCII(t_barcode.getText()));
                        prm.setString(3, cvth.Unicode2ASCII(date1));
                        prm.setString(4, cvth.Unicode2ASCII(date2));
                        prm.setString(5, cvth.Unicode2ASCII(strDay.getText()));
                        prm.setString(6, cvth.Unicode2ASCII(strtype.getText()));

                        if (chMember.getSelectedIndex() == 0) {
                            prm.setString(7, cvth.Unicode2ASCII("Y"));
                        } else if (chMember.getSelectedIndex() == 1) {
                            prm.setString(7, cvth.Unicode2ASCII("N"));
                        }
                        if (rdDiscount.isSelected()) {
                            prm.setString(8, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(8, cvth.Unicode2ASCII("N"));
                        }
                        if (rdService.isSelected()) {
                            prm.setString(9, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(9, cvth.Unicode2ASCII("N"));
                        }
                        if (rd1.isSelected()) {
                            prm.setString(10, cvth.Unicode2ASCII("A"));
                        } else {
                            prm.setString(10, cvth.Unicode2ASCII("B"));
                        }
                        prm.setDouble(11, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountper.getText())));
                        prm.setDouble(12, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(13, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(14, cvth.Unicode2ASCII(campaign_code.getText()));
                        prm.setInt(15, Integer.parseInt(t_cnt.getText()));
                        if (rdyauto.isSelected()) {
                            prm.setString(16, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(16, cvth.Unicode2ASCII("N"));
                        }
                        if (rdymulti.isSelected()) {
                            prm.setString(17, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(17, cvth.Unicode2ASCII("N"));
                        }
                        if (rdyother.isSelected()) {
                            prm.setString(18, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(18, cvth.Unicode2ASCII("N"));
                        }

                        prm.executeUpdate();
                    } else {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Update cupon set CuName=?,CuBarCode=?,CuBegin=?,CuEnd=?"
                                + ",CuStrDay=?,CuSaleType=?,ChkMember=?,reduleDiscount=?,reduleService=?,CuType=?"
                                + ",CuDisc=?,CuDiscBath=?,CuSaleMin=?,campaign_code=?,cucnt=?,cuauto=?,cumultiuse=?,usewithother=?,cutime=?,cutime2=?,chkminall=?,offline=?,offlinebirthday=?  ,maisenbirthday=? ,saleqty=?, freeqty=? "
                                + " where CuCode = ?";
                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(19, t_cutime.getText().trim());
                        prm.setString(20, t_cutime2.getText().trim());
                        if (chkminall.isSelected()) {
                            prm.setString(21, "Y");
                        } else {
                            prm.setString(21, "N");
                        }
                        if (T2POffline.isSelected()) {
                            prm.setString(22, "Y");
                        } else {
                            prm.setString(22, "N");
                        }
                        if (T2PBrithday.isSelected()) {
                            prm.setString(23, "Y");
                        } else {
                            prm.setString(23, "N");
                        }
                        if (maisenmemberday.isSelected()) {
                            prm.setString(24, "Y");
                        } else {
                            prm.setString(24, "N");
                        }
                        prm.setInt(25, Integer.parseInt(t_maisensale.getText()));
                        prm.setInt(26, Integer.parseInt(t_maisenfree.getText()));
                        prm.setString(27, t_code.getText().trim());
                        prm.setString(1, t_name.getText());
                        prm.setString(2, t_barcode.getText());
                        prm.setString(3, date1);
                        prm.setString(4, date2);
                        prm.setString(5, strDay.getText());
                        prm.setString(6, strtype.getText());
                        if (chMember.getSelectedIndex() == 0) {
                            prm.setString(7, "Y");
                        } else if (chMember.getSelectedIndex() == 1) {
                            prm.setString(7, "N");
                        }
                        if (rdDiscount.isSelected()) {
                            prm.setString(8, "Y");
                        } else {
                            prm.setString(8, "N");
                        }
                        if (rdService.isSelected()) {
                            prm.setString(9, "Y");
                        } else {
                            prm.setString(9, "N");
                        }
                        if (rd1.isSelected()) {
                            prm.setString(10, "A");
                        } else {
                            prm.setString(10, "B");
                        }
                        prm.setDouble(11, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountper.getText())));
                        prm.setDouble(12, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(13, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(14, campaign_code.getText());
                        prm.setInt(15, Integer.parseInt(t_cnt.getValue().toString()));
                        if (rdyauto.isSelected()) {
                            prm.setString(16, "Y");
                        } else {
                            prm.setString(16, "N");
                        }
                        if (rdymulti.isSelected()) {
                            prm.setString(17, "Y");
                        } else {
                            prm.setString(17, "N");
                        }
                        if (rdyother.isSelected()) {
                            prm.setString(18, "Y");
                        } else {
                            prm.setString(18, "N");
                        }
                        prm.executeUpdate();
                    }
                    stmt.close();
                } catch (Exception e) {
                    JOptionPane.showMessageDialog(this, e.getMessage(), "Save Error...", JOptionPane.ERROR_MESSAGE);
                }
            } else {
                try {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Insert into cupon (CuCode,CuName,CuBarCode,CuBegin,CuEnd"
                                + ",CuStrDay,CuSaleType,ChkMember,reduleDiscount,reduleService,CuType,CuDisc,CuDiscBath,CuSaleMin"
                                + ",campaign_code,cucnt,cuauto,cumultiuse,usewithother,cutime,cutime2,chkminall,offline,offlinebirthday,maisenbirthday,saleqty,freeqty) "
                                + " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(1, cvth.Unicode2ASCII(t_code.getText().trim()));
                        prm.setString(2, cvth.Unicode2ASCII(t_name.getText()));
                        prm.setString(3, cvth.Unicode2ASCII(t_barcode.getText()));
                        prm.setString(4, cvth.Unicode2ASCII(date1));
                        prm.setString(5, cvth.Unicode2ASCII(date2));
                        prm.setString(6, cvth.Unicode2ASCII(strDay.getText()));
                        prm.setString(7, cvth.Unicode2ASCII(strtype.getText()));
                        if (chMember.getSelectedIndex() == 0) {
                            prm.setString(8, cvth.Unicode2ASCII("Y"));
                        } else if (chMember.getSelectedIndex() == 1) {
                            prm.setString(8, cvth.Unicode2ASCII("N"));
                        }
                        if (rdDiscount.isSelected()) {
                            prm.setString(9, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(9, cvth.Unicode2ASCII("N"));
                        }
                        if (rdService.isSelected()) {
                            prm.setString(10, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(10, cvth.Unicode2ASCII("N"));
                        }
                        if (rd1.isSelected()) {
                            prm.setString(11, cvth.Unicode2ASCII("A"));
                        } else {
                            prm.setString(11, cvth.Unicode2ASCII("B"));
                        }
                        prm.setDouble(12, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountper.getText())));
                        prm.setDouble(13, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(14, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(15, cvth.Unicode2ASCII(campaign_code.getText()));
                        prm.setInt(16, Integer.parseInt(t_cnt.getValue().toString()));
                        if (rdyauto.isSelected()) {
                            prm.setString(17, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(17, cvth.Unicode2ASCII("N"));
                        }
                        if (rdymulti.isSelected()) {
                            prm.setString(18, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(18, cvth.Unicode2ASCII("N"));
                        }
                        if (rdyother.isSelected()) {
                            prm.setString(19, cvth.Unicode2ASCII("Y"));
                        } else {
                            prm.setString(19, cvth.Unicode2ASCII("N"));
                        }
                        prm.setString(20, cvth.Unicode2ASCII(t_cutime.getText().trim()));
                        prm.setString(21, cvth.Unicode2ASCII(t_cutime2.getText().trim()));
                        if (chkminall.isSelected()) {
                            prm.setString(22, "Y");
                        } else {
                            prm.setString(22, "N");
                        }
                        if (T2POffline.isSelected()) {
                            prm.setString(23, "Y");
                        } else {
                            prm.setString(23, "N");
                        }
                        if (T2PBrithday.isSelected()) {
                            prm.setString(24, "Y");
                        } else {
                            prm.setString(24, "N");
                        }
                        if (maisenmemberday.isSelected()) {
                            prm.setString(25, "Y");
                        } else {
                            prm.setString(25, "N");
                        }
                        prm.setInt(26, Integer.parseInt(t_maisensale.getText()));
                        prm.setInt(27, Integer.parseInt(t_maisenfree.getText()));

                        prm.executeUpdate();

                    } else {

                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql = "Insert into cupon (CuCode,CuName,CuBarCode,CuBegin,CuEnd"
                                + ",CuStrDay,CuSaleType,ChkMember,reduleDiscount,reduleService,CuType,CuDisc,CuDiscBath,CuSaleMin"
                                + ",campaign_code,cucnt,cuauto,cumultiuse,usewithother,cutime,cutime2,chkminall,offline,offlinebirthday,maisenbirthday,saleqty,freeqty) "
                                + " values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)";

                        PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                        prm.setString(1, t_code.getText().trim());
                        prm.setString(2, t_name.getText());
                        prm.setString(3, t_barcode.getText());
                        prm.setString(4, date1);
                        prm.setString(5, date2);
                        prm.setString(6, strDay.getText());
                        prm.setString(7, strtype.getText());
                        if (chMember.getSelectedIndex() == 0) {
                            prm.setString(8, "Y");
                        } else if (chMember.getSelectedIndex() == 1) {
                            prm.setString(8, "N");
                        }
                        if (rdDiscount.isSelected()) {
                            prm.setString(9, "Y");
                        } else {
                            prm.setString(9, "N");
                        }
                        if (rdService.isSelected()) {
                            prm.setString(10, "Y");
                        } else {
                            prm.setString(10, "N");
                        }
                        if (rd1.isSelected()) {
                            prm.setString(11, "A");
                        } else {
                            prm.setString(11, "B");
                        }
                        prm.setDouble(12, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountper.getText())));
                        prm.setDouble(13, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_discountbath.getText())));
                        prm.setDouble(14, Double.parseDouble(utilititiesfunction.PUtility.ConvertReal(t_buymin.getText())));
                        prm.setString(15, campaign_code.getText());
                        prm.setInt(16, Integer.parseInt(t_cnt.getValue().toString()));
                        if (rdyauto.isSelected()) {
                            prm.setString(17, "Y");
                        } else {
                            prm.setString(17, "N");
                        }
                        if (rdymulti.isSelected()) {
                            prm.setString(18, "Y");
                        } else {
                            prm.setString(18, "N");
                        }
                        if (rdyother.isSelected()) {
                            prm.setString(19, "Y");
                        } else {
                            prm.setString(19, "N");
                        }
                        prm.setString(20, t_cutime.getText().trim());
                        prm.setString(21, t_cutime2.getText().trim());
                        if (chkminall.isSelected()) {
                            prm.setString(22, "Y");
                        } else {
                            prm.setString(22, "N");
                        }
                        if (T2POffline.isSelected()) {
                            prm.setString(23, "Y");
                        } else {
                            prm.setString(23, "N");
                        }
                        if (T2PBrithday.isSelected()) {
                            prm.setString(24, "Y");
                        } else {
                            prm.setString(24, "N");
                        }
                        if (maisenmemberday.isSelected()) {
                            prm.setString(25, "Y");
                        } else {
                            prm.setString(25, "N");
                        }
                        prm.setInt(26, Integer.parseInt(t_maisensale.getText()));
                        prm.setInt(27, Integer.parseInt(t_maisenfree.getText()));
                        prm.executeUpdate();

                    }
                    stmt.close();

                } catch (Exception e) {
                    JOptionPane.showMessageDialog(this, e.getMessage().toString(), "Save Error...", JOptionPane.ERROR_MESSAGE);
                }
            }
            showdataintb();
            bsaveOK = true;
        }
    }

    public boolean CheckValidSave() {
        boolean chk = true;
        if (t_code.getText().length() > 6) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัสคูปองไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 6 ตัวอักษร)");
            chk = false;
            t_code.requestFocus();
        } else if (t_name.getText().length() > 30) {
            JOptionPane.showMessageDialog(this, "กำหนด รายละเอียด/ชื่อคูปองไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 30 ตัวอักษร)");
            chk = false;
            t_name.requestFocus();
        } else if (t_barcode.getText().length() > 8) {
            JOptionPane.showMessageDialog(this, "กำหนดรหัส Barcodeไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 8 ตัวอักษร)");
            chk = false;
            t_barcode.requestFocus();
        } else if (t_discountper.getText().length() > 13) {
            JOptionPane.showMessageDialog(this, "กำหนดส่วนลด % ไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 10 ตัวอักษร)");
            chk = false;
            t_discountper.requestFocus();
        } else if (t_discountbath.getText().length() > 13) {
            JOptionPane.showMessageDialog(this, "กำหนดส่วนลดบาทไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 10 ตัวอักษร)");
            chk = false;
            t_discountbath.requestFocus();
        } else if (t_buymin.getText().length() > 13) {
            JOptionPane.showMessageDialog(this, "กำหนดยอดซื้อขั้นต่ำไม่ถูกต้อง... (ต้องมีขนาดไม่เกิน 10 ตัวอักษร)");
            chk = false;
            t_buymin.requestFocus();
        }
        //Check Fix Branch
        if (!ChkFixBranch()) {
            JOptionPane.showMessageDialog(this, "กรุณาตรวจสอบการกำหนดการใช้งานเฉพาะสาขา โดยไม่กำหนด กลุ่มสาขาที่ใช้งานได้" + "\n" + FixBranchError);
            chk = false;
        }
// ทำให้ Process การ Save ช้าลงค่อนข้างมาก        
//        if (!ChkPluList()) {
//            JOptionPane.showMessageDialog(this, "กรุณาตรวจสอบการกำหนดการใช้งานเฉพาะรายการสินค้า โดยไม่กำหนด กลุ่มสาขาที่ใช้งานได้" + "\n" + FixBranchError);
//            chk = false;
//        }

        //Check PLUList
        return chk;
    }

    public boolean ChkFixBranch() {
        boolean ret = true;
        ResultSet rs = null;
        FixBranchError = "";
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select bcode,bgroup from fixbranch "
                    + "left join branfile on code=bcode "
                    + "where cucode='" + t_code.getText() + "' ";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                String Tempbcode = rs.getString("bcode");
                String Tempbgroup = rs.getString("bgroup");
                if (!chkinbgroup(Tempbgroup)) {
                    ret = false;
                    FixBranchError = FixBranchError + "," + Tempbcode;
                }
            }

        } catch (SQLException ex) {
            Logger.getLogger(SpacialCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean ChkPluList() {
        boolean ret = true;
        ResultSet rs = null;
        FixBranchError = "";
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from cuponlist "
                    + "where cucode='" + t_code.getText() + "' ";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                String Tempcode = rs.getString("pcode");
                String Tempcucode = rs.getString("cucode");
                if (!chkinlist(Tempcucode, Tempcode)) {
                    ret = false;
                    FixBranchError = FixBranchError + "," + Tempcode;
                }
            }

        } catch (SQLException ex) {
            Logger.getLogger(SpacialCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean chkinbgroup(String bgroup) {
        boolean ret = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from culink "
                    + "where cucode='" + t_code.getText() + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.getRow() == 0) {
                while (rs.next()) {
                    if (rs.getString("bgroup").equals(bgroup)) {
                        ret = true;
                    }
                }
            }
        } catch (SQLException ex) {
            Logger.getLogger(SpacialCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean chkinlist(String cucode, String pcode) {
        boolean ret = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select pcode from blink "
                    + "left join culink on blink.bgroup=culink.bgroup "
                    + "where cucode='" + cucode + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.getRow() == 0) {
                while (rs.next()) {
                    if (rs.getString("pcode").equals(pcode)) {
                        ret = true;
                    }
                }
            }
        } catch (SQLException ex) {
            Logger.getLogger(SpacialCouponSetup.class.getName()).log(Level.SEVERE, null, ex);
        }
        return ret;
    }

    public boolean chkdata(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from cupon where CuCode ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from cupon where CuCode ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
            JOptionPane.showMessageDialog(this, e);
        }
        return chk;
    }

    public boolean chkplu(String cucode, String plu) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select product.pcode from product "
                    + "left join blink on blink.pcode=product.pcode "
                    + "left join culink on blink.bgroup=culink.bgroup "
                    + "where CuCode ='" + cucode + "' and product.pcode='" + plu + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                chk = true;
            } else {
                chk = false;
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkculist(String cucode, String plu) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "select *from cuponlist "
                    + "where CuCode ='" + cucode + "' and pcode='" + plu + "' ";
            rs = stmt.executeQuery(sql);
            if (rs.next()) {
                chk = true;
            } else {
                chk = false;
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatafixbranch(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from fixbranch where bcode ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatafixbranch(String pk, String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from fixbranch where bcode ='" + cvth.Unicode2ASCII(pk) + "'"
                        + " and cucode = '" + cvth.Unicode2ASCII(code) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatagpbranch(String pk, String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from fixgpcoupon where bcode ='" + cvth.Unicode2ASCII(pk) + "'"
                        + " and cucode = '" + cvth.Unicode2ASCII(code) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                //stmt = (Statement) dbUtility.con.createStatement();
                //String sql = "select * from culink where BGroup ='" + pk + "'";
                //rs = stmt.executeQuery(sql);
                //if (rs.next()) {
                //    chk = true;
                //}
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from fixgpcoupon where bcode ='" + pk + "'"
                        + " and cucode = '" + code + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdataingroup(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + pk + "'  and cucode='" + t_code.getText() + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }

            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + pk + "'  and cucode='" + t_code.getText() + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }

            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatafixbranchingroup(String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();

                String where = "";
                for (int i = 0; i < model3.getRowCount(); i++) {
                    if (i == 0) {
                        where = "and ( branfile.bgroup = '" + model3.getValueAt(i, 0) + "'";
                    } else if (i == model3.getRowCount() - 1) {
                        where += " or branfile.bgroup = '" + model3.getValueAt(i, 0) + "' ";
                    } else if (i < 1 | i < model3.getRowCount()) {
                        where += " or branfile.bgroup = '" + model3.getValueAt(i, 0) + "'";
                    }
                }

//            String sql3 = "select bgroup,name,code "
//                    + "from branfile where " + where + " order by bgroup ";
//                
//                
//                String sql4 = "SELECT culink.CuCode,culink.BGroup,culink.FixBranch,branchgroup.BGroupName  "
//                    + "FROM culink INNER JOIN cupon ON culink.CuCode = cupon.CuCode "
//                    + "JOIN branchgroup ON branchgroup.BGroupCode = culink.BGroup "
//                    + "where culink.CuCode = '" + cupon + "' order by culink.BGroup;";
                String sql = "select branfile.code,branfile.bgroup "
                        + "from branfile  "
                        + "where branfile.code = '" + cvth.Unicode2ASCII(code) + "'  " + where + " )";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();

                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranchinfixbranch(String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {

            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();

                String where = "";
                if (model4.getRowCount() == 1) {
                    where = "and ( branfile.code = '" + model4.getValueAt(0, 1) + "')";
                } else {

                    for (int i = 0; i < model4.getRowCount(); i++) {
                        if (i == 0) {
                            where = "and ( branfile.code = '" + model4.getValueAt(i, 1) + "'";
                        } else if (i == model4.getRowCount() - 1) {
                            where += " or branfile.code = '" + model4.getValueAt(i, 1) + "' )";
                        } else if (i < 1 | i < model4.getRowCount()) {
                            where += " or branfile.code = '" + model4.getValueAt(i, 1) + "'";
                        }
                    }
                }

                String sql = "select branfile.code,branfile.bgroup "
                        + "from branfile  "
                        + "where bgroup = '" + cvth.Unicode2ASCII(code) + "' " + where + " ";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();

                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranchfile(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branfile where Code ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from branfile where Code ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranch(String pk) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + cvth.Unicode2ASCII(pk) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public boolean chkdatabranch(String pk, String code) {
        boolean chk = false;
        ResultSet rs = null;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + cvth.Unicode2ASCII(pk) + "'"
                        + " and cucode = '" + cvth.Unicode2ASCII(code) + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            } else {
                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "select * from culink where BGroup ='" + pk + "'";
                rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    chk = true;
                }
            }
        } catch (Exception e) {
        }
        return chk;
    }

    public void genday() {
        String coCode = t_code.getText().trim();
        if (coCode.length() > 0 && !t_code.isEditable()) {
            String day = "";
            if (c1.isSelected()) {
                day += ",Sun";
            }
            if (c2.isSelected()) {
                day += ",Mon";
            }
            if (c3.isSelected()) {
                day += ",Tue";
            }
            if (c4.isSelected()) {
                day += ",Wed";
            }
            if (c5.isSelected()) {
                day += ",Thu";
            }
            if (c6.isSelected()) {
                day += ",Fri";
            }
            if (c7.isSelected()) {
                day += ",Sat";
            }
            strDay.setText(day);
        } else {
            t_code.requestFocus();
        }
    }

    public void gend() {
        String proType = "";
        if (te1.isSelected()) {
            proType += ",E";
        }
        if (tt1.isSelected()) {
            proType += ",T";
        }
        if (td1.isSelected()) {
            proType += ",D";
        }
        if (tp1.isSelected()) {
            proType += ",P";
        }
        if (tw1.isSelected()) {
            proType += ",W";
        }
        strtype.setText(proType);
    }

    private void setActive() {
        setActive(true);
    }

    private void setUnActive() {
        setActive(false);
    }

    private void setActive(boolean active) {
        tab.setEnabledAt(1, active);
        tab.setEnabledAt(2, active);
        tab.setEnabledAt(3, active);
        t_name.setFocusable(active);
        t_barcode.setFocusable(active);
        t_date1.setFocusable(active);
        t_date2.setFocusable(active);

        t_discountper.setFocusable(active);
        t_discountbath.setFocusable(active);
        t_buymin.setFocusable(active);
        campaign_code.setFocusable(active);
        btnfindcampaign.setEnabled(active);

        rdDiscount.setEnabled(active);
        rdnDiscount.setEnabled(active);
        rdService.setEnabled(active);
        rdnService.setEnabled(active);
        rd1.setEnabled(active);
        rd2.setEnabled(active);
        btn_Calendar.setEnabled(active);
        btn_Calendar1.setEnabled(active);
        c1.setEnabled(active);
        c2.setEnabled(active);
        c3.setEnabled(active);
        c4.setEnabled(active);
        c5.setEnabled(active);
        c6.setEnabled(active);
        c7.setEnabled(active);
        te1.setEnabled(active);
        tt1.setEnabled(active);
        td1.setEnabled(active);
        tp1.setEnabled(active);
        tw1.setEnabled(active);
        chMember.setEnabled(active);

        rdyauto.setEnabled(active);
        rdnauto.setEnabled(active);
        rdymulti.setEnabled(active);
        rdnmulti.setEnabled(active);
        rdyother.setEnabled(active);
        rdnother.setEnabled(active);
        t_cnt.setFocusable(active);

        //tab2
        t_plu.setFocusable(active);
        t_gcode.setFocusable(active);
        t_bcode.setFocusable(active);
        t_fixbranch.setFocusable(active);

        //tab3
        t_code3.setFocusable(active);
        t_fixbranch1.setFocusable(active);
        t_fixname1.setFocusable(active);

//        if (active == true && chkdata(t_code.getText())) {
//            tab.setEnabledAt(1, active);
//        }
    }

    public void clearForm() {
        bsaveOK = false;
        FixBranchError = "";
        PluListError = "";
        tab.setSelectedIndex(0);
        t_barcode.requestFocus();
        t_code.setText("");
        t_code.setEditable(true);
        t_code.setBackground(java.awt.Color.white);

        t_name.setText("");
        t_cutime.setText("00:00");
        t_cutime2.setText("00:00");
        T2POffline.setSelected(false);
        T2PBrithday.setSelected(false);
        maisenmemberday.setSelected(false);
        t_maisensale.setText("0");
        t_maisenfree.setText("0");
        t_barcode.setText("");
        rdDiscount.setSelected(true);
        rdService.setSelected(true);
        rdactive1.setSelected(true);
        t_date1.setText(Format.dateFmtShow.format(new java.util.Date()));
        t_date2.setText(Format.dateFmtShow.format(new java.util.Date()));
        strDay.setText("");
        c1.setSelected(false);
        c2.setSelected(false);
        c3.setSelected(false);
        c4.setSelected(false);
        c5.setSelected(false);
        c6.setSelected(false);
        c7.setSelected(false);
        te1.setSelected(false);
        tt1.setSelected(false);
        td1.setSelected(false);
        tp1.setSelected(false);
        tw1.setSelected(false);
        t_buymin.setText("0.00");
        chkminall.setSelected(true);
        strtype.setText("");

        chMember.setSelectedIndex(0);
        t_plu.setText("");
        t_discountper.setText("0.00");
        t_discountbath.setText("0.00");
        rd1.setSelected(true);

        //tab2
        t_code2.setText("");
        t_plu.setText("");
        t_pluname.setText("");
        t_gcode.setText("");
        t_bcode.setText("");
        t_bname.setText("");
        t_fixbranch.setText("");
        t_fixname.setText("");
        campaign_code.setText("");
        campaign_name.setText("");
        t_cnt.setValue(1);
        rdnauto.setSelected(true);
        rdnmulti.setSelected(true);
        rdnother.setSelected(true);

        //Tab3
        t_code3.setText("");
        t_fixbranch1.setText("");
        t_fixname1.setText("");

        clearModel2();
        clearModel3();
        clearModel4();
        clearModel6();

        setUnActive();
        t_code.requestFocus();
        showdataintb();
    }

    public void delete(String code) {
        try {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลรายการนี้หรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
            if (confirm == JOptionPane.YES_OPTION) {

                stmt = (Statement) dbUtility.con.createStatement();
                String sql = "Delete from cupon where CuCode = ?";
                PreparedStatement prm = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                prm.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm.executeUpdate();
                stmt.close();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql2 = "Delete from cuponlist where CuCode = ?";
                PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                prm2.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm2.executeUpdate();
                stmt.close();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql3 = "Delete from culink where CuCode = ?";
                PreparedStatement prm3 = (PreparedStatement) dbUtility.con.prepareStatement(sql3);
                prm3.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm3.executeUpdate();
                stmt.close();

                stmt = (Statement) dbUtility.con.createStatement();
                String sql4 = "Delete from fixbranch where CuCode = ?";
                PreparedStatement prm4 = (PreparedStatement) dbUtility.con.prepareStatement(sql4);
                prm4.setString(1, cvth.Unicode2ASCII(t_code.getText()));
                prm4.executeUpdate();
                stmt.close();

                deleteExcdateAll();

                clearForm();
                showdataintb();
            }

        } catch (Exception e) {
        }
    }

    public void saveplu() {
        try {
            for (int i = 0; i < tblplu.getRowCount(); i++) {

                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql = "Insert into cuponlist (CuCode,PCode) "
                            + " values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                    prm2.setString(1, cvth.Unicode2ASCII(t_code.getText().trim()));
                    prm2.setString(2, cvth.Unicode2ASCII(tblplu.getValueAt(i, 1).toString()));
                    prm2.executeUpdate();
                    stmt.close();
                } else {
                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql = "Insert into cuponlist (CuCode,PCode) "
                            + " values(?,?)";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql);
                    prm2.setString(1, t_code.getText().trim());
                    prm2.setString(2, tblplu.getValueAt(i, 1).toString());
                    prm2.executeUpdate();
                    stmt.close();
                }

            }

        } catch (Exception e) {
        }
    }

    public void deleteplu() {
        String code = t_code.getText();
        try {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลสินค้าทั้งหมดหรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
            if (confirm == JOptionPane.YES_OPTION) {

                for (int i = 0; i < tblplu.getRowCount(); i++) {

                    stmt = (Statement) dbUtility.con.createStatement();
                    String sql2 = "Delete from cuponlist where CuCode = '" + code + "'";
                    PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
//                        prm2.setString(1, cvth.Unicode2ASCII(tblplu.getValueAt(i, 1).toString()));
                    prm2.executeUpdate();
                    stmt.close();

                }
                clearModel2();
            }

        } catch (Exception e) {
        }
    }

    public void deletebranch(String code) {
        try {
            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลกลุ่มสาขาทั้งหมดหรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
            if (confirm == JOptionPane.YES_OPTION) {

                for (int i = 0; i < tblbranch.getRowCount(); i++) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {

                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql2 = "Delete from culink where BGroup = ? and cucode = '" + code + "'";
                        PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                        prm2.setString(1, cvth.Unicode2ASCII(tblbranch.getValueAt(i, 0).toString()));
                        prm2.executeUpdate();
                        stmt.close();

                    } else {
                        stmt = (Statement) dbUtility.con.createStatement();
                        String sql2 = "Delete from culink where BGroup = ?";
                        PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
                        prm2.setString(1, tblbranch.getValueAt(i, 0).toString());
                        prm2.executeUpdate();
                        stmt.close();
                    }
                }
                clearModel3();
            }

        } catch (Exception e) {
        }
    }

    public void btnplu1() {
        Point point = btn_group.getLocation();
        point.setLocation(point.getX() + 1, point.getY() + 1);
        ListProduct dialog = new ListProduct(new NimbusFrame(), true);
        dialog.setVisible(true);

        try {
            if (!dialog.code.equals("")) {
                t_plu1.setText(dialog.code);
                GetDataplu(dialog.code);
                btnpluok1.requestFocus();
            } else {
                t_plu1.requestFocus();
            }
        } catch (Exception e) {
            t_plu1.requestFocus();
        }
    }

    public void GetDataplu1(String Code) {

        if (CheckValidEnterBranch()) {
            try {
                String sql = "select * from product where PCode='" + Code + "'";
                stmt = (Statement) dbUtility.con.createStatement();
                ResultSet rs = stmt.executeQuery(sql);
                if (rs.next()) {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        t_plu1.setText(cvth.ASCII2Unicode(rs.getString("PCode")));
                        t_pluname1.setText(cvth.ASCII2Unicode(rs.getString("PDesc")));
                    } else {
                        t_plu1.setText(rs.getString("PCode"));
                        t_pluname1.setText(rs.getString("PDesc"));
                    }
                    btnpluok1.requestFocus();
                } else {
                    JOptionPane.showMessageDialog(this, "ไม่พบข้อมูลสินค้า");
                    t_plu1.requestFocus();
                }
                rs.close();
                stmt.close();
                setActive();
            } catch (Exception e) {
                JOptionPane.showMessageDialog(this, e);
            }
        }
    }

    public boolean insertCuponList1(String cocode, String pcode) {
        Statement stmt = null;
        boolean isupdate = false;
        int rowInsert = 0;
        String sql = "";

        try {
            stmt = (Statement) dbUtility.con.createStatement();
            sql = "insert into cuponunlist values('" + cocode + "','" + pcode + "')";
            rowInsert = stmt.executeUpdate(sql);
            if (rowInsert > 0) {
                isupdate = true;
            }
        } catch (Exception e) {
        }
        return isupdate;
    }

    public void escplu1() {
        t_plu1.setText("");
        t_pluname1.setText("");
        t_plu1.requestFocus();
    }

    public void getProductGroup1(String group) {
        if (chkdata(t_code.getText())) {
            btnsave();
        }
        ResultSet rs;
        try {
            if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                group = cvth.Unicode2ASCII(group);
            }
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup FROM product "
                    + "left join blink on blink.pcode=product.pcode "
                    + "left join culink on culink.bgroup=blink.bgroup "
                    + "where pgroup = '" + group + "' and cucode='" + t_code.getText() + "' and pactive='Y' "
                    + " order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);

            while (rs.next()) {
                String plu = rs.getString("pcode");
                if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                    if (chkdata(t_code.getText())) {
                        if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                            insertCuponList1(cvth.ASCII2Unicode(t_code.getText()), cvth.ASCII2Unicode(plu));
                        }
                    }
                } else if (chkdata(t_code.getText())) {
                    if (chkplu(t_code.getText(), plu) & (!chkculist(t_code.getText(), plu))) {
                        insertCuponList1(t_code.getText(), plu);
                    }
                }

            }
        } catch (Exception e) {
            PUtility.ShowMsg(e.getMessage());
        }
        getCuponUnList(t_code.getText());
    }

    public void getCuponUnList(String cupon) {

        tblplu1.setShowGrid(true);
        tblplu1.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
        tblplu1.setSelectionMode(ListSelectionModel.MULTIPLE_INTERVAL_SELECTION);
        tblplu1.setRowSelectionAllowed(true);
        tblplu1.setBackground(java.awt.Color.WHITE);
        tblplu1.setGridColor(java.awt.Color.gray);

        JTableHeader header = tblplu1.getTableHeader();
        header.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu1.setFont(new java.awt.Font("Norasi", java.awt.Font.PLAIN, 14));
        tblplu1.setRowHeight(25);

        stmt = null;
        ResultSet rs = null;
        model5 = (DefaultTableModel) tblplu1.getModel();
        modelh5 = (JTableHeader) tblplu1.getTableHeader();
        int cnt = model5.getRowCount();
        if (cnt > 0) {
            for (int i = 0; i < cnt; i++) {
                model5.removeRow(0);
            }
        }
        try {
            stmt = (Statement) dbUtility.con.createStatement();
            String sql = "SELECT product.pcode,pdesc,pgroup "
                    + "FROM product INNER JOIN cuponunlist ON product.pcode = cuponunlist.PCode  "
                    + "where cucode = '" + cupon + "' order by pgroup,product.pcode";
            rs = stmt.executeQuery(sql);
            while (rs.next()) {
                {
                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
                        model5.addRow(new Object[]{cvth.ASCII2Unicode(rs.getString("pgroup")),
                            cvth.ASCII2Unicode(rs.getString("product.pcode")),
                            cvth.ASCII2Unicode(rs.getString("pdesc"))});

                    } else {
                        model5.addRow(new Object[]{rs.getString("pgroup"),
                            rs.getString("product.pcode"),
                            rs.getString("pdesc")});
                    }
                }
            }
        } catch (Exception e) {
        }
    }

    public String convertDateshowToSQL(String _date) {
        String date = "";
        String[] split = _date.split("/");
        date = split[2] + "-" + split[1] + "-" + split[0];

        return date;
    }

//    public void deletebranch(String code) {
//        try {
//            int confirm = JOptionPane.showConfirmDialog(this, "คุณต้องการลบข้อมูลกลุ่มสาขาทั้งหมดหรือไม่...?", "Confirm", JOptionPane.YES_NO_OPTION);
//            if (confirm == JOptionPane.YES_OPTION) {
//
//                for (int i = 0; i < tblbranch.getRowCount(); i++) {
//                    if (!dbUtility.Char_Set.equalsIgnoreCase("utf-8")) {
//
//                        stmt = (Statement) dbUtility.con.createStatement();
//                        String sql2 = "Delete from culink where BGroup = ?";
//                        PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
//                        prm2.setString(1, cvth.Unicode2ASCII(tblbranch.getValueAt(tblbranch.getSelectedRow(), 0).toString()));
//                        prm2.executeUpdate();
//                        stmt.close();
//
//                    } else {
//                        stmt = (Statement) dbUtility.con.createStatement();
//                        String sql2 = "Delete from culink where BGroup = ?";
//                        PreparedStatement prm2 = (PreparedStatement) dbUtility.con.prepareStatement(sql2);
//                        prm2.setString(1, tblbranch.getValueAt(i, 0).toString());
//                        prm2.executeUpdate();
//                        stmt.close();
//                    }
//                }
//                clearModel3();
//            }
//
//        } catch (Exception e) {
//        }
//    }
}
